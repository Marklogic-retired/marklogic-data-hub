<?xml version="1.0" encoding="UTF-8"?>
<tde:template xmlns:tde="http://marklogic.com/xdmp/tde">
  <tde:description>
Extraction Template Generated from Entity Type Document
graph uri: http://grechaw.github.io/entity-types#Race-0.0.1</tde:description>
  <!-- The following line matches JSON and XML instances, but may be slower to index documents. -->
  <tde:context>//*:instance[*:info/*:version = "0.0.1"]</tde:context>
  <!-- Replace the above with the following line to match XML instances only.  This may speed up indexing
        <tde:context>//es:instance[es:info/es:version = "{$model=>map:get("info")=>map:get("version")}"]</tde:context>
        -->
  <!-- Replace the above with the following line to match JSON instances only.  This may speed up indexing
        <tde:context>//instance[info/version = "{$model=>map:get("info")=>map:get("version")}"]</tde:context>
        -->
  <tde:vars>
    <tde:var>
      <tde:name>RDF</tde:name>
      <tde:val>"http://www.w3.org/1999/02/22-rdf-syntax-ns#"</tde:val>
    </tde:var>
    <tde:var>
      <tde:name>RDF_TYPE</tde:name>
      <tde:val>sem:iri(concat($RDF, "type"))</tde:val>
    </tde:var>
  </tde:vars>
  <tde:path-namespaces>
    <tde:path-namespace>
      <tde:prefix>es</tde:prefix>
      <tde:namespace-uri>http://marklogic.com/entity-services</tde:namespace-uri>
    </tde:path-namespace>
  </tde:path-namespaces>
  <tde:templates>
    <tde:template>
      <tde:context>./Runner</tde:context>
      <tde:vars>
	<tde:var>
	  <tde:name>subject-iri</tde:name>
	  <tde:val>sem:iri(concat("http://grechaw.github.io/entity-types/Race-0.0.1/Runner/", fn:encode-for-uri(./name)))</tde:val>
	</tde:var>
      </tde:vars>
      <tde:triples>
	<tde:triple>
	  <tde:subject>
	    <tde:val>$subject-iri</tde:val>
	  </tde:subject>
	  <tde:predicate>
	    <tde:val>$RDF_TYPE</tde:val>
	  </tde:predicate>
	  <tde:object>
	    <tde:val>sem:iri("http://grechaw.github.io/entity-types/Race-0.0.1/Runner")</tde:val>
	  </tde:object>
	</tde:triple>
	<tde:triple>
	  <tde:subject>
	    <tde:val>$subject-iri</tde:val>
	  </tde:subject>
	  <tde:predicate>
	    <tde:val>sem:iri("http://www.w3.org/2000/01/rdf-schema#isDefinedBy")</tde:val>
	  </tde:predicate>
	  <tde:object>
	    <tde:val>fn:base-uri(.)</tde:val>
	  </tde:object>
	</tde:triple>
      </tde:triples>
    </tde:template>
    <tde:template>
      <tde:context>./Runner</tde:context>
      <tde:rows>
	<tde:row>
	  <tde:schema-name>Race</tde:schema-name>
	  <tde:view-name>Runner</tde:view-name>
	  <tde:view-layout>sparse</tde:view-layout>
	  <tde:columns>
	    <tde:column>
	      <tde:name>name</tde:name>
	      <tde:scalar-type>string</tde:scalar-type>
	      <tde:val>name</tde:val>
	    </tde:column>
	    <tde:column>
	      <tde:name>age</tde:name>
	      <tde:scalar-type>int</tde:scalar-type>
	      <tde:val>age</tde:val>
	    </tde:column>
	    <tde:column>
	      <tde:name>gender</tde:name>
	      <tde:scalar-type>string</tde:scalar-type>
	      <tde:val>gender</tde:val>
	      <tde:nullable>true</tde:nullable>
	    </tde:column>
	  </tde:columns>
	</tde:row>
      </tde:rows>
    </tde:template>
    <tde:template>
      <tde:context>./Race</tde:context>
      <tde:vars>
	<tde:var>
	  <tde:name>subject-iri</tde:name>
	  <tde:val>sem:iri(concat("http://grechaw.github.io/entity-types/Race-0.0.1/Race/", fn:encode-for-uri(./name)))</tde:val>
	</tde:var>
      </tde:vars>
      <tde:triples>
	<tde:triple>
	  <tde:subject>
	    <tde:val>$subject-iri</tde:val>
	  </tde:subject>
	  <tde:predicate>
	    <tde:val>$RDF_TYPE</tde:val>
	  </tde:predicate>
	  <tde:object>
	    <tde:val>sem:iri("http://grechaw.github.io/entity-types/Race-0.0.1/Race")</tde:val>
	  </tde:object>
	</tde:triple>
	<tde:triple>
	  <tde:subject>
	    <tde:val>$subject-iri</tde:val>
	  </tde:subject>
	  <tde:predicate>
	    <tde:val>sem:iri("http://www.w3.org/2000/01/rdf-schema#isDefinedBy")</tde:val>
	  </tde:predicate>
	  <tde:object>
	    <tde:val>fn:base-uri(.)</tde:val>
	  </tde:object>
	</tde:triple>
      </tde:triples>
    </tde:template>
    <tde:template>
      <tde:context>./Race</tde:context>
      <tde:rows>
	<tde:row>
	  <tde:schema-name>Race</tde:schema-name>
	  <tde:view-name>Race</tde:view-name>
	  <tde:view-layout>sparse</tde:view-layout>
	  <tde:columns>
	    <tde:column>
	      <tde:name>name</tde:name>
	      <tde:scalar-type>string</tde:scalar-type>
	      <tde:val>name</tde:val>
	    </tde:column>
	    <tde:column>
	      <tde:name>wonByRunner</tde:name>
	      <tde:scalar-type>string</tde:scalar-type>
	      <tde:val>wonByRunner/Runner</tde:val>
	      <tde:nullable>true</tde:nullable>
	    </tde:column>
	    <tde:column>
	      <tde:name>courseLength</tde:name>
	      <tde:scalar-type>decimal</tde:scalar-type>
	      <tde:val>courseLength</tde:val>
	      <tde:nullable>true</tde:nullable>
	    </tde:column>
	  </tde:columns>
	</tde:row>
      </tde:rows>
      <tde:templates>
	<tde:template>
	  <tde:context>./comprisedOfRuns</tde:context>
	  <tde:rows>
	    <tde:row>
	      <tde:schema-name>Race</tde:schema-name>
	      <tde:view-name>Race_comprisedOfRuns</tde:view-name>
	      <tde:view-layout>sparse</tde:view-layout>
	      <tde:columns>
		<tde:column>
		  <!--This column joins to property name of Race-->
		  <tde:name>name</tde:name>
		  <tde:scalar-type>string</tde:scalar-type>
		  <tde:val>../name</tde:val>
		</tde:column>
		<tde:column>
		  <!--This column joins to primary key of Run-->
		  <tde:name>comprisedOfRuns_id</tde:name>
		  <tde:scalar-type>string</tde:scalar-type>
		  <tde:val>Run</tde:val>
		</tde:column>
	      </tde:columns>
	    </tde:row>
	  </tde:rows>
	</tde:template>
      </tde:templates>
    </tde:template>
    <tde:template>
      <tde:context>./Run</tde:context>
      <tde:vars>
	<tde:var>
	  <tde:name>subject-iri</tde:name>
	  <tde:val>sem:iri(concat("http://grechaw.github.io/entity-types/Race-0.0.1/Run/", fn:encode-for-uri(./id)))</tde:val>
	</tde:var>
      </tde:vars>
      <tde:triples>
	<tde:triple>
	  <tde:subject>
	    <tde:val>$subject-iri</tde:val>
	  </tde:subject>
	  <tde:predicate>
	    <tde:val>$RDF_TYPE</tde:val>
	  </tde:predicate>
	  <tde:object>
	    <tde:val>sem:iri("http://grechaw.github.io/entity-types/Race-0.0.1/Run")</tde:val>
	  </tde:object>
	</tde:triple>
	<tde:triple>
	  <tde:subject>
	    <tde:val>$subject-iri</tde:val>
	  </tde:subject>
	  <tde:predicate>
	    <tde:val>sem:iri("http://www.w3.org/2000/01/rdf-schema#isDefinedBy")</tde:val>
	  </tde:predicate>
	  <tde:object>
	    <tde:val>fn:base-uri(.)</tde:val>
	  </tde:object>
	</tde:triple>
      </tde:triples>
    </tde:template>
    <tde:template>
      <tde:context>./Run</tde:context>
      <tde:rows>
	<tde:row>
	  <tde:schema-name>Race</tde:schema-name>
	  <tde:view-name>Run</tde:view-name>
	  <tde:view-layout>sparse</tde:view-layout>
	  <tde:columns>
	    <tde:column>
	      <tde:name>id</tde:name>
	      <tde:scalar-type>string</tde:scalar-type>
	      <tde:val>id</tde:val>
	    </tde:column>
	    <tde:column>
	      <tde:name>date</tde:name>
	      <tde:scalar-type>date</tde:scalar-type>
	      <tde:val>date</tde:val>
	    </tde:column>
	    <tde:column>
	      <tde:name>distance</tde:name>
	      <tde:scalar-type>decimal</tde:scalar-type>
	      <tde:val>distance</tde:val>
	    </tde:column>
	    <tde:column>
	      <tde:name>distanceLabel</tde:name>
	      <tde:scalar-type>string</tde:scalar-type>
	      <tde:val>distanceLabel</tde:val>
	      <tde:nullable>true</tde:nullable>
	    </tde:column>
	    <tde:column>
	      <tde:name>duration</tde:name>
	      <tde:scalar-type>dayTimeDuration</tde:scalar-type>
	      <tde:val>duration</tde:val>
	    </tde:column>
	    <tde:column>
	      <tde:name>runByRunner</tde:name>
	      <tde:scalar-type>string</tde:scalar-type>
	      <tde:val>runByRunner/Runner</tde:val>
	    </tde:column>
	  </tde:columns>
	</tde:row>
      </tde:rows>
    </tde:template>
  </tde:templates>
</tde:template>