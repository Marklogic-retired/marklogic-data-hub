{"id":20587, "kind":"Bug", "createdAt":"2013-01-25T02:32:13.70722-08:00", "status":"Closed", "title":"Test bug5553.xml is causing ACCESS_VIOLATION on Win 2k3 on 5.0 nightly.", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Test bug5553.xml is causing ACCESS_VIOLATION on Win 2k3 on 5.0 nightly.\r\n\r\nTest name : bug5553.xml\r\nMachine name : w2k3-43-bld2 \r\nPath to Error Log : /cygdrive/c/builds/win64/b5_0/logs.20130124.0/reg-results/ErrorLog.txt\r\nML Version : 20130125\r\n\r\nThere is no stack trace for this fault.\r\n\r\nHere what I see in Error Log : \r\n\r\n2013-01-24 08:04:47.852 Debug: Setting audit configuration for group 5834426442804310016\r\n2013-01-24 08:04:47.852 Debug: Audit enabled flag is false\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: ICN-UNKNOWNERROR: xdmp:pdf-convert(document{binary{\"255044462d312e360d25e2e3cfd30d0a31323634362030206f62\r\n6a0d3c3c2f4c696e656172697a656420312f4c20333632353137392f4f2031323634392f4520...\"}}, \"bug5553\") -- Unknown error.: -1073741819. Loading configuration..\r\n.\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Parsing macros...\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro synth-bookmarks='true'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro image-output='true'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro text-output='true'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro zones='false'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro ignore-text='true'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro remove-overprint='false'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro illustrations='true'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro line-breaks='true'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro image-quality='75'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro page-start=''\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro page-end=''\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro document-start=''\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Macro document-end=''\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: features='10140221'\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: Processing...\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: ACCESS_VIOLATION\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer: at 6:0 [0.9-ml]\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer:   $platform = \"winnt\"\r\n2013-01-24 08:04:55.477 Notice: QAxdbcServer:   $arch = \"amd64\"\r\n2013-01-24 08:04:56.008 Config: Wrote C:\\Program Files\\MarkLogic\\Data\\groups.xml\r\n2013-01-24 08:04:56.008 Config: Loading C:\\Program Files\\MarkLogic\\Data\\groups.xml\r\n2013-01-24 08:04:56.024 Config: Loading C:\\Program Files\\MarkLogic\\Data\\clusters.xml\r\n2013-01-24 08:04:56.024 Config: Loading C:\\Program Files\\MarkLogic\\Data\\hosts.xml\r\n2013-01-24 08:04:56.024 Config: Loading C:\\Program Files\\MarkLogic\\Data\\server.xml\r\n2013-01-24 08:04:56.024 Debug: Setting trace events for group 5834426442804310016\r\n2013-01-24 08:04:56.024 Debug: Trace events activated flag is false\r\n2013-01-24 08:04:56.024 Debug: Setting audit configuration for group 5834426442804310016\r\n2013-01-24 08:04:56.024 Debug: Audit enabled flag is false\r\n2013-01-24 08:04:56.446 Config: Wrote C:\\Program Files\\MarkLogic\\Data\\databases.xml\r\n2013-01-24 08:04:56.446 Config: Loading C:\\Program Files\\MarkLogic\\Data\\databases.xml\r\n2013-01-24 08:04:56.664 Debug: Detecting indexes for database Security\r\n2013-01-24 08:04:56.664 Debug: Detected indexes for database Security: sln\r\n2013-01-24 08:04:56.664 Debug: Detecting compatibility for database Security\r\n2013-01-24 08:04:56.664 Debug: Detected compatibility for database Security\r\n2013-01-24 08:04:56.758 Debug: Detecting indexes for database bug5553\r\n2013-01-24 08:04:56.758 Debug: Detecting indexes for database templateDB\r\n2013-01-24 08:04:56.758 Debug: Detecting indexes for database Last-Login\r\n2013-01-24 08:04:56.758 Debug: Detecting indexes for database Triggers", "samplequery":"let $platform := xdmp:platform()\r\n        let $arch := xdmp:architecture()\r\n        let $results :=\r\n          xdmp:pdf-convert(\r\n            xdmp:document-get('QA_HOME/testdata/3.2/bug5553/bug5553.pdf'),\r\n            'bug5553'),\r\n          $manifest := $results[1],\r\n          $xhtml := $results[2]\r\n          return\r\n            if($platform eq \"solaris\" and $arch eq \"amd64\") then\r\n                  if (fn:count($manifest//*:part) eq 57 and fn:count($xhtml//*:p) eq 4373 and count($xhtml//*:p[last()]/*:span[last()]/text()) eq 13)\r\nthen fn:true() else (fn:count($manifest//*:part), \" \", fn:count($xhtml//*:p), \" \", count($xhtml//*:p[last()]/*:span[last()]/text()))\r\n\r\n            else if($platform eq \"solaris\" and $arch eq \"sparcv9\") then\r\n                  if (fn:count($manifest//*:part) eq 57 and fn:count($xhtml//*:p) eq 3689 and count($xhtml//*:p[last()]/*:span[last()]/text()) eq 12)\r\nthen fn:true() else (fn:count($manifest//*:part), \" \", fn:count($xhtml//*:p), \" \", count($xhtml//*:p[last()]/*:span[last()]/text()))\r\n\r\n            else if($platform eq \"winnt\") then\r\n                  if (fn:count($manifest//*:part) eq 57 and fn:count($xhtml//*:p) eq 4381 and count($xhtml//*:p[last()]/*:span[last()]/text()) eq 13)\r\nthen fn:true() else (fn:count($manifest//*:part), \" \", fn:count($xhtml//*:p), \" \", count($xhtml//*:p[last()]/*:span[last()]/text()))\r\n\r\n            else\r\n                  if (fn:count($manifest//*:part) eq 57 and fn:count($xhtml//*:p) eq 4373 and count($xhtml//*:p[last()]/*:span[last()]/text()) eq 13)\r\nthen fn:true() else (fn:count($manifest//*:part), \" \", fn:count($xhtml//*:p), \" \", count($xhtml//*:p[last()]/*:span[last()]/text()))", "sampledata":"", "version":"5.0-nightly", "tofixin":"5.0-6", "fixedin":"5.0-6", "platform":"windows(64-bit)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, {"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, {"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, {"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, {"username":"mislam", "name":"Towhid Islam", "email":"Towhid.Islam@marklogic.com"}], "attachments":[{"name":"Error Log", "uri":"root/support/bugtracking/attachments/20587/ErrorLog.txt"}], "relationships":[{"type":"", "to":""}], "clones":[20637], "cloneOf":"", "support":{"headline":"On rare occassions, pdf-convert causes ACCESS_VIOLATION on Windows ", "supportDescription":"On rare occasions on a Windows installation of MarkLogic Server, converting pdf using xdmp:pdf-convert will fail with an ACCESS_VIOLATION.", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "sanand"], "changeHistory":[{"time":"2013-01-25T02:32:13.70722-08:00", "updatedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-25T13:33:45.101719-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Scott Miller's comment:\r\nThis looks like the same problem as 19948, only with Win 2k3 instead of Win 2k8; we see this crop up something like once every couple of months.  It appears to be a crash inside Iceni/Argusâ€”this is, evidently not code we could work on ourselves.\r\n\r\n[Perhaps to Stephen] Does Iceni claim to support Win2k3 and Win2k8?  Do we have any pdf-convert()-licensed customers on those platforms?\r\n\r\n    Best,\r\n        --Scott\r\n"}, {"time":"2013-01-25T13:33:45.101719-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-28T03:01:49.087696-08:00", "updatedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"this is happening on 32 bit windows as well..\r\n\r\nhttps://regression-status.marklogic.com/space2/diff-archive/b5_0/2013-01-28/winnt-32-w2k3/qa-criticalErrors.html"}, {"time":"2013-01-28T10:24:25.872612-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"status":{"from":"", "to":"External"}, "assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-28T10:39:03.588218-08:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"See 19948 for text of bug report to Iceni.\r\n"}, {"time":"2013-01-28T12:57:26.355495-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"tofixin":{"from":"5.0-5", "to":"5.0-6"}}, "files":[], "show":true}, {"time":"2013-02-20T23:31:20.191858-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I have commented the test bug5553.xml for win32 on 5.0 nightly regression and created a task 20870 for the same"}, {"time":"2013-04-22T12:42:24.619828-07:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"mislam", "name":"Towhid Islam", "email":"Towhid.Islam@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-05-23T19:05:51.135413-07:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-08-12T14:49:35.169555-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"148918", "paths":["xdmp/branches/b5_0/src/Converters/cvtpdf/winnt/i686-msvc8/Argus.lib", "xdmp/branches/b5_0/src/Converters/cvtpdf/include/icnFeature.h", "xdmp/branches/b5_0/src/Converters/cvtpdf/winnt/i686-msvc8/Argus.dll", "xdmp/branches/b5_0/src/Converters/cvtpdf/linux/i686-gcc3.4/arguslib.a", "xdmp/branches/b5_0/src/Converters/cvtpdf/solaris/sparc-gcc4.1/arguslib.a", "xdmp/branches/b5_0/src/Converters/cvtpdf/solaris/i686-gcc4.1/arguslib.a"], "affectedBugs":[]}, "comment":"Bug:20587\nArgus 6.51"}, {"time":"2013-08-12T15:47:49.522148-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}}}, "files":[], "show":true, "comment":"Argus upgraded to 6.51, which should have resolved this bug. Please test.\r\n \r\nPlease notice that the new Argus 6.51 introduces a minor behavior change regarding generating paragraphs reported in bug 23572. It does not cause data loss, but we need to fix the test or key in bug5553.xml and similar tests."}, {"time":"2013-08-12T15:47:49.522148-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}}}, "files":[], "show":true}, {"time":"2014-03-26T02:48:08.178154-07:00", "updatedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"This issue is no more reproducible. Verified on nighty run from 2014-03-20 to 2014-03-25. \r\n\r\nHence shipping this issue. "}, {"time":"2014-03-26T02:48:08.178154-07:00", "updatedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2014-04-09T15:42:43.153713-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"ga"}], "updatedAt":"2014-04-09T15:42:43.153713-07:00", "fixedAt":"2013-08-12T15:47:49.522148-07:00", "fixedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "shippedAt":"2014-03-26T02:48:08.178154-07:00", "shippedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "closedAt":"2014-04-09T15:42:43.153713-07:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}