{"id":20158, "kind":"Bug", "createdAt":"2012-11-29T00:18:49.63105-08:00", "status":"Closed", "title":"validate strict failing for messages.xsd on trunk", "category":"Validation", "severity":"Critical", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"validate strict failing for messages.xsd on trunk\r\n\r\nThe following xquery on trunk causing validate strict failing for messages.xsd\r\n\r\nxquery version \"1.0-ml\";\r\n    declare namespace html = \"http://www.w3.org/1999/xhtml\";\r\n    declare namespace m=\"http://marklogic.com/xdmp/messages\";\r\n \r\n    for $d in xdmp:filesystem-directory(\"ML_HOME/Messages/\")\r\n    for $file in $d/dir:entry/dir:pathname/text()\r\n    return\r\n        try{\r\n            if (fn:contains($file,\".svn\") = fn:false()) \r\n            then\r\n                ( \r\n                let $node := xdmp:document-get($file)/m:messages\r\n                return\r\n                let $d :=  validate strict { $node }\r\n                return ()\r\n            )\r\n            else\r\n            ()\r\n            }\r\ncatch ($e) { \"Validation failed: \",\r\n             $e/error:format-string/text() } \r\n\t\t\t \r\nResult returned by query:\r\nValidation failed: XDMP-VALIDATEUNEXPECTED: (err:XQDY0027) validate strict { $node } -- Invalid node: Found m:format-string but expected m:response? at fn:doc(\"/opt/MarkLogic/Messages/XDMP-en.xml\")/m:messages/m:message[8]/m:format-string using schema \"messages.xsd\"\r\n\r\nMachine Name: rh6-intel64-51-test-3\r\nML server: 7.0-20121128", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, {"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, {"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["Validation", "iagrawal"], "changeHistory":[{"time":"2012-11-29T00:18:49.63105-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-29T15:19:39.074764-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-15T02:58:28.229504-08:00", "updatedBy":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, "to":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}}}, "files":[], "show":true, "comment":"This currently works fine - it looks like someone else has fixed the XDMP-en.xml file."}, {"time":"2013-02-15T02:58:28.229504-08:00", "updatedBy":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, "to":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-20T03:25:49.334147-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on ML Version 7.0-20130219. The test bug11687.xml is passing now.Hence,shipping the bug."}, {"time":"2013-02-20T03:25:49.334147-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-02-20T03:25:49.334147-08:00", "fixedAt":"2013-02-15T02:58:28.229504-08:00", "fixedBy":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, "shippedAt":"2013-02-20T03:25:49.334147-08:00", "shippedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "renderDescriptionAs":"normal"}