{"id":20356, "kind":"Bug", "createdAt":"2013-01-02T02:34:08.925277-08:00", "status":"Closed", "title":"Schema changes in 6_0 Nightly:- xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" have not been reflected in Mac-Osx Build", "category":"Search API", "severity":"Critical", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Issue started from build : 20121221\r\n\r\nMachine : osx-intel64-51-build.marklogic.com (b6_0 AppServices Mac Regression machine)\r\n\r\nInitial Analysis : The Schema changes that Charles checked-in are not reflected in Mac 6_0 build as the tests impacted by these changes are failing in regression after key update although these tests are passing on all other platforms.\r\n\r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nTests Suites Impacted/failing : \"appservices-bugs\" and \"search-api\"\r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nFor Example \r\n\r\nXQuery of test appservices-bug10119.xml Causing faliure :\r\n\r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nxquery version \"1.0-ml\";\r\nimport module namespace search=\"http://marklogic.com/appservices/search\"\r\n  at \"/MarkLogic/appservices/search/search.xqy\";\r\n \r\nlet $options :=\r\n<options xmlns=\"http://marklogic.com/appservices/search\">\r\n{\r\n  (: timestamp buckets :)\r\n  element constraint {\r\n    attribute name { 'timestamp' },\r\n    element range {\r\n      attribute facet { 'true' },\r\n      attribute type { 'xs:dateTime' },\r\n      element element {\r\n        attribute name { 'timestamp' }\r\n      },\r\n      for $y in reverse(2001 to 2009)\r\n      return element bucket {\r\n        attribute ge {\r\n          xs:dateTime(concat(string($y), '-01-01T00:00:00')) },\r\n        attribute lt {\r\n          xs:dateTime(concat(string(1 + $y), '-01-01T00:00:00')) },\r\n        attribute name { $y } }\r\n    }\r\n  }\r\n}\r\n</options>\r\nreturn search:parse('timestamp:\"2009\"', $options)\r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n\r\nActual Output of test appservices-bug10119.xml:\r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<cts:and-query qtextconst=\"timestamp:2009\" xmlns:cts=\"http://marklogic.com/cts\">\r\n  <cts:element-range-query qtextconst=\"timestamp:2009\" operator=\"&gt;=\">\r\n    <cts:element>timestamp</cts:element>\r\n    <cts:value xsi:type=\"xs:dateTime\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">2009-01-01T00:00:00</cts:value>\r\n  </cts:element-range-query>\r\n  <cts:element-range-query qtextconst=\"timestamp:2009\" operator=\"&lt;\">\r\n    <cts:element>timestamp</cts:element>\r\n    <cts:value xsi:type=\"xs:dateTime\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">2010-01-01T00:00:00</cts:value>\r\n  </cts:element-range-query>\r\n</cts:and-query>\r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n\r\nExpected Output of test appservices-bug10119.xml : \r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<cts:and-query qtextconst=\"timestamp:2009\" xmlns:cts=\"http://marklogic.com/cts\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\r\n  <cts:element-range-query qtextconst=\"timestamp:2009\" operator=\"&gt;=\">\r\n    <cts:element>timestamp</cts:element>\r\n    <cts:value xsi:type=\"xs:dateTime\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">2009-01-01T00:00:00</cts:value>\r\n  </cts:element-range-query>\r\n  <cts:element-range-query qtextconst=\"timestamp:2009\" operator=\"&lt;\">\r\n    <cts:element>timestamp</cts:element>\r\n    <cts:value xsi:type=\"xs:dateTime\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">2010-01-01T00:00:00</cts:value>\r\n  </cts:element-range-query>\r\n</cts:and-query>\r\n------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n\r\n\r\nNote : These changes are working fine on b5_0 Mac build ", "samplequery":"", "sampledata":"", "version":"6.0-nightly", "tofixin":"6.0-3", "fixedin":"N/A", "platform":"OS X", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, {"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, {"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, {"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, {"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["Search API", "mbhatnag"], "changeHistory":[{"time":"2013-01-02T02:34:08.925277-08:00", "updatedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-02T07:59:12.263508-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-02T07:59:12.263508-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-01-02T09:01:52.762599-08:00", "updatedBy":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Mayank, do you know which commit had the schema changes?  I'm failing to see where I could have caused this.  "}, {"time":"2013-01-03T02:51:46.280261-08:00", "updatedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Charles,\r\n\r\nBelow are the svn transactions seems to be the root cause.\r\n \r\nhttp://svn.marklogic.com/trac.engsvn/changeset/124457  -  Bug ID : 20302\r\nhttp://svn.marklogic.com/trac.engsvn/changeset/124456  -  Bug ID : 20303\r\nhttp://svn.marklogic.com/trac.engsvn/changeset/124455  -  Bug ID : 20004\r\n\r\nThanks,\r\nMayank\r\n\r\n"}, {"time":"2013-01-17T17:43:22.634417-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Charles,\r\n\r\nHeads up .. we are starting to triage 6.0-3 and this will be asked to be fixed. 6.0-3 release date is not known yet. But given that this is a regression, you should fix it so that QA tests can go through. Thanks"}, {"time":"2013-01-17T21:28:21.805039-08:00", "updatedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi,\r\n\r\nThis issue seems to be fixed on latest build as I have verified it by running tests manually. Further I will verify it on the nightly regression as well.\r\n\r\nThanks,\r\nMayank"}, {"time":"2013-01-17T21:28:21.805039-08:00", "updatedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "to":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-22T22:51:39.84016-08:00", "updatedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"This bug is no more producible. Verified on build 20130121 and of regression dated 2013-01-21.\r\n\r\nThanks,\r\nMayank"}, {"time":"2013-01-22T22:51:39.84016-08:00", "updatedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-01-22T22:51:39.84016-08:00", "closedAt":"2013-01-22T22:51:39.84016-08:00", "closedBy":{"username":"mbhatnag", "name":"Mayank Bhatnagar", "email":"Mayank.Bhatnagar@marklogic.com"}, "renderDescriptionAs":"normal"}