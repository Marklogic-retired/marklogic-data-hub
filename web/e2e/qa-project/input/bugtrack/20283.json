{"id":20283, "kind":"Bug", "createdAt":"2012-04-02T17:13:01.192691-07:00", "status":"Closed", "title":"Empty XML document blows up default snippeter", "category":"Search API", "severity":"", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"cwhitney", "name":"Colleen  Whitney", "email":"colleen.whitney@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"A bit of a corner case, but if you ingest an empty document and return it as a search result, you get:\r\n\r\nerr:XPTY0004: XDMP-ARGTYPE: (err:XPTY0004) xdmp:node-uri(()) -- arg1 is not of type node()\r\n\r\nThis goes back to 4.1, so would need to be fixed on all active branches.", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"cwhitney", "name":"Colleen  Whitney", "email":"colleen.whitney@marklogic.com"}, {"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, {"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":16722, "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["Search API", "cwhitney"], "changeHistory":[{"time":"2012-04-02T17:13:01.192691-07:00", "updatedBy":{"username":"cwhitney", "name":"Colleen  Whitney", "email":"colleen.whitney@marklogic.com"}, "change":{"assignTo":{"from":{"username":"cwhitney", "name":"Colleen  Whitney", "email":"colleen.whitney@marklogic.com"}, "to":{"username":"cwhitney", "name":"Colleen  Whitney", "email":"colleen.whitney@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-14T10:52:37.843827-08:00", "updatedBy":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"124063", "paths":["xdmp/trunk/src/Modules/MarkLogic/appservices/search/snippet.xqy"], "affectedBugs":[]}, "comment":"bug:20283 empty document throws snippet exception"}, {"time":"2012-12-14T10:53:54.536518-08:00", "updatedBy":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true, "comment":"Reproduction steps \r\n\r\n\r\nVerified. Should be a simple case to catch and resolve.\r\n \r\nTo reproduce, make a directory with one empty file in it. Use an info studio flow to ingest. Then run this in qconsole:\r\n \r\nxquery version \"1.0-ml\";\r\nimport module namespace search=\"http://marklogic.com/appservices/search\" at \"/MarkLogic/appservices/search/search.xqy\";\r\n \r\nsearch:search(\"\", <options xmlns=\"http://marklogic.com/appservices/search\"/>)\r\n\r\n"}, {"time":"2012-12-14T10:53:54.536518-08:00", "updatedBy":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, "change":{"assignTo":{"from":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-19T21:43:56.021768-08:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"You already have appservices-bug16724.xml in the regression for the 5.0 clone. Please check in the same into 6.0 and trunk and if passed, then ship both of those"}, {"time":"2013-02-19T21:43:56.021768-08:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "to":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-27T14:06:06.01616-08:00", "updatedBy":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Automated test is checked in to trunk and working fine on build 02/26"}, {"time":"2013-02-27T14:06:06.01616-08:00", "updatedBy":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-02-27T14:06:06.01616-08:00", "fixedAt":"2012-12-14T10:53:54.536518-08:00", "fixedBy":{"username":"cgreer", "name":"Charles Greer", "email":"charles.greer@marklogic.com"}, "shippedAt":"2013-02-27T14:06:06.01616-08:00", "shippedBy":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, "renderDescriptionAs":"normal"}