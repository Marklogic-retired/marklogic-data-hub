{"id":20793, "kind":"Bug", "createdAt":"2013-02-14T13:07:01.975732-08:00", "status":"Closed", "title":"cts:field-values of a path-field having a predicate does not return correct results", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"MarkLogic Version 7.0-20130213\r\n\r\n1.\tCreate a path-field ‘myField2’ with path ‘/a/b[c]’ WITHOUT enabling any searches or adding any include/exclude elements.\r\n2.\tCreate field-range index for ‘myField2’.\r\n3.\tInserting document: /t7.xml\r\n<a><b><c><e>E1</e></c></b><c>     <d>C2<e>E2</e></d></c> </a>\r\n4.\trun cts:field-values(“myField2”)\r\n\r\nThis should return E1, but now it returns empty sequence. Am I missing something here?\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "msrinivasan"], "changeHistory":[{"time":"2013-02-14T13:07:01.975732-08:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-14T17:56:39.739662-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"There may be something slightly wrong in your repro. Please clean the database and then insert the document.\r\n\r\n    <fields>\r\n      <field>\r\n        <field-name/>\r\n        <include-root>true</include-root>\r\n        <included-elements/>\r\n        <excluded-elements/>\r\n      </field>\r\n      <field>\r\n        <field-name>frag</field-name>\r\n        <field-path>\r\n          <path>chapter/title/@lang</path>\r\n          <weight>2.0</weight>\r\n        </field-path>\r\n        <field-value-searches>true</field-value-searches>\r\n        <word-lexicons/>\r\n        <included-elements/>\r\n        <excluded-elements/>\r\n        <tokenizer-overrides/>\r\n      </field>\r\n      <field>\r\n        <field-name>myField2</field-name>\r\n        <field-path>\r\n          <path>/a/b[c]</path>\r\n          <weight>2.0</weight>\r\n        </field-path>\r\n        <included-elements/>\r\n        <excluded-elements/>\r\n        <tokenizer-overrides/>\r\n      </field>\r\n    </fields>\r\n    <range-field-indexes>\r\n      <range-field-index>\r\n        <scalar-type>string</scalar-type>\r\n        <field-name>myField2</field-name>\r\n        <collation>http://marklogic.com/collation/</collation>\r\n        <range-value-positions>false</range-value-positions>\r\n        <invalid-values>reject</invalid-values>\r\n      </range-field-index>\r\n    </range-field-indexes>\r\n\r\nQ1:\r\nxdmp:document-insert(\"/t7.xml\",\r\n<a><b><c><e>E1</e></c></b><c> <d>C2<e>E2</e></d></c> </a>)\r\n;\r\ncts:field-values(\"myField2\")\r\n=>\r\nE1\r\n\r\nQ2:\r\n\r\nxdmp:document-insert(\"/t7.xml\",\r\n<a><b><c><e>E1</e><e>E3</e></c></b><c> <d>C2<e>E2</e></d></c> </a>)\r\n;\r\ncts:field-values(\"myField2\")\r\n=>\r\nE1 E3"}, {"time":"2013-02-14T17:56:39.739662-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true, "comment":"Let us look at your testcase together tomorrow."}, {"time":"2013-02-14T17:56:39.739662-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-12T16:25:44.419057-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-ea1_20130305"}], "updatedAt":"2013-03-12T16:25:44.419057-07:00", "fixedAt":"2013-02-14T17:56:39.739662-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "closedAt":"2013-03-12T16:25:44.419057-07:00", "closedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "renderDescriptionAs":"normal"}