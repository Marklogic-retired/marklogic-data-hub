{"id":20256, "kind":"Bug", "createdAt":"2012-12-11T19:49:36.898704-08:00", "status":"Closed", "title":"Allow boolean combinations in path index predicates", "category":"search", "severity":"Minor", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"For partial update and retrieve in the REST API, we would like to use cts:valid-index-path() to verify\r\nthat an XPath uses simple predicates with either positional numbers or equality of values.\r\n\r\nIdeally, an XPath could combine values equality clauses with booleans as in:\r\n\r\n/path/to[@x eq 'foo' and @y = 'bar']\r\n/path/to[@x eq 'foo' or @y = 'bar']\r\n\r\nThe former is more important than the latter because it supports the equivalent of a multipart key.\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["search", "ehennum"], "changeHistory":[{"time":"2012-12-11T19:49:36.898704-08:00", "updatedBy":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-18T09:55:54.331579-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"tofixin":{"from":"7.0-1", "to":"7.0-ea1"}}, "files":[], "show":true}, {"time":"2013-01-11T05:16:56.960334-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Testing:\r\n\r\n1. Define string path range indexes on the two paths.\r\n/path/to[@x eq 'foo' and @y = 'bar']\r\n/path/to[@x eq 'foo' or @y = 'bar'] \r\n\r\n2. Insert the three documents:\r\nxdmp:document-insert(\"/t1.xml\",<path><to x='foo' y='bar'>to1</to></path>),\r\nxdmp:document-insert(\"/t2.xml\",<path><to x='foo' y='bar2'>to2</to></path>),\r\nxdmp:document-insert(\"/t3.xml\",<path><to x='foo3' y='bar'>to3</to></path>)\r\n\r\n3. cts:values(cts:path-reference(\"/path/to[@x eq 'foo' and @y = 'bar']\"))\r\n=>\r\n  to1\r\n\r\n4. cts:values(cts:path-reference(\"/path/to[@x eq 'foo' or @y = 'bar']\"))\r\n=>\r\nto1\r\nto2\r\nto3\r\n\r\n5. cts:valid-index-path(\"/path/to[@x eq 'foo' and @y = 'bar']\",false()),\r\ncts:valid-index-path(\"/path/to[@x eq 'foo' or @y = 'bar']\",false()),\r\ncts:valid-index-path(\"/path/to[@x eq 'foo' and @y = 'bar' and @z='red']\",false()),\r\ncts:valid-index-path(\"/path/to[@x eq 'foo' or @y = 'bar' or @z='red']\",false()),\r\ncts:valid-index-path(\"/path/to[@x eq 'foo' or @y = 'bar' and @z='red']\",false()),\r\ncts:valid-index-path(\"/path/to[@x eq 'foo' and @y = 'bar' or @z='red']\",false()),\r\ncts:valid-index-path(\"/path/to[@x eq 'foo' or @y = 'bar' or @z='red' or from='G']\",false())\r\n=>\r\ntrue\r\ntrue\r\ntrue\r\ntrue\r\ntrue\r\ntrue\r\ntrue"}, {"time":"2013-01-11T05:29:48.675159-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"As a follow-up work on this fix we can use these indexes in query optimization. Refer to bug 20436."}, {"time":"2013-01-11T05:34:11.775068-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"127431", "paths":["xdmp/trunk/src/PathIndexes.cpp"], "affectedBugs":[]}, "comment":"Allow boolean combinations in index path predicates bug:20256.\n"}, {"time":"2013-01-11T05:36:26.997734-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true, "comment":"Testing: Variations of the path expressions in my test-cases."}, {"time":"2013-01-11T05:36:26.997734-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-27T14:57:15.187642-08:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Will get to this after I finish my other EA1 bugs, because I need to add other variations of these cases mentioned as well."}, {"time":"2013-03-05T16:25:46.298519-08:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-ea1_20130304. Added test path-index-predicate-boolean.xml"}], "updatedAt":"2013-03-05T16:25:46.298519-08:00", "fixedAt":"2013-01-11T05:36:26.997734-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "shippedAt":"2013-03-05T16:25:46.298519-08:00", "shippedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "renderDescriptionAs":"normal"}