{"id":20633, "kind":"Bug", "createdAt":"2012-03-01T10:54:46.504897-08:00", "status":"Closed", "title":"admin UI upgrade code needs to handle upgrading on clusters running a replica security database", "category":"Upgrade", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"See bug 16381.\r\n\r\nOff the top of my head:\r\n\r\n1. upgrade the master cluster.\r\n2. make sure the replica has received the new security database state.\r\n3. the Admin UI upgrade code will need to detect that it's running on a replica security database, either offer to upgrade or do it automatically, and not attempt to write to the security database if the version is already correct.", "samplequery":"", "sampledata":"", "version":"6.0-nightly", "tofixin":"6.0-3", "fixedin":"6.0-3", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, {"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, {"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, {"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, {"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, {"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, {"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}], "attachments":[{"name":"Adding a new Upgrade button on Support Page (1st cut)", "uri":"root/support/bugtracking/attachments/16382/bug 16382 - first cut.JPG"}, {"name":"2nd cut - when it is NOT a replica", "uri":"root/support/bugtracking/attachments/16382/bug 16382 - 2nd cut when it is NOT replica.JPG"}, {"name":"2nd cut - when it is a replica", "uri":"root/support/bugtracking/attachments/16382/bug 16382 - 2nd cut when it is replica.JPG"}, {"name":"3rd cut on support page for all cases", "uri":"root/support/bugtracking/attachments/16382/3rd cut.JPG"}], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":16382, "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["Upgrade", "wfeick"], "changeHistory":[{"time":"2012-03-01T10:54:46.504897-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-08T23:36:03.475424-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-17T12:36:33.774224-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Ganesh: I will talk to Wayne and see what we need to do here"}, {"time":"2012-12-17T12:36:33.774224-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-17T15:54:03.942669-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"An upgrade involves two sets of actions. One is to make changes to the security database, and the other is to make changes to the config files. We use the security-version in the security database to determine whether we need to run the upgrade logic.\r\n\r\nWhen the security database is being replicated, the replica cluster can't run the security database portion of the upgrade because the replica database is read only. This is why we run the upgrade on the master cluster first, and this caused both the master's security database and also its config files to be upgraded.\r\n\r\nThe updated security database is then replicated to the replica cluster.\r\n\r\nAt this point, the replica cluster still needs to (potentially) have its config files upgraded but doesn't realize it because it sees the newer security version in the replica security database.\r\n\r\nIn development, we just access http://localhost:8001/security-upgrade-go.xqy?force=true to force the upgrade logic to run.\r\n\r\nFor customers, we need a more elegant way to run the config upgrade part of the process. One possibility is to just offer the user a button somewhere to \"force upgrade process\" that they could be instructed to use on their replica cluster after upgrading the master."}, {"time":"2012-12-26T23:06:39.799198-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Brian,\r\n\r\nCan you please look into this defect for 5.0-5. We are targetting to get all 5.0-5 defects checked in by January 23rd. Thanks. "}, {"time":"2012-12-26T23:06:39.799198-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-16T10:22:57.810504-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true, "comment":"Investigating..."}, {"time":"2013-01-17T17:45:05.326329-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Wayne, please take a look of the attached screenshot  and confirm if this serve the need.\r\n  \r\nThe button is linked to  security-upgrade-go.xqy?force=true (relative link); upon clicking the button, there will be no confirmation pop-up and the upgrade process will start, and upon finishing the upgrade, the page will be redirected to the Admin home page.\r\n\r\nIMO, it is safer to add a confirm popup but it seems that is not being used in other admin pages as far as I know.\r\n"}, {"time":"2013-01-17T17:45:05.326329-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{"assignTo":{"from":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "to":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-17T17:46:02.987229-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Wayne, would you suggest better wording/description too.  Thanks!"}, {"time":"2013-01-17T18:29:47.019594-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Is this always available, or only when the security database is a replica?\r\n\r\nIt might be good to have a little bit of verbiage there to explain why someone might press that button."}, {"time":"2013-01-18T15:54:52.357979-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"The button should be \"Upgrade\", not \"Update\".\r\n\r\nI would like the following text displayed next to the button.\r\n\r\n\"Upgrade logic normally runs automatically when the server software is upgraded, such that there is no need to run this logic manually.\"\r\n\r\nIf the security database is a replica database, I would like the following additional text.\r\n\r\n\"Because your security database is a replica of a foreign database, its security database has already been upgrade. It may, however, be necessary to manually run the upgrade logic once to make adjustments to configuration files. If you are unsure whether you need to run the upgrade logic, please contact support.\""}, {"time":"2013-01-18T15:54:52.357979-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-18T17:10:08.810316-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Wayne,\r\n\r\nAttached please check two new 2nd-cut screenshots:\r\n- when the security database *not* a replica\r\n- when the security database *is* a replica\r\n\r\nI didn't follow your exact suggestion because it seems too crowded to me; instead, if I follow kinda other pages and come up this slightly modified presentation.  Let me it is clear enough for you.\r\n\r\n\r\n"}, {"time":"2013-01-18T17:11:52.240727-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{"assignTo":{"from":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "to":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-21T13:22:00.592885-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-21T13:36:28.259638-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Brian, can you check in the code so I can see the real wording for this.  Or come find me and we can wordsmith it together.\r\n\r\nRemove the sentence about calling support, as it is not needed."}, {"time":"2013-01-21T13:36:28.259638-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-21T13:46:48.880546-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"128605", "paths":["xdmp/branches/b5_0/src/Admin/lib/support-request-form.xqy"], "affectedBugs":[]}, "comment":"Bug:16382 - add UI button to force run upgrade logic"}, {"time":"2013-01-21T13:52:07.26923-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"128606", "paths":["xdmp/branches/b5_0/src/Admin/lib/support-request-form.xqy"], "affectedBugs":[]}, "comment":"Bug:16382 - removed the sentence about calling support"}, {"time":"2013-01-21T13:53:27.429525-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Danny, I will look for you... "}, {"time":"2013-01-21T14:10:23.399524-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"128609", "paths":["xdmp/branches/b5_0/src/Admin/lib/support-request-form.xqy"], "affectedBugs":[]}, "comment":"bug:16382 -- tweaked the language for replica upgrade stuff"}, {"time":"2013-01-21T14:11:33.358474-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Brian, I made a few tweaks to the language.  Please check it out and see if it makes sense."}, {"time":"2013-01-21T14:51:15.493422-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Woops, meant to assign this to brian.  Brian, if you are done with it, please put it in test."}, {"time":"2013-01-21T14:52:03.880052-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"ok.  working on other bugs and will come back to this one soon..."}, {"time":"2013-01-21T16:44:58.63623-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Danny and I were just discussing this some more. We can do better if we put the server version into clusters.xml and update it as part of the upgrade.\r\n\r\n1. Add a new security-version element to clusters.xml and clusters.xsd.\r\n\r\n2. In Admin/lib/status-check.xqy, we have code to check the security version in the security database. If the version in the security database is correct, but the clusters.xml version is not, then you run the upgrade logic as if the security version is wrong.\r\n\r\nOn a cluster with a replica security database, if the running server version is different than the clusters.xml version, you should insist on the master security database being upgraded before running the replica's upgrade code.\r\n\r\n3. The security logic needs to upgrade clusters.xml to have the new security version.\r\n\r\nWith these changes, the replica will automatically detect that it needs to upgrade its config files. Having done this work, the upgrade button text can change to only include the part that says you shouldn't need to press the button.\r\n\r\n"}, {"time":"2013-01-23T10:56:32.760655-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"In investigation of Wayne's comment:  \r\n\"On a cluster with a replica security database, if the running server version is different than the clusters.xml version, you should insist on the master security database being upgraded before running the replica's upgrade code.\"\r\n\r\nI found that if I upgrade on the one with replica security database first (in this case from 5.0 to 6.0  while the master is still on 6.0), the upgrade process is stuck on the same Security and Configuration Upgrade page (behind the scene:  security-upgrade.xqy --> security-upgrade-go.xqy --> default.xqy --> security-upgrade.xqy ). "}, {"time":"2013-01-23T12:57:22.707815-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Brian, do you have any ideas how to deal with this?"}, {"time":"2013-01-23T12:59:35.36838-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Checking the upgrade logic now..."}, {"time":"2013-01-28T17:53:57.637545-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"129781", "paths":["xdmp/branches/b5_0/src/Admin/lib/initialize.xqy", "xdmp/branches/b5_0/src/Admin/lib/upgrade.xqy", "xdmp/branches/b5_0/src/Admin/lib/status-check.xqy", "xdmp/branches/b5_0/src/Config/clusters.xsd", "xdmp/branches/b5_0/src/Admin/lib/security-upgrade-funcs.xqy", "xdmp/branches/b5_0/src/Admin/lib/support-request-form.xqy"], "affectedBugs":[]}, "comment":"Bug:16382 - added security-version to clusters.xml and updated upgrade logic"}, {"time":"2013-01-28T17:55:32.266685-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed.   Also see update support screen.\r\nPlease watch for regression.  If it looks ok, will copy the fixes to 6 and 7 branches"}, {"time":"2013-01-28T17:55:32.266685-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{"assignTo":{"from":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-28T21:13:36.134356-08:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Aries,\r\n\r\nPlease verify this bug on linux, windows as well as mac. Please work with Brian if you need any help with the steps.\r\n\r\nSince this introduces anew button, let us make sure we do browser compatibility of the GUI.\r\n\r\n"}, {"time":"2013-01-28T21:13:36.134356-08:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "to":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-29T12:31:25.131065-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"129884", "paths":["xdmp/branches/b6_0/src/Admin/lib/security-upgrade-funcs.xqy", "xdmp/branches/b6_0/src/Admin/lib/upgrade.xqy", "xdmp/branches/b6_0/src/Admin/lib/support-request-form.xqy", "xdmp/branches/b6_0/src/Admin/lib/status-check.xqy", "xdmp/branches/b6_0/src/Admin/lib/initialize.xqy", "xdmp/branches/b6_0/src/Config/clusters.xsd"], "affectedBugs":[]}, "comment":"Bug:20633 - added security-version to clusters.xml and updated upgrade logic"}, {"time":"2013-01-29T12:41:33.315003-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true, "comment":"Brian, this did not have a Fix-In release, and was set to Fixed-In 5.0-5.  Did you mean 6.0-3?  Try putting in test again."}, {"time":"2013-01-29T12:41:33.315003-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-29T12:41:33.315003-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-01-29T14:56:20.946157-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"129904", "paths":["xdmp/branches/b6_0/src/Admin/lib/security-upgrade-funcs.xqy"], "affectedBugs":[]}, "comment":"Bug:20633 - fixed the 500 error from clicking the force upgrade button for the subversion upgrade"}, {"time":"2013-01-30T17:41:51.470956-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "to":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-30T17:41:51.470956-08:00", "updatedBy":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "change":{"assignTo":{"from":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, "to":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-28T20:33:08.900658-07:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I just noticed that the security database version number stored in the clusters.xml file is editable in the admin UI. It shouldn't be. You should use a hidden field."}, {"time":"2013-03-28T20:33:08.900658-07:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-28T20:33:08.900658-07:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-28T22:41:00.191452-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"138033", "paths":["xdmp/branches/b6_0/src/Admin/lib/cluster-admin-form.xqy"], "affectedBugs":[]}, "comment":"Bug:20633. Security version field is disabled for editing"}, {"time":"2013-03-28T22:41:46.749282-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"138034", "paths":["xdmp/trunk/src/Admin/lib/cluster-admin-form.xqy"], "affectedBugs":[]}, "comment":"Bug:20633. Security version field is disabled for editing"}, {"time":"2013-03-28T22:42:56.007878-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true, "comment":"I fixed this in trunk and 6.0-3. Note that security version is not editable anymore"}, {"time":"2013-03-28T22:42:56.007878-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-28T22:44:32.897348-07:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"An alternative is to set the hidden flag in the schema, in which case it won't be visible to the user at all. I'm not sure a user needs to see this value, in which case the hidden approach would be better. What do you think, Ganesh?"}, {"time":"2013-03-28T22:46:16.995589-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":" Might be useful to show this for support (and for us also) in case something goes wrong. This might enable us to see quickly what is in cluster.xml"}, {"time":"2013-03-28T22:47:15.485723-07:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I think it'd be in the support dump, so we could get it that way."}, {"time":"2013-03-28T22:51:51.291656-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I can hide it in the code and I have tested it (call to hidden-field in admin-forms.xqy). Not sure how I would specify that in xsd or xml.\r\n\r\nSo, if you are sure about hiding it, I can check that in."}, {"time":"2013-03-28T23:00:14.431593-07:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Try this...\r\n\r\nIndex: src/Config/clusters.xsd\r\n===================================================================\r\n--- src/Config/clusters.xsd\t(revision 138034)\r\n+++ src/Config/clusters.xsd\t(working copy)\r\n@@ -46,6 +46,7 @@\r\n         The security database version.\r\n       </xs:documentation>\r\n       <xs:appinfo>\r\n+        <admin:hidden>true</admin:hidden>\r\n         <admin:default>xdmp:security-version()</admin:default>\r\n       </xs:appinfo>\r\n     </xs:annotation>\r\n"}, {"time":"2013-03-28T23:07:46.227382-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"This worked. Thanks. I also made sure that the the field does show up as type=hidden in HTML. Thanks. I will check this in"}, {"time":"2013-03-28T23:09:53.878932-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"138035", "paths":["xdmp/trunk/src/Admin/lib/cluster-admin-form.xqy"], "affectedBugs":[]}, "comment":"Bug:20633. Reverted previous change. As per Wayne's suggestion hiding the field via cluster.xsd"}, {"time":"2013-03-28T23:10:44.641776-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"138036", "paths":["xdmp/branches/b6_0/src/Admin/lib/cluster-admin-form.xqy"], "affectedBugs":[]}, "comment":"Bug:20633. Reverted previous change. As per Wayne's suggestion hiding the field via cluster.xsd"}, {"time":"2013-03-28T23:13:39.422096-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hiding the field is done via defect 21360"}, {"time":"2013-03-29T13:24:58.711767-07:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "to":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-04-01T15:12:04.994361-07:00", "updatedBy":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ayuwono", "name":"Aries Yuwono", "email":"ayuwono@marklogic.com"}, "to":{"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-04-11T22:29:36.465073-07:00", "updatedBy":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "change":{"tofixin":{"from":"7.0-ea2", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-04-11T22:30:30.188024-07:00", "updatedBy":{"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified in 0410 build"}, {"time":"2013-04-11T22:30:30.188024-07:00", "updatedBy":{"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-04-11T22:30:30.188024-07:00", "fixedAt":"2013-03-28T22:42:56.007878-07:00", "fixedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "shippedAt":"2013-04-11T22:30:30.188024-07:00", "shippedBy":{"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}, "renderDescriptionAs":"normal"}