{"id":20008, "kind":"Bug", "createdAt":"2012-10-24T14:32:50.790287-07:00", "status":"Closed", "title":"search options generated by appbuilder are not passing search:check-options", "category":"App Builder", "severity":"Minor", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"The options that exist in the built app do not pass search:check-options.\r\n\r\n<search:report id=\"SEARCH-INVALIDREF\" xmlns:search=\"http://marklogic.com/appservices/search\">Constraint name \"point\" referenced by extract-metadata not found, or not of appropriate type (range, collection, or geospatial).</search:report>\r\n \r\nthe reason for this is due to incorrect logic within deploy-noxq.xqy\r\n\r\nthis was precondition to investigating bug:19700", "samplequery":"search:check-options($options) \r\n\r\nwhere $options are taken from /v1/config/query/all of deployed REST server\r\n", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-1", "fixedin":"7.0-1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, {"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, {"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":19897, "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["App Builder", "jfuller"], "changeHistory":[{"time":"2012-10-24T14:32:50.790287-07:00", "updatedBy":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "to":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-10-24T14:35:45.671211-07:00", "updatedBy":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true, "comment":"changed logic in deploy-noxq,xqy and added geospatial-constraint-unittest.xqy to deploy-unittest test suite\r\n\r\na passing deploy-unittest suite indicates this bug is fixed"}, {"time":"2012-10-24T14:35:45.671211-07:00", "updatedBy":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-05T13:49:39.362373-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Jim,\r\n\r\nHow should QA verify this defect in 6.0-2?"}, {"time":"2012-11-05T13:49:39.362373-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-06T11:19:34.653673-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on 11/05 build . Deployed an oscar pp on 5075 got an empty sequence for the below query \r\n\r\nxquery version \"1.0-ml\";\r\nimport module namespace search = \"http://marklogic.com/appservices/search\"     at \"/MarkLogic/appservices/search/search.xqy\";\r\nlet $options :=  xdmp:http-get(\"http://gghai:5075/v1/config/query/all\",  <options xmlns=\"xdmp:http\">\r\n       <authentication method=\"digest\">\r\n         <username>admin</username>\r\n         <password>admin</password>\r\n       </authentication>\r\n     </options>)[2]\r\nreturn search:check-options($options/*);\r\n\r\nThanks Jim for helping  on this ."}, {"time":"2012-11-06T11:19:34.653673-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-06T11:21:35.623217-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-06T11:21:35.623217-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-06T11:22:48.058369-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Query returns :\r\n\r\n> search:check-options() on latest oscars app returns\r\n> \r\n> <?xml version=\"1.0\" encoding=\"UTF-8\"?> <results warning=\"more than one \r\n> root item\">  <search:report id=\"SEARCH-INVALIDAGGREGATE\" \r\n> xmlns:search=\"http://marklogic.com/appservices/search\">Aggregate \"min\" \r\n> cannot be resolved on the specified index (check configuration, name, \r\n> type).</search:report>  <search:report id=\"SEARCH-INVALIDAGGREGATE\" \r\n> xmlns:search=\"http://marklogic.com/appservices/search\">Aggregate \"max\" \r\n> cannot be resolved on the specified index (check configuration, name, \r\n> type).</search:report> </results>\r\n> \r\n\r\n\r\nFix need to ported to 6.1 ."}, {"time":"2012-11-06T11:23:12.198783-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Gaurav,\r\n\r\nNot sure what we need to do here? Why is this assigned to me? Thanks."}, {"time":"2012-11-06T11:24:53.452957-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Ganesh : It just a clone bug i created ; fix is not in 6.1. trunk ."}, {"time":"2012-11-06T11:25:32.344901-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Oh. Thanks. Make sense."}, {"time":"2012-11-06T21:26:59.322628-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.1-1"}}, "files":[], "show":true}, {"time":"2013-01-28T13:25:41.771039-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Gaurav,\r\n\r\nIf this is fixed in trunk, can this be closed? Thanks"}, {"time":"2013-01-28T13:25:41.771039-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-04T15:02:06.541449-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on 03-04 7- 0 EA1  build. Running \r\n\r\nxquery version \"1.0-ml\";\r\nimport module namespace search = \"http://marklogic.com/appservices/search\" at \"/MarkLogic/appservices/search/search.xqy\";\r\nlet $options := xdmp:http-get(\"http://gghai:5076/v1/config/query/all\", <options xmlns=\"xdmp:http\">\r\n       <authentication method=\"digest\">\r\n         <username>admin</username>\r\n         <password>admin</password>\r\n       </authentication>\r\n     </options>)[2]\r\nreturn search:check-options($options/*); \r\n\r\nagainst the module db ,  returns the empty sequence ."}, {"time":"2013-03-04T15:02:06.541449-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-03-04T15:02:06.541449-08:00", "fixedAt":"2012-10-24T14:35:45.671211-07:00", "fixedBy":{"username":"jfuller", "name":"Jim Fuller", "email":"jim.fuller@marklogic.com"}, "shippedAt":"2013-03-04T15:02:06.541449-08:00", "shippedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}