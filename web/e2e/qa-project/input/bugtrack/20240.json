{"id":20240, "kind":"Bug", "createdAt":"2011-10-13T21:50:43.735084-07:00", "status":"Closed", "title":"[IE] no notification that package revert was succesful in IE", "category":"Config Management", "severity":"Major", "priority":{"level":"2", "title":"Not required for product release"}, "submittedBy":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"1. In IE, in packaging UI, create a package of the documents database\r\n2. open the package in editor and change a couple of settings from true to false\r\n3. in packaging UI, import the modified package, you should see that there are differences with the current config as expected.\r\n4. apply the package. \r\n5. select the id of the ticket and copy it. \r\n6. in browser enter the following url: \r\nhttp://localhost:8002/manage/v1/tickets/[enter ticketid here]/revert\r\n\r\nand hit revert.\r\n\r\nResult: nothing happens, if you import the package again you will see that the revert was actually successful because the differences with current config match what was shown as result of step 3. \r\n\r\nBoth firefox and safari work fine and show the following:\r\n<pkg:result xmlns:pkg=\"http://marklogic.com/package\"><pkg:ticket-id>/tickets/ticket/9732319752202503931</pkg:ticket-id><pkg:result-status>UNLOADED</pkg:result-status><pkg:result-event>PACKAGE_REVERTED</pkg:result-event></pkg:result> \r\n5. ", "samplequery":"", "sampledata":"", "version":"6.0-nightly", "tofixin":"6.0-5", "fixedin":"6.0-5", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, {"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, {"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, {"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}], "attachments":[{"name":"bug.15501.patch", "uri":"root/support/bugtracking/attachments/15501/bug.15501.patch"}], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":15501, "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["Config Management", "ybertaud"], "changeHistory":[{"time":"2011-10-13T21:50:43.735084-07:00", "updatedBy":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "to":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-13T21:50:53.55727-07:00", "updatedBy":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "to":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-13T22:00:59.179533-07:00", "updatedBy":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "to":{"username":"nwalsh", "name":"Norman Walsh", "email":"norman.walsh@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-13T22:07:41.222316-07:00", "updatedBy":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"assigning back to Erik as I don't believe norm as a windows machine."}, {"time":"2011-10-13T22:07:41.222316-07:00", "updatedBy":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}, "to":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-14T12:33:06.378307-07:00", "updatedBy":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I couldn't reproduce (see attached screengrab).  Yann, however sees the problem reliably.\r\n\r\nChristophe indicates that IE has a problem with .text(), which is used to show the result at line 91 in Apps/packaging/revert-package.xqy\r\n\r\nThe .html() function (in JQuery) is preferred.  The XML, however, will require some transformation for presentation."}, {"time":"2011-10-14T12:49:32.389099-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"try adding the following JS code:\r\n\r\nnl2br = function(text) {\r\n    var pattern = \"\\n\",\r\n    regEx = new RegExp(pattern, \"g\");\r\n\r\n    return text.replace(regEx, '<br />');\r\n};\r\n\r\n$([DOM ELEMENT YOU ARE UPDATING]).html(nl2br($('<div/>').text([text you want displayed]).html()));\r\n\r\nAlternatively, I think Christophe is advocating for:\r\nvar text = document.createTextNode([text you want displayed]);\r\n$([DOM ELEMENT YOU ARE UPDATING]).html(text);\r\n\r\nHope that helps!\r\n\r\n\r\n"}, {"time":"2011-10-14T13:11:26.679665-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"oopz, I was incorrect in my implementation of Christophe's method.  After testing out my code, here's the working version:\r\n\r\nvar text = document.createTextNode([text you want displayed]);\r\n$([DOM ELEMENT YOU ARE UPDATING]).html('');  // clear contents\r\n$([DOM ELEMENT YOU ARE UPDATING]).append(nl2br(text.nodeValue));\r\n\r\nLet me know if you have any issues.\r\n\r\nRegards,\r\nScott D Brooks\r\n\r\n\r\n"}, {"time":"2011-10-14T16:18:31.25829-07:00", "updatedBy":{"username":"wwallach", "name":"Walt Wallach", "email":"wwallach@marklogic.com"}, "change":{"assignTo":{"from":{"username":"wwallach", "name":"Walt Wallach", "email":"wwallach@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-14T16:19:58.689832-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Working with Erik on this as we speak... await response to a question regarding why XQuery is rendering my HMTL tag incorrectly."}, {"time":"2011-10-14T17:22:45.82159-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Collaborated with Erik on a fix.  Patch attached.  Erik can you have a look and if OK, please approve?  Thanks."}, {"time":"2011-10-14T17:22:45.82159-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-14T18:08:26.793316-07:00", "updatedBy":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"It looks like that will work.  Maybe ask Yann to confirm that it fixes the problem in the environments\r\nwhere he sees it?  (I couldn't reproduce the original problem.)"}, {"time":"2011-10-17T11:19:47.025297-07:00", "updatedBy":{"username":"mwooldri", "name":"Mike Wooldridge", "email":"mike.wooldridge@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Applied patch and tested on QA test machine in IE8, works as described. Confirmed and approved."}, {"time":"2011-10-17T11:36:00.673345-07:00", "updatedBy":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ehennum", "name":"Erik Hennum", "email":"erik.hennum@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-17T12:13:54.450494-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}}}, "files":[], "show":true, "comment":"Looks like we got the green light, so I've committed the fix."}, {"time":"2011-10-17T12:13:54.450494-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"ybertaud", "name":"Yann  Bertaud", "email":"ybertaud@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-18T15:48:39.823214-07:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "to":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-10-18T17:43:52.409235-07:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on 10/18 build . When the changes are reverted on IE8 user see the below  message now : \r\n\r\n \"<pkg:result xmlns:pkg=\"http://marklogic.com/package\"><pkg:ticket-id>/tickets/ticket/16041999392413696754</pkg:ticket-id><pkg:result-status>UNLOADED</pkg:result-status><pkg:result-event>PACKAGE_REVERTED</pkg:result-event></pkg:result>\r\n"}, {"time":"2011-10-18T17:43:52.409235-07:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-10T11:24:31.220999-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-10T11:26:28.17048-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true, "comment":"Not sure if this got forward ported . Can be looked into when Bug 20239 \tPackage Revert Functionality not working on b6_0 s fixed by Norm. "}, {"time":"2012-12-10T11:26:28.17048-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-10T11:26:28.17048-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2012-12-10T12:32:49.410929-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hmmm, ok, thanks.  I'll look into it."}, {"time":"2013-03-01T13:33:16.304785-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Scott,\r\n\r\nWould you be able to fix this for 6.0-3 (code freeze 03/15)"}, {"time":"2013-03-01T13:41:25.112209-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Yea, looks like it's just in need forward porting for 6.0 & 7.  Shouldn't be a problem.  This was pre documentation of commits, so might take a bit to track down."}, {"time":"2013-03-18T14:45:43.408387-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true, "comment":"Ok, I finally got a chance to look at the codebase.  This patch was already applied to 6.0 AND this code no longer exists in 7.0 trunk or 7.0-ea1, as we are making packaging a part of Config Mgr.  \r\n\r\nI'm sending this bug off to test, as the issue was already patched some time ago for 6.0"}, {"time":"2013-03-18T14:45:43.408387-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-19T15:08:59.843143-07:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "to":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-27T14:16:50.840594-07:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Scott , this bug cannot be verified due to open Bug 20239 -  Package Revert Functionality not working on b6_0 . Can we move to this to 6.0.4 release time frame. ?"}, {"time":"2013-03-27T14:17:11.884594-07:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-27T14:17:11.884594-07:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-28T20:45:36.191824-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"tofixin":{"from":"6.0-3", "to":"6.0-4"}}, "files":[], "show":true}, {"time":"2013-06-24T16:18:57.228219-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Bug 20239 - Package Revert Functionality not working on b6_0 is  still open, so it seems this will need to be pushed until that is fixed.  I've subscribed myself to that bug to track its' completion.  I'm moving this to 6.0-5 for now.  \r\n\r\nIf 20239 gets fixed with enough time for me to tackle this issue, then I'll push it back to 6.0-4."}, {"time":"2013-06-24T16:18:57.228219-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"tofixin":{"from":"6.0-4", "to":"6.0-5"}}, "files":[], "show":true}, {"time":"2014-02-20T17:27:55.703204-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on the latest 6.0 nightly 02.20 . on IE9 , able to verify the revert functionality . "}, {"time":"2014-02-20T17:27:55.703204-08:00", "updatedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2014-02-20T17:27:55.703204-08:00", "fixedAt":"2013-03-18T14:45:43.408387-07:00", "fixedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "shippedAt":"2014-02-20T17:27:55.703204-08:00", "shippedBy":{"username":"gghai", "name":"Gaurav Ghai", "email":"Gaurav.ghai@marklogic.com"}, "renderDescriptionAs":"normal"}