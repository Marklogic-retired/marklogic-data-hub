{"id":204, "kind":"Bug", "createdAt":"2003-11-06T14:59:11-08:00", "status":"Closed", "title":"Changing schema database for a database sometime gets 500 internal Server Error.", "category":"", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"1. do a fresh install 2. go to databases page on admin interface, pick a database( i.e. security database). 3. without changing anything, click OK. 4. after the page comes back, change the schema database, click OK. you will get following error : 500 Internal Server Error XDMP-CAST: () cast as -- Invalid cast in /database-admin-go.xqy, on line 38, in fn:rebuildDatabaseConfig(doc(\"forest.xsd\")/xs:schema, \"security-database\", (doc(\"databases.xml\")/fr:databases/fr:database[1]/fr:security-database), \"/fr:databases/fr:database[1]\", fr:database-id(\"3634102016083110051\")) $schemaroot = doc(\"forest.xsd\")/xs:schema $name = \"security-database\" $val = doc(\"databases.xml\")/fr:databases/fr:database[1]/fr:security-database $parentindex = \"/fr:databases/fr:database[1]\" $dbid = fr:database-id(\"3634102016083110051\") $sr = \"http://cerisent.com/xdmp/forest\" $decl = (doc(\"forest.xsd\")/xs:schema/xs:element[34]) $t = \"database-id\" $simple = (doc(\"forest.xsd\")/xs:schema/xs:simpleType[12]) $complex = () $index = \"/fr:databases/fr:database[1]/fr:security-database\" $req = () in /database-admin-go.xqy, on line 67, in fn:rebuildDatabaseConfig(doc(\"forest.xsd\")/xs:schema, \"database\", (doc(\"databases.xml\")/databases/database[1]), \"\", database-id(\"3634102016083110051\")) $schemaroot = doc(\"forest.xsd\")/xs:schema $name = \"database\" $val = doc(\"databases.xml\")/fr:databases/fr:database[1] $parentindex = \"\" $dbid = fr:database-id(\"3634102016083110051\") $sr = \"http://cerisent.com/xdmp/forest\" $decl = (doc(\"forest.xsd\")/xs:schema/xs:element[36]) $t = \"database\" $simple = () $complex = (doc(\"forest.xsd\")/xs:schema/xs:complexType[15]) $index = \"/fr:databases/fr:database[1]\" $rf = doc(\"forest.xsd\")/xs:schema/xs:complexType[15]/xs:all/xs:element[3]/@ref $name2 = xs:QName(\"fr:security-database\") $value2 = (doc(\"databases.xml\")/fr:databases/fr:database[1]/fr:security-database) in /database-admin-go.xqy, on line 101, in fn:rebuildDatabaseConfig1((doc(\"forest.xsd\")/xs:schema), (doc(\"databases.xml\")/fr:databases)) $schemaroot = doc(\"forest.xsd\")/xs:schema $datanode = doc(\"databases.xml\")/databases $curr = database-id(\"3634102016083110051\") $g = (doc(\"databases.xml\")/databases/database[1]) in /database-admin-go.xqy, on line 117 $confirm = \"21\" $cancel = \"\" $schemaroot = (doc(\"forest.xsd\")/xs:schema) $datanode = (doc(\"databases.xml\")/fr:databases)", "samplequery":"", "sampledata":"", "version":"main branch", "tofixin":"", "fixedin":"", "platform":"windows", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}], "attachments":[], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["", "rwang"], "changeHistory":[{"time":"2003-11-06T14:59:37-08:00", "updatedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "change":{}, "files":[], "show":false}, {"time":"2003-11-06T14:59:37-08:00", "updatedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "to":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}}}, "files":[], "show":true, "comment":"Assign to Ron"}, {"time":"2003-11-06T15:54:05-08:00", "updatedBy":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "change":{}, "files":[], "show":false}, {"time":"2003-11-06T15:54:05-08:00", "updatedBy":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "to":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}}}, "files":[], "show":true, "comment":"fixed, but this was hitting our known bug of setting up the session. like having to log on to bugtrack multiple times"}, {"time":"2003-11-23T13:57:39-08:00", "updatedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "to":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}}}, "files":[], "show":true, "comment":"Verified on 2.0-test16."}, {"time":"2003-11-25T11:48:53-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "to":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}}}, "files":[], "show":true, "comment":"Shipped in 2.0"}], "updatedAt":"2003-11-25T11:48:53-08:00", "fixedAt":"2003-11-06T15:54:05-08:00", "fixedBy":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "shippedAt":"2003-11-23T13:57:39-08:00", "shippedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "closedAt":"2003-11-25T11:48:53-08:00", "closedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "renderDescriptionAs":"normal"}