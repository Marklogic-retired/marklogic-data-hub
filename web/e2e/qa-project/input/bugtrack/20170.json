{"id":20170, "kind":"Task", "createdAt":"2012-11-30T10:44:37.626061-08:00", "status":"Closed", "title":"Document mlcp behavior on connecting to forests hosts.", "category":"mlcp", "severity":"Minor", "priority":{"level":"5", "title":""}, "days":null, "period":{"startDate":null, "endDate":null}, "submittedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"mlcp takes a hostname as input for target MarkLogic instance.  mlcp uses this host name to connect to a MarkLogic instance to query a list of forests the database has and a list of hosts those forests are attached to.  After that, mlcp connects directly to those hosts for import work.\r\n\r\nThere are a few cases where people have a forest's host name to be \"localhost\" or a host name that's not reachable by the machine where mlcp is invoked.  In that case, mlcp will report a connection failure \"Connection refused\".  I have talked to folks here including Wayne, and we believe that this is a configuration issue of MarkLogic.  But it is worth documenting the behavior so that people aren't tripped by this.  \r\n\r\nWe should consider adding checks, debug messages in mlcp to tell people the hosts that mlcp is attempting to connect.  So that when a connection refused error occurs, people understand what is going on.  \r\n\r\nAries, I'm giving the bug to you so that you put in the proper logging/error handling code first.  After you are done, please pass on the bug to Kim.", "samplequery":"", "sampledata":"", "version":"6.0-1", "tofixin":"7.0-1", "fixedin":"7.0-1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, {"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, {"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, {"username":"jsolis", "name":"Julio Solis", "email":"Julio.Solis@marklogic.com"}, {"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}], "attachments":[], "includeInTaskList":false, "proceduralTasks":{"Requirements Task":[], "Functional Specification Task":[], "Test Specification Task":[], "Test Automation Task":[], "Documentation Task":[]}, "subTasks":[], "tags":["mlcp", "jchen"], "changeHistory":[{"time":"2012-11-30T10:44:37.626061-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-27T13:02:18.472099-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"6.0-3", "to":"6.0-4"}}, "files":[], "show":true}, {"time":"2013-06-14T11:53:51.311166-07:00", "updatedBy":{"username":"fsalonga", "name":"Frank Salonga", "email":"franklin.salonga@marklogic.com"}, "change":{"tofixin":{"from":"6.0-4", "to":"7.0-1"}}, "files":[], "show":true}, {"time":"2013-07-23T17:54:02.946446-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"When a connection refused error occurs, the error message has the hostname and port.\r\ne.g.,\r\n3/07/15 14:57:18 ERROR contentpump.DatabaseContentReader: com.marklogic.xcc.exceptions.Serv\r\nerConnectionException: Connection refused: connect\r\n[Session: user=lnmldev, cb=#7523816799491012657 [ContentSource: user=lnmldev, cb={none} [pr\r\novider: address=cpmllb2a705.lexis-nexis.com/10.182.84.247:8040, pool=0/64]]]\r\n[Client: XCC/6.0-3] \r\n\r\nI think it has enough message for people to figure out what goes wrong When a connection refused error occurs.\r\n\r\nWe can add debug or fine level message that tells the hosts mlcp is attempting to connect."}, {"time":"2013-07-23T17:59:00.68898-07:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Ok.  Use debug please."}, {"time":"2013-07-24T14:12:40.80145-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"147546", "paths":["xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/TransformWriter.java", "xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/DatabaseTransformWriter.java", "xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/DatabaseContentWriter.java"], "affectedBugs":[]}, "comment":"Bug:20170 \nadd debug messages tell the hosts mlcp is attempting to connect"}, {"time":"2013-07-24T14:20:25.305077-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"147547", "paths":["xcc/trunk/mapreduce/src/java/com/marklogic/mapreduce/MarkLogicRecordReader.java", "xcc/trunk/mapreduce/src/java/com/marklogic/mapreduce/MarkLogicRecordWriter.java", "xcc/trunk/mapreduce/src/java/com/marklogic/mapreduce/ContentWriter.java"], "affectedBugs":[]}, "comment":"Bug:20170 \nadd debug messages tell the hosts mlcp/mapreduce is attempting to connect"}, {"time":"2013-07-24T14:22:45.537426-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Kim, I am passing this bug to you so that you can document it.\r\n-Aries"}, {"time":"2013-07-24T14:22:45.537426-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-25T04:31:32.28553-07:00", "updatedBy":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Cloning so documentation doesn't hold up QA."}, {"time":"2013-07-25T04:35:16.054607-07:00", "updatedBy":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Aries, I've cloned this bug for the documentation portion. That's usually a better way to  handle bugs that require a doc update. Otherwise, QA can get delayed just because of differing priorities.\r\n\r\nI imagine this is ready to move into the test phase and be assigned to someone in QA, but as I am not sure and do not know who to assign it, I am returning it to you to take of that part."}, {"time":"2013-07-25T04:35:16.054607-07:00", "updatedBy":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, "change":{"assignTo":{"from":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-25T10:45:31.86653-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true, "comment":"Please turn on debug level logging for mlcp and mapreduce to test import, export and copy. It should show debug level log on which host or forest mlcp connects to.\r\nIt shouldn't introduce regression."}, {"time":"2013-07-25T10:45:31.86653-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-08-27T16:42:21.956512-07:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"jsolis", "name":"Julio Solis", "email":"Julio.Solis@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-10-09T16:48:44.755917-07:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-10-10T10:30:12.315321-07:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"status":{"from":null, "to":"Ship"}, "assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-20131004"}], "updatedAt":"2013-10-10T10:30:12.315321-07:00", "fixedAt":"2013-07-25T10:45:31.86653-07:00", "fixedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "shippedAt":"2013-10-10T10:30:12.315321-07:00", "shippedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}