{"id":20794, "kind":"Task", "createdAt":"2013-02-14T13:56:18.38584-08:00", "status":"Closed", "title":"Task: Allow users to change settings on a field that get inherited from database settings.", "category":"search", "severity":"Critical", "priority":{"level":"5", "title":""}, "days":null, "period":{"startDate":null, "endDate":null}, "submittedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"This involves changes to server, admin api and ui.\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea2", "fixedin":"7.0-ea2", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}], "attachments":[], "includeInTaskList":false, "proceduralTasks":{"Requirements Task":[], "Functional Specification Task":[], "Test Specification Task":[], "Test Automation Task":[], "Documentation Task":[]}, "subTasks":[20801, 20802], "tags":["search", "gchinchwadkar"], "changeHistory":[{"time":"2013-02-14T13:56:18.38584-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-15T05:40:39.459452-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"svn commit\r\nSending        src/Admin/lib/create-field-form.xqy\r\nSending        src/Admin/lib/database-field-utils.xqy\r\nSending        src/Indexer.cpp\r\nSending        src/PathConfig.h\r\nSending        src/SearchBuiltins.cpp\r\nTransmitting file data .....\r\nCommitted revision 131920.\r\n"}, {"time":"2013-02-15T06:05:47.965166-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-15T06:05:47.965166-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-14T11:49:45.610428-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Kuldeep,\r\n\r\nI have verified this bug manually on build 7.0-ea1_20130313. This can be tested and automated by doing the following on the UI:\r\n\r\n1. On any database, set the stemmed searches to 'advanced'.\r\n2. Enable word-searches.\r\n3. Now go to 'Fields' under the same database.\r\n4. Create a new field with 'include-root' set to 'false' and click 'ok.\r\n5. You will see that the stemmed searches set to 'advanced' and word-searches is enabled. (This is the first step in verification).\r\n6. Now you should be able to set the stemmed searches to 'basic' or 'decompounding' and disable word-searches too. (This would be the second verification step)."}, {"time":"2013-03-14T11:49:45.610428-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-15T02:38:03.015799-07:00", "updatedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "change":{"status":{"from":null, "to":"Ship"}, "assignTo":{"from":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Added AdminUIBug20794.java to regression.\r\n\r\nThanks\r\nKuldeep"}, {"time":"2013-03-15T15:18:19.978709-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true, "comment":"Although I verified this on the UI and the bug seems to be fixed, there still seems to be a bug in the admin API. Hence I'm moving it back to 'fix'."}, {"time":"2013-03-15T15:18:19.978709-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-15T15:18:19.978709-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"tofixin":{"from":"7.0-ea1", "to":"7.0-ea2"}}, "files":[], "show":true}, {"time":"2013-03-15T21:29:07.15836-07:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"From: Mahalakshmi Srinivasan \r\nSent: Thursday, March 14, 2013 1:49 PM\r\nTo: Gajanan Chinchwadkar\r\nSubject: bug20794\r\n\r\nHello Gajanan,\r\n\r\nWhile testing bug 20794, I was able to verify the fix manually on the UI. However, while trying it using admin API, the change in DB settings does not get propagated to the fields completely.\r\n\r\nAfter setting stemmed-searches to ‘advanced’ and enabling ‘word-searches’, even after a sleep of 30 seconds, the databases.xml does not have stemmed-searches and word-searches to be ‘true’.  However, on the admin UI, when I try the same thing it seems to be carrying the db settings to the ‘fields’.\r\n\r\nThe test is path-fields-bug20794.xml. You can do an svn update under scripts/tests directory.\r\n\r\nLet me know if I’m missing something.\r\n\r\nThanks,\r\nMaha.\r\n"}, {"time":"2013-03-15T21:29:51.825148-07:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"From: Gajanan Chinchwadkar \r\nSent: Friday, March 15, 2013 9:28 PM\r\nTo: Mahalakshmi Srinivasan\r\nSubject: RE: bug20794\r\n\r\nDid admin UI changed the databases.xml and api didn’t?\r\n\r\nI think you saw the settings inherited in the admin UI. Admin api has no such way to show that. Neither admin API nor UI should modify the datbases.xml when database level settings are done. However when you unset an inherited setting explicitly at field level using UI or API both the entry is supposed to go to databases.xml. After that any database level change for that particular setting should not affect the field setting.\r\n"}, {"time":"2013-03-19T14:47:43.622825-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Gajanan and I went over the scenarios. Then we found a difference in behavior between admin UI an admin API. While following all the steps in the test for UI, the field database settings gets reflected in databases.xml. \r\n\r\nHowever, while following the same steps via admin API as in test path-fields-bug20794.xml, the settings does not get reflected either UI or in databases.xml.\r\nTo see this repro, you can run \r\n    make ut tname=path-fields-bug20794.xml user=admin pass=admin ignore=teardown"}, {"time":"2013-03-20T12:30:34.054627-07:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"137280", "paths":["xdmp/trunk/src/Crypt.h", "xdmp/trunk/src/Crypt.cpp"], "affectedBugs":[]}, "comment":"Minor optimization and compilation wih SSL=0 for bug:20794.\n"}, {"time":"2013-03-26T18:04:33.350764-07:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true, "comment":"Based on phone conversation with Maha. This behavior seems to be correct. Moving the bug back to \"test\"."}, {"time":"2013-03-26T18:04:33.350764-07:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-05-08T14:32:35.008626-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"As od 7.0-20130506, the behavior  seems to be correct in the sense that the settings get inherited to the fields page and an unfiltered search returns the correct results when the word-searches are enabled at the database level.\r\n\r\nBut the settings do not show up properly on the UI or in databases.xml. Will talk to Gajanan and file a separate bug and close this one."}, {"time":"2013-05-08T17:37:48.100833-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":null, "to":"Ship"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-20130506. Will file a separate bug for the databases.xml and UI not getting updated while inheriting the database config settings."}], "updatedAt":"2013-05-08T17:37:48.100833-07:00", "fixedAt":"2013-03-26T18:04:33.350764-07:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "shippedAt":"2013-05-08T17:37:48.100833-07:00", "shippedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}