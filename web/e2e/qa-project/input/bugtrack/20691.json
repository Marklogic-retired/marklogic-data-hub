{"id":20691, "kind":"RFE", "createdAt":"2010-09-15T13:47:28.638959-07:00", "status":"Closed", "title":"Combining range indexes in an FLWOR order by with a union operator", "category":"XQuery", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"jhoy", "name":"Joe Hoy", "email":"Joe.Hoy@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"This was a problem we encountered while workign with Jeni Tennison at TSO.  The following is a description of the problem from the email I sent to Discuss.\r\n------------\r\nYou have two types of legislation - Primary and Secondary, each having a different type of metadata format.  What they originally tried to do was this:\r\n\r\norder by\r\n....\r\nxs:integer($item/ukm:PrimaryMetadata/ukm:Year/@Value | $item/ukm:SecondaryMetadata/ukm:Year/@Value) descending,\r\n    if ($sort = 'created') then () else xs:integer($item/ukm:PrimaryMetadata/ukm:Number/@Value | $item/ukm:SecondaryMetadata/ukm:Number/@Value) descending,\r\n    xs:date($item/ukm:PrimaryMetadata/ukm:EnactmentDate/@Date | $item/ukm:SecondaryMetadata/ukm:Made/@Date) descending\r\n\r\nAny (either | or) predicate will cause MarkLogic to brute force the ordering even if both attributes concerned have a range index. \r\n-----------\r\n\r\nWould it be possible to make this type of order by work using the range indexes?", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"8.0-1", "fixedin":"N/A", "platform":"all", "memory":"", "processors":"", "note":"Pushed from RFE #1716 in RFETrack by jhoy on Mon Feb 04 2013, 10:12AM.", "subscribers":[{"username":"jhoy", "name":"Joe Hoy", "email":"Joe.Hoy@marklogic.com"}, {"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}], "attachments":[], "includeInTaskList":false, "proceduralTasks":{"Requirements Task":[], "Functional Specification Task":[], "Test Specification Task":[], "Test Automation Task":[], "Documentation Task":[]}, "subTasks":[], "tags":["XQuery", "jhoy"], "changeHistory":[{"time":"2010-09-15T13:48:12.951391-07:00", "updatedBy":{"username":"jhoy", "name":"Joe Hoy", "email":"Joe.Hoy@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"xs:integer should read xs:int"}, {"time":"2013-02-08T13:53:15.252571-08:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"7.0-1"}}, "files":[], "show":true}, {"time":"2013-02-15T13:20:27.289229-08:00", "updatedBy":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "to":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}}}, "files":[], "show":true, "comment":"Is this something we need to do for 7? If so, can you make sure it gets tracked appropriately? thx."}, {"time":"2013-02-15T13:20:27.289229-08:00", "updatedBy":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "to":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-15T13:54:50.746507-08:00", "updatedBy":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Mary - would you expect this to work?"}, {"time":"2013-02-15T13:54:50.746507-08:00", "updatedBy":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2013-02-15T14:44:55.918027-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"This is an RFE, not a bug. The set of cases that use fast order by is quite limited."}, {"time":"2013-05-20T08:53:18.231347-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"Recommend putting off to 8.0-1."}, {"time":"2013-06-24T07:44:41.55179-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"tofixin":{"from":"7.0-1", "to":"8.0-1"}}, "files":[], "show":true}, {"time":"2014-05-02T13:42:06.249576-07:00", "updatedBy":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, "change":{"status":{"from":null, "to":"Closed"}, "assignTo":{"from":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Closed - this will be resolved in ML8 under \r\nhttp://rfetrack.marklogic.com/detail/2850"}, {"time":"2014-05-02T13:42:06.249576-07:00", "updatedBy":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2014-05-02T13:42:06.249576-07:00", "closedAt":"2014-05-02T13:42:06.249576-07:00", "closedBy":{"username":"sbuxton", "name":"Stephen Buxton", "email":"stephen.buxton@marklogic.com"}}