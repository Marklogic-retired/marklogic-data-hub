{"id":2003, "kind":"Bug", "createdAt":"2005-08-02T11:00:29.500657-07:00", "status":"Closed", "title":"Spurious space injection before newline in constructed element nodes", "category":"xdmp", "severity":"Functional", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"2.2 injects a spurious space before newlines in constructed element nodes:\n\nxdmp:url-encode(xdmp:quote(\n<replace-me>\n   <son>4</son>\n   <daughter>12</daughter>\n</replace-me>\n))\n\ngenerates:\n\n<replace-me>+%0a++<son>4</son>+%0a++<daughter>12</daughter>+%0a</replace-me>\n\nNote the spaces (+ characters) that occur before every %0a (newline) character.", "samplequery":"", "sampledata":"", "version":"2.2-8", "tofixin":"3.1-1", "fixedin":"3.0-1", "platform":"linux", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}], "attachments":[], "clones":[], "cloneOf":"", "support":{"headline":"CR (%0d) characters in constructed nodes converted to spaces", "supportDescription":"If a constructed node contains carriage return characters (%0d), those characters are converted to spaces (%20) and are not stripped from the constructed node.  Constructed nodes are frequently encountered inline in XQuery, particularly in xdmp:document-insert() and xdmp:node-*() node update functions.  This issue should only impact external systems that are brittle when subjected to whitespace before the linefeed characters.  Note that XQuery modules evaluated on the Windows platform have all CR (%0d) characters stripped from the module at the time they are loaded from the filesystem, but this does not occur on Linux or Solaris platforms.", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "ian"], "changeHistory":[{"time":"2005-08-10T15:45:23.373012-07:00", "updatedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"It turns out that in 2.2, carriage returns (hex 0d) are turned into spaces.  So, in the above, if the input was %0d%0a, that gets turned into +%0a."}, {"time":"2005-08-11T14:03:41.378184-07:00", "updatedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"this bug was essentially obsoleted by 3.0-1.  I do not think we should fix this bug on the 2.2 branch, as it changes behavior late in the game."}, {"time":"2005-08-11T14:04:09.867248-07:00", "updatedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"closed."}], "updatedAt":"2005-08-11T14:04:09.867248-07:00", "shippedAt":"2005-08-11T14:03:41.378184-07:00", "shippedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "closedAt":"2005-08-11T14:04:09.867248-07:00", "closedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "renderDescriptionAs":"normal"}