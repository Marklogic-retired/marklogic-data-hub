{"id":20948, "kind":"Bug", "createdAt":"2013-01-14T15:49:53.915895-08:00", "status":"Closed", "title":"mlcp copy naked properties fails with output_uri_suffix specified", "category":"mlcp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"if the source database set the directory creation to automatic,\r\nmlcp copy naked properties fails with output_uri_suffix specified.\r\n\r\nThis has an impact for the  ML 5 support for mlcp because, \"automatic\" is the default in ML 5.", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea2", "fixedin":"7.0-ea2", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, {"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20464, "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["mlcp", "ali"], "changeHistory":[{"time":"2013-01-14T15:49:53.915895-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-14T15:56:33.127278-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"This bug is found when working on ML5 support for mlcp.\r\nCurrent implementation of DatabaseContentWriter relies on the uri to tell if it is a naked property. When output_uri_suffix is applied, it no longer ends with \".naked\".\r\nOne way to fix it is to have this type information in metadata."}, {"time":"2013-01-14T15:58:38.733756-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"workaround is to set directory creation to manual."}, {"time":"2013-01-23T10:35:55.411549-08:00", "updatedBy":{"username":"jmakeig", "name":"Justin Makeig", "email":"jmakeig@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Why are we working on v5 compatibility?"}, {"time":"2013-01-23T10:50:43.410228-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I have the task, see Bug 19383."}, {"time":"2013-01-28T11:31:33.133677-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"This is a corner case.  Will fix it if Aries has time."}, {"time":"2013-02-08T15:12:42.234472-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-26T17:15:32.916487-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"133766", "paths":["xcc/trunk/mlcp/src/test/java/com/marklogic/contentpump/TestCopy.java", "xcc/trunk/mlcp/src/test/resources/20059", "xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/DatabaseContentWriter.java", "xcc/trunk/mlcp/src/test/resources/20059/twitter_1332448843475.xml.metadata", "xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/ArchiveWriter.java", "xcc/trunk/mlcp/src/test/resources/20059/twitter_1332448843475.xml", "xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/DatabaseContentReader.java"], "affectedBugs":["20741"]}, "comment":"bug:20948 bug:20741\n1.DatabaseContentReader always get value as MarkLogicDocumentWithMeta\n2.refactor DatabaseContentWriter\n3.test cases"}, {"time":"2013-02-26T17:16:29.806774-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"7.0-ea2"}}, "files":[], "show":true}, {"time":"2013-02-26T18:14:16.060817-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true, "comment":"You can test it by inserting naked properties and then do mlcp copy, \r\nor insert regular documents whose uri contains directory into a db configured with \"automatic directory creation\" and then do mlcp copy.\r\n\r\nAnd please keep an eye on regression."}, {"time":"2013-02-26T18:14:16.060817-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-27T18:20:57.023174-07:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"137914", "paths":["xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/ArchiveWriter.java"], "affectedBugs":["21317"]}, "comment":"Bug:21317 Bug:20948\nnaked properties have suffix \".naked\" in archive"}, {"time":"2013-04-10T15:14:51.893024-07:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-20130410"}], "updatedAt":"2013-04-10T15:14:51.893024-07:00", "fixedAt":"2013-02-26T18:14:16.060817-08:00", "fixedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "shippedAt":"2013-04-10T15:14:51.893024-07:00", "shippedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "renderDescriptionAs":"normal"}