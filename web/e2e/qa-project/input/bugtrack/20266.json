{"id":20266, "kind":"Bug", "createdAt":"2012-03-06T21:12:53.963858-08:00", "status":"Closed", "title":"Some links in Configuration Manager do not maintain HTTPS", "category":"Config Management", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"When SSL (https) is enabled for Manage app server (port 8002), some of the links do not maintain HTTPS protocol and lead to error/blank pages.\r\n\r\nSteps to reproduce:\r\n1. Enable SSL for Manage app server (:8002)\r\n2. Navigate to https://localhost:8002/nav/?type=databases\r\nConfiguration Manager should display a list of resources with Edit and Management API icons beside each one.\r\n3. Click on Management API icon for one of the resources\r\n\r\nExpected Result:\r\nSince Management API is also on port 8002, the links should lead to HTTPS pages accordingly.\r\n\r\nActual Result:\r\nThe links point to HTTP pages which results in error or blank page depending on the browser.\r\n\r\nExample of proper behavior can be observed by clicking on one of the resources as mentioned in the steps above. This would lead to a details page for a specific resource. This page contains its own Management API link which correctly points to HTTPS page.", "samplequery":"", "sampledata":"", "version":"5.0-2", "tofixin":"6.0-5", "fixedin":"6.0-5", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, {"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, {"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}], "attachments":[{"name":"Error in Firefox.", "uri":"root/support/bugtracking/attachments/20266/Screenshot from 2013-03-28 10:36:29.png"}], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":16493, "support":{"headline":"Some links in Configuration Manager do not maintain HTTPS", "supportDescription":"When SSL (https) is enabled for Manage app server (port 8002), some of the links do not maintain HTTPS protocol and lead to error/blank pages.\r\n \r\nSteps to reproduce:\r\n1. Enable SSL for Manage app server (:8002)\r\n2. Navigate to https://localhost:8002/nav/?type=databases\r\nConfiguration Manager should display a list of resources with Edit and Management API icons beside each one.\r\n3. Click on Management API icon for one of the resources\r\n \r\nExpected Result:\r\nSince Management API is also on port 8002, the links should lead to HTTPS pages accordingly.\r\n \r\nActual Result:\r\nThe links point to HTTP pages which results in error or blank page depending on the browser.\r\n", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":"manually change the broken path to HTTPS or HTTP respectively."}, "tags":["Config Management", "vkorolev"], "changeHistory":[{"time":"2012-03-06T21:12:53.963858-08:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-08T23:30:58.766226-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-10T12:10:44.213774-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true, "comment":"Good catch.  This shouldn't be hard to fix.  Thanks."}, {"time":"2012-12-12T11:25:47.159238-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"6.0 branch clone"}, {"time":"2012-12-12T11:25:47.159238-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-01-11T19:15:22.593075-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"127511", "paths":["xdmp/branches/b6_0/src/Apps/nav/js/components/resource-list/resource-list.js"], "affectedBugs":[]}, "comment":"Bug:20266 - fixed Management API link issue on HTTPS"}, {"time":"2013-01-11T19:17:59.439431-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true, "comment":"Sending to test"}, {"time":"2013-01-11T19:17:59.439431-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-27T17:26:01.421548-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true, "comment":"The steps in this bug lead to a different problem. Links maintain HTTPS however there is some issue with SSL connection. Firefox returns \"Secure Connection Failed (Error code: ssl_error_rx_record_too_long)\" whereas Chrome reports \"Error 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL protocol error.\"."}, {"time":"2013-03-28T10:30:05.57912-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-28T10:33:15.369945-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Please attach a screenshot.  That sounds more like an issue with the server, than the front-end app, but since I've never seen this before, I'm unsure what exactly is going on."}, {"time":"2013-03-28T10:33:15.369945-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-28T10:38:06.959786-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I agree, this does seem like a server error."}, {"time":"2013-03-28T10:42:19.718075-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I'm going to close this bug since the original issue is fixed and I'll open a new bug for the current issue."}, {"time":"2013-03-28T10:53:12.765488-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Links described in this bug now redirect to HTTPS however there is a follow up bug where SSL connection breaks.  (21343)"}, {"time":"2013-03-29T11:47:50.452796-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true, "comment":"Scott, I'm re-opening this bug as it seems that we need to do some more parsing. As per bug 21343 it turns out that the error was caused by unencrypted links going to HTTPS. (because they're on a different port)"}, {"time":"2013-03-29T11:47:50.452796-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-29T12:07:55.547723-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Ah, it's a port issue.  I see.  I thought the redirector was forcing everyone to port 8000 in configuration manager."}, {"time":"2013-04-03T14:16:17.847243-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Yep, the redirector should forward the user to port 8002.  I've sent out a message \"Need help with an App url not redirecting\" to App-Services to see if someone can help fix this.  I'll reassign to them when someone steps up."}, {"time":"2013-04-03T16:37:51.421192-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Ok, so the verdict from Mitch and Ganesh is that we DO NOT force the user to configure both 8000 & 8002 as BOTH SSL.  So that means the fix should happen on the application side. \r\n\r\nGanesh agrees that this doesn't need to be a part of 6.0-3 release.  So I'm pushing it back to the next maintenance release.  I'll work with Brian then to see if there's a solution on the XQuery side to detect the proper URLs."}, {"time":"2013-04-03T16:37:51.421192-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"tofixin":{"from":"6.0-3", "to":"6.0-4"}}, "files":[], "show":true}, {"time":"2013-06-24T16:36:02.802994-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"This issue will be fixed when Colleen finishes her fix on:\r\nhttp://bugtrack.marklogic.com/21452\r\nWill push this bug to test when that one is complete."}, {"time":"2013-07-09T09:57:20.426626-07:00", "updatedBy":{"username":"cwhitney", "name":"Colleen  Whitney", "email":"colleen.whitney@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I have just checked in a bix for 21452.  "}, {"time":"2013-07-09T12:44:01.192554-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true, "comment":"Sending to test!"}, {"time":"2013-07-09T12:44:01.192554-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-12T14:16:06.999886-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true, "comment":"Sorry to reopen this so late in the game, but it looks like the original issue is back. After Colleen's fix all navigation links nicely jump between HTTP and HTTPS modes, but the gear-icon links in Config Manager page are now breaking again. Those worked after the first attempt to fix this bug so there might be some interaction between two fixes."}, {"time":"2013-07-12T14:16:06.999886-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-12T14:32:24.216742-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hmm, nothing has changed in those.  Can you give me an example URL that loads broken when you click the gear icon?"}, {"time":"2013-07-12T14:33:29.946098-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"My guess is that this is actually an AppBuilder/InfoStudio issue, not anything to do with Config Mgr, which just links out."}, {"time":"2013-07-12T14:37:23.183109-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"It's the same link as described in the original step for the bug. I have 6.0 running right now if you'd like to try: https://vkorolev.marklogic.com:8002/nav/?type=databases"}, {"time":"2013-07-15T12:11:56.069315-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true, "comment":"Hey Vitaly, I just updated and rebuilt my server, so I'm all up to date.  Looking at the original bug, the issue was with the Management API links on 8002, these links work just fine, so as far as the original bug is concerned, this seems to be fixed.\r\n\r\nIn your comment on 7/12/2013 @ 14:16PM, you're mentioning that the \"gear icon\" links are breaking.  If you'll notice, these are actually links to the infostudio page, which lives on a separate port (8000).  Since Config Mgr is unable to know if you have or do not have SSL setup on port 8000 we cannot detect what the correct URL is.  All the app does is detect if SSL is being used on its application and applies that same http/https prefix to the URLs it generates.\r\n\r\nSo since your test uses SSL on Config Mgr, the generated URL for the database settings link is HTTPS:\r\nhttps://locahost:8000/infostudio/database.xqy?dbid=############\r\nIt appears that you do not have SSL setup on 8000, so the URL does not resolve. \r\n\r\nI took the liberty of adding SSL to 8000, which I think most server admins would do... I mean security protection across the server shouldn't just be for ONE port.  Once I did this for 8000, the URL resolves properly.  I think the way the code behaves today is a reasonable default, in the absence of more information on other ports.\r\n\r\nI'm pushing this back to TEST, as I think this confirms that the bug has been fixed and the code is doing everything it can with the information it has to construct a correct URL.  I think assuming that if one port is SSL that all ports will be SSL is reasonable.  If we are not in agreement, then we'll have to look into creating some other endpoints or new XQuery code that will perform the lookup for the app.  That seems out of scope for the 6.0-4 timeframe though."}, {"time":"2013-07-15T12:11:56.069315-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-17T12:59:44.905931-07:00", "updatedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"All links work as expected."}, {"time":"2014-03-24T05:31:24.629771-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"ga"}], "updatedAt":"2014-03-24T05:31:24.629771-07:00", "fixedAt":"2013-07-15T12:11:56.069315-07:00", "fixedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "shippedAt":"2013-07-17T12:59:44.905931-07:00", "shippedBy":{"username":"vkorolev", "name":"Vitaly Korolev", "email":"vitaly.korolev@marklogic.com"}, "closedAt":"2014-03-24T05:31:24.629771-07:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal"}