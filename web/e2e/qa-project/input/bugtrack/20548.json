{"id":20548, "kind":"Bug", "createdAt":"2013-01-22T00:28:01.6505-08:00", "status":"Will not fix", "title":"bad error thrown by admin:database-add-field()", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"The following xquery:\r\n\txquery version \"1.0-ml\";\r\n\txdmp:eval-in('xquery version \"1.0-ml\";import module namespace admin = \"http://marklogic.com/xdmp/admin\" at \"/MarkLogic/admin.xqy\";\r\n\t try {admin:database-add-field(\r\n\t  admin:get-configuration(),\r\n\t  xdmp:database(\"Documents\"),\r\n\t  <field xmlns=\"http://marklogic.com/xdmp/database\">\r\n\t\t<include-root>true</include-root>\r\n\t  </field>\r\n\t ) }\r\n\t catch ($e) {data($e//*:code)}', xdmp:database(\"Documents\")\r\n\t) \r\n\r\nOn 7.0 returns: \r\nXDMP-VALIDATEUNEXPECTED (only code.. not full message)\r\n******************************************************************************************************************************************************************\r\nwhile on 6.0/5.0 it returns full error message: \r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<results warning=\"atomic item\">XDMP-VALIDATEMISSINGELT: (err:XQDY0027) validate { $field } -- Missing required elements: Expected (db:field-name&amp;db:stemmed-searches?&amp;db:word-searches?&amp;db:fast-phrase-searches?&amp;db:fast-case-sensitive-searches?&amp;db:fast-diacritic-sensitive-searches?&amp;db:trailing-wildcard-searches?&amp;db:trailing-wildcard-word-positions?&amp;db:three-character-searches?&amp;db:three-character-word-positions?&amp;db:two-character-searches?&amp;db:one-character-searches?&amp;db:word-lexicons?&amp;db:included-elements?&amp;db:excluded-elements?&amp;db:field-value-searches?&amp;db:field-value-positions?) at /db:field using schema \"database.xsd\"</results>\r\n\r\n", "samplequery":"", "sampledata":"", "version":"6.0-1", "tofixin":"N/A", "fixedin":"N/A", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, {"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20547, "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "ksaxena"], "changeHistory":[{"time":"2013-01-22T00:28:01.6505-08:00", "updatedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2013-01-23T10:05:41.456697-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true, "comment":"I think admin:database-add-field() should be fixed to throw a well-formed exception."}, {"time":"2013-01-23T10:05:41.456697-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"assignTo":{"from":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-23T10:05:41.456697-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-01-23T10:49:07.719384-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"This was originally Wolfgang's code, so Gajanan is not really the owner of it."}, {"time":"2013-01-27T23:18:20.437176-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Assigning to Brian. This is the clone of 20547 and the triage committee seems to have assigned the original of this bug to him."}, {"time":"2013-01-27T23:18:20.437176-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"bmo", "name":"Brian Mo", "email":"brian.mo@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-28T22:21:14.247926-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-01T20:51:03.84779-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"status":{"from":"", "to":"Will not fix"}, "assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"See bug 20547 for more info. This should not be fixed in 6.0-3 or 5.0-5. This has been fixed in 7.0-ea1. "}, {"time":"2013-02-01T20:51:03.84779-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-01T20:51:03.84779-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"tofixin":{"from":"6.0-3", "to":"N/A"}}, "files":[], "show":true}], "updatedAt":"2013-02-01T20:51:03.84779-08:00", "renderDescriptionAs":"normal"}