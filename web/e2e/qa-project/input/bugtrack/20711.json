{"id":20711, "kind":"Bug", "createdAt":"2013-02-05T11:25:27.086109-08:00", "status":"Closed", "title":"Serialising a graph with blank nodes returns non-standard bnode URIs", "category":"", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"pfennell", "name":"Philip Fennell", "email":"philip.fennell@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"The included sample query parses an example N-Triples representation of a graph which contains blank node URIs and the serialises the resulting graph. The resulting serialisation uses the ML internal blank node format of:\r\n\r\n<http://marklogic.com/semantics/blank/17969185440384450719>\r\n\r\ninstead of the conventional representation that might look like this:\r\n\r\n_:bnode17969185440384450719\r\n\r\n\r\nHere is the full resulting N-Triples document:\r\n\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#author> <http://marklogic.com/semantics/blank/6896381051312294420> .\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#entry> <http://marklogic.com/semantics/blank/90499762212717202> .\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#id> \"urn:uuid:60a76c80-d399-11d9-b93C-0003939e0af6\"^^xs:anyURI .\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#link> <http://marklogic.com/semantics/blank/9056076748736691468> .\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#title> <http://marklogic.com/semantics/blank/801700730247921881> .\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#updated> \"2003-12-13T18:30:02Z\"^^xs:dateTime .\r\n<file:///atom/example-01.xml> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Feed> .\r\n<http://marklogic.com/semantics/blank/17969185440384450719> <http://bblfish.net/work/atom-owl/2006-06-06/#body> \"Some text.\"^^xs:string .\r\n<http://marklogic.com/semantics/blank/17969185440384450719> <http://bblfish.net/work/atom-owl/2006-06-06/#type> \"text/plain\"^^xs:string .\r\n<http://marklogic.com/semantics/blank/17969185440384450719> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Content> .\r\n<http://marklogic.com/semantics/blank/3182307052229035554> <http://bblfish.net/work/atom-owl/2006-06-06/#src> <http://example.org/2003/12/13/atom03> .\r\n<http://marklogic.com/semantics/blank/4279550384730609591> <http://bblfish.net/work/atom-owl/2006-06-06/#src> <http://example.org/> .\r\n<http://marklogic.com/semantics/blank/5581204200380881033> <http://bblfish.net/work/atom-owl/2006-06-06/#body> \"Atom-Powered Robots Run Amok\"^^xs:string .\r\n<http://marklogic.com/semantics/blank/5581204200380881033> <http://bblfish.net/work/atom-owl/2006-06-06/#type> \"text/plain\"^^xs:string .\r\n<http://marklogic.com/semantics/blank/5581204200380881033> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Content> .\r\n<http://marklogic.com/semantics/blank/6305952607170188591> <http://bblfish.net/work/atom-owl/2006-06-06/#rel> <http://www.iana.org/assignments/relation/alternate> .\r\n<http://marklogic.com/semantics/blank/6305952607170188591> <http://bblfish.net/work/atom-owl/2006-06-06/#to> <http://marklogic.com/semantics/blank/3182307052229035554> .\r\n<http://marklogic.com/semantics/blank/6305952607170188591> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Link> .\r\n<http://marklogic.com/semantics/blank/6896381051312294420> <http://bblfish.net/work/atom-owl/2006-06-06/#name> \"John Doe\"^^xs:string .\r\n<http://marklogic.com/semantics/blank/6896381051312294420> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Person> .\r\n<http://marklogic.com/semantics/blank/6896381051312294420> <http://www.w3.org/2002/07/owl#sameAs> <http://marklogic.com/semantics/blank/4024510322199665574> .\r\n<http://marklogic.com/semantics/blank/801700730247921881> <http://bblfish.net/work/atom-owl/2006-06-06/#body> \"Example Feed\"^^xs:string .\r\n<http://marklogic.com/semantics/blank/801700730247921881> <http://bblfish.net/work/atom-owl/2006-06-06/#type> \"text/plain\"^^xs:string .\r\n<http://marklogic.com/semantics/blank/801700730247921881> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Content> .\r\n<http://marklogic.com/semantics/blank/90499762212717202> <http://bblfish.net/work/atom-owl/2006-06-06/#author> <http://marklogic.com/semantics/blank/4024510322199665574> .\r\n<http://marklogic.com/semantics/blank/90499762212717202> <http://bblfish.net/work/atom-owl/2006-06-06/#id> \"urn:uuid:1225c695-cfb8-4ebb-aaaa-80da344efa6a\"^^xs:anyURI .\r\n<http://marklogic.com/semantics/blank/90499762212717202> <http://bblfish.net/work/atom-owl/2006-06-06/#link> <http://marklogic.com/semantics/blank/6305952607170188591> .\r\n<http://marklogic.com/semantics/blank/90499762212717202> <http://bblfish.net/work/atom-owl/2006-06-06/#summary> <http://marklogic.com/semantics/blank/17969185440384450719> .\r\n<http://marklogic.com/semantics/blank/90499762212717202> <http://bblfish.net/work/atom-owl/2006-06-06/#title> <http://marklogic.com/semantics/blank/5581204200380881033> .\r\n<http://marklogic.com/semantics/blank/90499762212717202> <http://bblfish.net/work/atom-owl/2006-06-06/#updated> \"2003-12-13T18:30:02Z\"^^xs:dateTime .\r\n<http://marklogic.com/semantics/blank/90499762212717202> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Entry> .\r\n<http://marklogic.com/semantics/blank/9056076748736691468> <http://bblfish.net/work/atom-owl/2006-06-06/#rel> <http://www.iana.org/assignments/relation/alternate> .\r\n<http://marklogic.com/semantics/blank/9056076748736691468> <http://bblfish.net/work/atom-owl/2006-06-06/#to> <http://marklogic.com/semantics/blank/4279550384730609591> .\r\n<http://marklogic.com/semantics/blank/9056076748736691468> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Link> .", "samplequery":"xquery version \"1.0-ml\";\r\n\r\nimport module namespace sem = \"http://marklogic.com/semantics\" at\r\n    \"MarkLogic/semantics/semantics.xqy\";\r\n\r\nimport module namespace semf = \"http://marklogic.com/semantics/formats\" at\r\n    \"MarkLogic/semantics/semformats.xqy\";\r\n\r\nlet $nTriples as xs:string := \r\n'<file:///atom/example-01.xml> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Feed>.\r\n_:bnode585208896 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Content>.\r\n_:bnode585208896 <http://bblfish.net/work/atom-owl/2006-06-06/#type> \"text/plain\".\r\n_:bnode585208896 <http://bblfish.net/work/atom-owl/2006-06-06/#body> \"Example Feed\".\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#title> _:bnode585208896.\r\n_:bnode1103928960 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Link>.\r\n_:bnode1103928960 <http://bblfish.net/work/atom-owl/2006-06-06/#rel> <http://www.iana.org/assignments/relation/alternate>.\r\n_:bnode1622649024 <http://bblfish.net/work/atom-owl/2006-06-06/#src> <http://example.org/>.\r\n_:bnode1103928960 <http://bblfish.net/work/atom-owl/2006-06-06/#to> _:bnode1622649024.\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#link> _:bnode1103928960.\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#updated> \"2003-12-13T18:30:02Z\"^^<http://www.w3.org/2001/XMLSchema#dateTime>.\r\n_:bnode1116158080 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Person>.\r\n_:bnode1116158080 <http://www.w3.org/2002/07/owl#sameAs> _:author1.\r\n_:bnode1116158080 <http://bblfish.net/work/atom-owl/2006-06-06/#name> \"John Doe\".\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#author> _:bnode1116158080.\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#id> \"urn:uuid:60a76c80-d399-11d9-b93C-0003939e0af6\"^^<http://www.w3.org/2001/XMLSchema#anyURI>.\r\n_:bnode78717952 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Entry>.\r\n_:bnode78717952 <http://bblfish.net/work/atom-owl/2006-06-06/#author> _:author1.\r\n_:bnode440002112 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Content>.\r\n_:bnode440002112 <http://bblfish.net/work/atom-owl/2006-06-06/#type> \"text/plain\".\r\n_:bnode440002112 <http://bblfish.net/work/atom-owl/2006-06-06/#body> \"Atom-Powered Robots Run Amok\".\r\n_:bnode78717952 <http://bblfish.net/work/atom-owl/2006-06-06/#title> _:bnode440002112.\r\n_:bnode958722176 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Link>.\r\n_:bnode958722176 <http://bblfish.net/work/atom-owl/2006-06-06/#rel> <http://www.iana.org/assignments/relation/alternate>.\r\n_:bnode1477442240 <http://bblfish.net/work/atom-owl/2006-06-06/#src> <http://example.org/2003/12/13/atom03>.\r\n_:bnode958722176 <http://bblfish.net/work/atom-owl/2006-06-06/#to> _:bnode1477442240.\r\n_:bnode78717952 <http://bblfish.net/work/atom-owl/2006-06-06/#link> _:bnode958722176.\r\n_:bnode78717952 <http://bblfish.net/work/atom-owl/2006-06-06/#id> \"urn:uuid:1225c695-cfb8-4ebb-aaaa-80da344efa6a\"^^<http://www.w3.org/2001/XMLSchema#anyURI>.\r\n_:bnode78717952 <http://bblfish.net/work/atom-owl/2006-06-06/#updated> \"2003-12-13T18:30:02Z\"^^<http://www.w3.org/2001/XMLSchema#dateTime>.\r\n_:bnode1261364864 <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://bblfish.net/work/atom-owl/2006-06-06/#Content>.\r\n_:bnode1261364864 <http://bblfish.net/work/atom-owl/2006-06-06/#type> \"text/plain\".\r\n_:bnode1261364864 <http://bblfish.net/work/atom-owl/2006-06-06/#body> \"Some text.\".\r\n_:bnode78717952 <http://bblfish.net/work/atom-owl/2006-06-06/#summary> _:bnode1261364864.\r\n<file:///atom/example-01.xml> <http://bblfish.net/work/atom-owl/2006-06-06/#entry> _:bnode78717952.'\r\nlet $graph as sem:triple* := xdmp:nquad($nTriples)\r\nreturn\r\n  semf:serialize-nquads($graph)", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"N/A", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"pfennell", "name":"Philip Fennell", "email":"philip.fennell@marklogic.com"}, {"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, {"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["", "pfennell"], "changeHistory":[{"time":"2013-02-05T11:25:27.086109-08:00", "updatedBy":{"username":"pfennell", "name":"Philip Fennell", "email":"philip.fennell@marklogic.com"}, "change":{"assignTo":{"from":{"username":"pfennell", "name":"Philip Fennell", "email":"philip.fennell@marklogic.com"}, "to":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-05T15:24:30.515029-08:00", "updatedBy":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jsnelson", "name":"John Snelson", "email":"jsnelson@marklogic.com"}, "to":{"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-05T15:29:31.509261-08:00", "updatedBy":{"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"7.0-ea1"}}, "files":[], "show":true}, {"time":"2013-02-10T14:44:09.325012-08:00", "updatedBy":{"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"This is still largely in-flux (in particular semformats.xqy is no more; now there's a public interface and a sem-impl.xqy with behind-the-scenes stuff) but this is fixed starting with the Feb 11 nightly."}, {"time":"2013-02-10T14:44:09.325012-08:00", "updatedBy":{"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}, "change":{"assignTo":{"from":{"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-02-10T14:44:09.325012-08:00", "closedAt":"2013-02-10T14:44:09.325012-08:00", "closedBy":{"username":"mdubinko", "name":"Micah  Dubinko", "email":"mdubinko@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}