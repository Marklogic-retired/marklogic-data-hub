{"id":20016, "kind":"Bug", "createdAt":"2012-11-07T08:25:09.822467-08:00", "status":"Closed", "title":"Implement nested predicate support in index paths", "category":"XQuery", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"In 6.0-1 we didn't allow index be defined on a path with nested predicates.\r\n\r\nJPMC reported some examples that had nested predicates. We should extend permissible syntax to nested predicates in index path expressions and use such indexes for optimizing suitable queries.", "samplequery":"", "sampledata":"", "version":"6.0-1", "tofixin":"7.0-ea1", "fixedin":"N/A", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[20020], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["XQuery", "gchinchwadkar"], "changeHistory":[{"time":"2012-11-07T08:25:09.822467-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-08T20:09:17.698615-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Nothing to be done. It is already working.\r\n\r\nThen I tried creating index on JPMC path and it worked:\r\n\r\n/gbom/trade[cashflow/partyRole[roleType='RECEIVER']/partyId[domain=':clientcentral.spn']]/tradeHeader[tradeDomain='85']/dcppTradeId\r\n\r\nEven the optimizer uses this index.\r\n\r\nxdmp:query-trace(true()),\r\n/gbom/trade[cashflow/partyRole[roleType='RECEIVER']/partyId[domain=':clientcentral.spn']]/tradeHeader[tradeDomain='85'][dcppTradeId='TEST']\r\n, xdmp:query-trace(false())\r\n=>\r\n2012-11-08 17:07:13.279 Info: cq: at 8:120: Comparison contributed string range value constraint: /gbom/trade[cashflow/partyRole[roleType='RECEIVER']/partyId[domain=':clientcentral.spn']]/tradeHeader[tradeDomain='85']/dcppTradeId = \"TEST\""}, {"time":"2012-11-08T20:09:17.698615-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2012-11-08T20:09:17.698615-08:00", "closedAt":"2012-11-08T20:09:17.698615-08:00", "closedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "renderDescriptionAs":"normal"}