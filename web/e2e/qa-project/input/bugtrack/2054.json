{"id":2054, "kind":"Bug", "createdAt":"2005-08-03T14:50:43.838423-07:00", "status":"Closed", "title":"Interaction between weights on near-query and word-query non-intuitive", "category":"search", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Load shakespeare files with SCENE, ACT, SPEECH, do following query:\n\nfor $a in \ncts:search(//SPEECH,cts:near-query((cts:element-query(xs:QName(\"SPEAKER\"),\"HORATIO\"),\n                                        cts:element-query(xs:QName(\"LINE\"),cts:and-query((\"the\",\"and\")))),15))\nreturn (cts:score($a),$a)\n\nresult  looks like following:\n\nShouldn't the third match items in this list have higher relevnace score because the LINE has \"the, and\" is closer to word \"HORATIO\" than item #2? \n\n\n<results warning=\"more than one node\">\n26\n-\n\t<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>The same, my lord, and your poor servant ever.</LINE>\n</SPEECH>\n24\n-\n\t<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>A mote it is to trouble the mind's eye.</LINE>\n<LINE>In the most high and palmy state of Rome,</LINE>\n<LINE>A little ere the mightiest Julius fell,</LINE>\n<LINE>The graves stood tenantless and the sheeted dead</LINE>\n<LINE>Did squeak and gibber in the Roman streets:</LINE>\n<LINE>As stars with trains of fire and dews of blood,</LINE>\n<LINE>Disasters in the sun; and the moist star</LINE>\n<LINE>Upon whose influence Neptune's empire stands</LINE>\n<LINE>Was sick almost to doomsday with eclipse:</LINE>\n<LINE>And even the like precurse of fierce events,</LINE>\n<LINE>As harbingers preceding still the fates</LINE>\n<LINE>And prologue to the omen coming on,</LINE>\n<LINE>Have heaven and earth together demonstrated</LINE>\n<LINE>Unto our climatures and countrymen.--</LINE>\n<LINE>But soft, behold! lo, where it comes again!</LINE>\n<STAGEDIR>Re-enter Ghost</STAGEDIR>\n<LINE>I'll cross it, though it blast me. Stay, illusion!</LINE>\n<LINE>If thou hast any sound, or use of voice,</LINE>\n<LINE>Speak to me:</LINE>\n<LINE>If there be any good thing to be done,</LINE>\n<LINE>That may to thee do ease and grace to me,</LINE>\n<LINE>Speak to me:</LINE>\n<STAGEDIR>Cock crows</STAGEDIR>\n<LINE>If thou art privy to thy country's fate,</LINE>\n<LINE>Which, happily, foreknowing may avoid, O, speak!</LINE>\n<LINE>Or if thou hast uphoarded in thy life</LINE>\n<LINE>Extorted treasure in the womb of earth,</LINE>\n-\n\t<LINE>\nFor which, they say, you spirits oft walk in death,\n</LINE>\n<LINE>Speak of it: stay, and speak! Stop it, Marcellus.</LINE>\n</SPEECH>\n23\n-\n\t<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>Before my God, I might not this believe</LINE>\n<LINE>Without the sensible and true avouch</LINE>\n<LINE>Of mine own eyes.</LINE>\n</SPEECH>\n23\n-\n\t<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>In what particular thought to work I know not;</LINE>\n<LINE>But in the gross and scope of my opinion,</LINE>\n<LINE>This bodes some strange eruption to our state.</LINE>\n</SPEECH>\n</results>", "samplequery":"", "sampledata":"", "version":"3.0-2", "tofixin":"3.0-4", "fixedin":"N/A", "platform":"linux", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}], "attachments":[], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["search", "rwang"], "changeHistory":[{"time":"2005-10-18T17:41:46.933027-07:00", "updatedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "to":{"username":"hui", "name":"Hui Li", "email":"hui.li@marklogic.com"}}}, "files":[], "show":true, "comment":"\n"}, {"time":"2005-10-24T18:18:51.977581-07:00", "updatedBy":{"username":"hui", "name":"Hui Li", "email":"hui.li@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"hui", "name":"Hui Li", "email":"hui.li@marklogic.com"}, "to":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}}}, "files":[], "show":true, "comment":"The score is somewhat different than before, because of the code changes since then.\n\nIt is questionable if it is intuitive that the default formula for combining term scores with proximity scores. But the user has control them by supplying weights on terms and on near-query."}, {"time":"2005-10-24T19:42:13.273098-07:00", "updatedBy":{"username":"hui", "name":"Hui Li", "email":"hui.li@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"The following are the scores with default weight.\n29\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>A mote it is to trouble the mind's eye.</LINE>\n<LINE>In the most high and palmy state of Rome,</LINE>\n<LINE>A little ere the mightiest Julius fell,</LINE>\n<LINE>The graves stood tenantless and the sheeted dead</LINE>\n<LINE>Did squeak and gibber in the Roman streets:</LINE>\n<LINE>As stars with trains of fire and dews of blood,</LINE>\n<LINE>Disasters in the sun; and the moist star</LINE>\n<LINE>Upon whose influence Neptune's empire stands</LINE>\n<LINE>Was sick almost to doomsday with eclipse:</LINE>\n<LINE>And even the like precurse of fierce events,</LINE>\n<LINE>As harbingers preceding still the fates</LINE>\n<LINE>And prologue to the omen coming on,</LINE>\n<LINE>Have heaven and earth together demonstrated</LINE>\n<LINE>Unto our climatures and countrymen.--</LINE>\n<LINE>But soft, behold! lo, where it comes again!</LINE>\n<STAGEDIR>Re-enter Ghost</STAGEDIR>\n<LINE>I'll cross it, though it blast me. Stay, illusion!</LINE>\n<LINE>If thou hast any sound, or use of voice,</LINE>\n<LINE>Speak to me:</LINE>\n<LINE>If there be any good thing to be done,</LINE>\n<LINE>That may to thee do ease and grace to me,</LINE>\n<LINE>Speak to me:</LINE>\n<STAGEDIR>Cock crows</STAGEDIR>\n<LINE>If thou art privy to thy country's fate,</LINE>\n<LINE>Which, happily, foreknowing may avoid, O, speak!</LINE>\n<LINE>Or if thou hast uphoarded in thy life</LINE>\n<LINE>Extorted treasure in the womb of earth,</LINE>\n<LINE>For which, they say, you spirits oft walk in death,</LINE>\n<LINE>Speak of it: stay, and speak! Stop it, Marcellus.</LINE>\n</SPEECH>\n26\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>The same, my lord, and your poor servant ever.</LINE>\n</SPEECH>\n23\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>Before my God, I might not this believe</LINE>\n<LINE>Without the sensible and true avouch</LINE>\n<LINE>Of mine own eyes.</LINE>\n</SPEECH>\n23\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>In what particular thought to work I know not;</LINE>\n<LINE>But in the gross and scope of my opinion,</LINE>\n<LINE>This bodes some strange eruption to our state.</LINE>\n</SPEECH>\n\n\nThe following are the scores when the weight on each word-query is set t o 0.0\n22\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>The same, my lord, and your poor servant ever.</LINE>\n</SPEECH>\n13\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>Before my God, I might not this believe</LINE>\n<LINE>Without the sensible and true avouch</LINE>\n<LINE>Of mine own eyes.</LINE>\n</SPEECH>\n13\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>In what particular thought to work I know not;</LINE>\n<LINE>But in the gross and scope of my opinion,</LINE>\n<LINE>This bodes some strange eruption to our state.</LINE>\n</SPEECH>\n13\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>A mote it is to trouble the mind's eye.</LINE>\n<LINE>In the most high and palmy state of Rome,</LINE>\n<LINE>A little ere the mightiest Julius fell,</LINE>\n<LINE>The graves stood tenantless and the sheeted dead</LINE>\n<LINE>Did squeak and gibber in the Roman streets:</LINE>\n<LINE>As stars with trains of fire and dews of blood,</LINE>\n<LINE>Disasters in the sun; and the moist star</LINE>\n<LINE>Upon whose influence Neptune's empire stands</LINE>\n<LINE>Was sick almost to doomsday with eclipse:</LINE>\n<LINE>And even the like precurse of fierce events,</LINE>\n<LINE>As harbingers preceding still the fates</LINE>\n<LINE>And prologue to the omen coming on,</LINE>\n<LINE>Have heaven and earth together demonstrated</LINE>\n<LINE>Unto our climatures and countrymen.--</LINE>\n<LINE>But soft, behold! lo, where it comes again!</LINE>\n<STAGEDIR>Re-enter Ghost</STAGEDIR>\n<LINE>I'll cross it, though it blast me. Stay, illusion!</LINE>\n<LINE>If thou hast any sound, or use of voice,</LINE>\n<LINE>Speak to me:</LINE>\n<LINE>If there be any good thing to be done,</LINE>\n<LINE>That may to thee do ease and grace to me,</LINE>\n<LINE>Speak to me:</LINE>\n<STAGEDIR>Cock crows</STAGEDIR>\n<LINE>If thou art privy to thy country's fate,</LINE>\n<LINE>Which, happily, foreknowing may avoid, O, speak!</LINE>\n<LINE>Or if thou hast uphoarded in thy life</LINE>\n<LINE>Extorted treasure in the womb of earth,</LINE>\n<LINE>For which, they say, you spirits oft walk in death,</LINE>\n<LINE>Speak of it: stay, and speak! Stop it, Marcellus.</LINE>\n</SPEECH>\n\nThe following are the score when the weight on near-query is set to 0.0\n25\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>A mote it is to trouble the mind's eye.</LINE>\n<LINE>In the most high and palmy state of Rome,</LINE>\n<LINE>A little ere the mightiest Julius fell,</LINE>\n<LINE>The graves stood tenantless and the sheeted dead</LINE>\n<LINE>Did squeak and gibber in the Roman streets:</LINE>\n<LINE>As stars with trains of fire and dews of blood,</LINE>\n<LINE>Disasters in the sun; and the moist star</LINE>\n<LINE>Upon whose influence Neptune's empire stands</LINE>\n<LINE>Was sick almost to doomsday with eclipse:</LINE>\n<LINE>And even the like precurse of fierce events,</LINE>\n<LINE>As harbingers preceding still the fates</LINE>\n<LINE>And prologue to the omen coming on,</LINE>\n<LINE>Have heaven and earth together demonstrated</LINE>\n<LINE>Unto our climatures and countrymen.--</LINE>\n<LINE>But soft, behold! lo, where it comes again!</LINE>\n<STAGEDIR>Re-enter Ghost</STAGEDIR>\n<LINE>I'll cross it, though it blast me. Stay, illusion!</LINE>\n<LINE>If thou hast any sound, or use of voice,</LINE>\n<LINE>Speak to me:</LINE>\n<LINE>If there be any good thing to be done,</LINE>\n<LINE>That may to thee do ease and grace to me,</LINE>\n<LINE>Speak to me:</LINE>\n<STAGEDIR>Cock crows</STAGEDIR>\n<LINE>If thou art privy to thy country's fate,</LINE>\n<LINE>Which, happily, foreknowing may avoid, O, speak!</LINE>\n<LINE>Or if thou hast uphoarded in thy life</LINE>\n<LINE>Extorted treasure in the womb of earth,</LINE>\n<LINE>For which, they say, you spirits oft walk in death,</LINE>\n<LINE>Speak of it: stay, and speak! Stop it, Marcellus.</LINE>\n</SPEECH>\n19\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>Before my God, I might not this believe</LINE>\n<LINE>Without the sensible and true avouch</LINE>\n<LINE>Of mine own eyes.</LINE>\n</SPEECH>\n19\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>In what particular thought to work I know not;</LINE>\n<LINE>But in the gross and scope of my opinion,</LINE>\n<LINE>This bodes some strange eruption to our state.</LINE>\n</SPEECH>\n19\n<SPEECH>\n<SPEAKER>HORATIO</SPEAKER>\n<LINE>The same, my lord, and your poor servant ever.</LINE>\n</SPEECH>\n"}, {"time":"2005-10-24T20:14:10.35508-07:00", "updatedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Discussed with Hui and agreed on the result. \nWhen weight is 0.0 in word query(cts:element-query(xs:QName(\"SPEAKER\"),cts:word-query(\"HORATIO\",0.0))  server only uses distance to calculate score for each result. \nwhen doing near-query(q1,q2,$distant,(),0.0), as long as all matching results has 2 words within that distant and they all have about the same amount of appeances of 2 words, their score will be the same(or very close). "}, {"time":"2005-11-01T17:22:00.155828-08:00", "updatedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"this was not a bug, only a misunderstanding"}], "updatedAt":"2005-11-01T17:22:00.155828-08:00", "fixedAt":"2005-10-24T18:18:51.977581-07:00", "fixedBy":{"username":"hui", "name":"Hui Li", "email":"hui.li@marklogic.com"}, "shippedAt":"2005-10-24T20:14:10.35508-07:00", "shippedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "closedAt":"2005-11-01T17:22:00.155828-08:00", "closedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "renderDescriptionAs":"normal"}