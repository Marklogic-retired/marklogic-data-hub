{"id":20092, "kind":"Bug", "createdAt":"2012-11-14T14:43:45.554271-08:00", "status":"Closed", "title":"cts:element-child-geospatial-boxes returning no results where results expected  with decending option", "category":"search", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Starting on the build from 6.0-20121114 the following was observed: \r\n\r\nxquery version \"1.0-ml\"; \r\n        declare boundary-space preserve;\r\n        let $answer := cts:element-child-geospatial-boxes(xs:QName(\"ele-child-point\"),\r\n                                                         xs:QName(\"pos\"),\r\n                                                         (-90, -75, -60,-45,-30, -15, 0),\r\n                                                         (0, 30, 60, 90, 120, 150, 180),\r\n                                                         (\"descending\", \"checked\"),(), xs:double(1))\r\n        for $i in $answer \r\n        return\r\n        (<box>{$i}</box>, \"\r\n        \")\r\n==> \r\n() \r\nexpected\r\n<box>[1.88034, 150.20399, 89.572701, 179.728]</box>\r\n        <box>[0, 120, 89.931999, 148.98001]</box>\r\n        <box>[0.40816301, 90.068001, 89.115601, 119.864]</box>\r\n        <box>[0.54545504, 60, 89.931999, 89.931999]</box>\r\n        <box>[0, 30.067999, 89.795906, 59.591801]</box>\r\n        <box>[0.272109, 0, 90, 29.7959]</box>\r\n        <box>[0, -180, 89.931999, -0.272109]</box>\r\n        <box>[-14.529901, 153.33301, -0.95238096, 178.912]</box>\r\n        <box>[-14.615399, 120, -0.085470103, 149.93199]</box>\r\n        <box>[-12.9252, 91.8367, -0.544218, 118.231]</box>\r\n        <box>[-13.333301, 60.272102, -2.0408199, 89.659897]</box>\r\n        <box>[-13.8776, 32.381001, -0.085470103, 57.415001]</box>\r\n        <box>[-14.7009, 1.63265, -0.25641, 25.306101]</box>\r\n        <box>[-14.871799, -180, -1.27273, -7.0748301]</box>\r\n        <box>[-29.5238, 150.748, -16.495699, 178.231]</box>\r\n        <box>[-29.659899, 120.272, -15.4545, 149.116]</box>\r\n        <box>[-29.4545, 91.564598, -15.818201, 119.728]</box>\r\n        <box>[-29.7959, 61.3605, -15.238101, 89.795906]</box>\r\n        <box>[-29.818201, 30.748299, -15.6463, 58.0952]</box>\r\n        <box>[-29.818201, 0.544218, -15.374199, 28.5714]</box>\r\n        <box>[-29.7959, -179.45599, -15.102001, -2.3129301]</box>\r\n        <box>[-41.632702, 151.429, -30.612202, 179.18401]</box>\r\n        <box>[-44.5299, 120.952, -30.067999, 148.299]</box>\r\n        <box>[-44.489799, 91.156494, -31.020401, 118.91199]</box>\r\n        <box>[-43.537403, 60.136101, -31.636402, 89.795906]</box>\r\n        <box>[-44.353703, 33.333302, -30.2041, 59.183697]</box>\r\n        <box>[-43.537403, 0, -30.2041, 28.979601]</box>\r\n        <box>[-44.217697, -174.15001, -30.2041, -1.76871]</box>\r\n        <box>[-59.727901, 153.46899, -45.454498, 178.776]</box>\r\n        <box>[-59.818203, 120.81601, -46.938801, 148.299]</box>\r\n        <box>[-59.454502, 91.8367, -45.726501, 119.45601]</box>\r\n        <box>[-59.914501, 60.544197, -45.170101, 89.523804]</box>\r\n        <box>[-59.727901, 34.421799, -45.454498, 57.959202]</box>\r\n        <box>[-58.775497, 0.272109, -46.727303, 29.7959]</box>\r\n        <box>[-59.145298, -179.32001, -45.213699, -6.1224499]</box>\r\n        <box>[-74.181793, 153.33301, -61.0909, 175.64601]</box>\r\n        <box>[-74.786301, 122.721, -60.136101, 146.12199]</box>\r\n        <box>[-73.4188, 90.204102, -60.6838, 119.864]</box>\r\n        <box>[-73.333305, 60.272102, -60.408199, 87.346901]</box>\r\n        <box>[-74.421806, 33.061199, -61.880299, 58.639503]</box>\r\n        <box>[-74.965996, 2.5850301, -60.727303, 26.6667]</box>\r\n        <box>[-74.693893, -166.12201, -60.3419, -3.67347]</box>\r\n        <box>[-89.658096, 154.422, -75.272697, 178.095]</box>\r\n        <box>[-89.914505, 122.721, -75.982895, 149.66]</box>\r\n        <box>[-89.090897, 90.204102, -75.454498, 116.59901]</box>\r\n        <box>[-88.571404, 61.632698, -75.090904, 89.931999]</box>\r\n        <box>[-88.571404, 31.8367, -75.101997, 59.727901]</box>\r\n        <box>[-90, 0, -75.090904, 29.3878]</box>\r\n        <box>[-89.914505, -175.64601, -75.646301, -7.6190505]</box>\r\n\r\nThe test that reproduces this behavior is geo-bucket2.xml and geo-bucket-reindex.xml \r\n\r\n", "samplequery":"", "sampledata":"", "version":"6.0-nightly", "tofixin":"6.0-2", "fixedin":"6.0-2", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[20093], "cloneOf":"", "support":{"headline":"", "supportDescription":"Nightly in 6.0", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["search", "lratcliff"], "changeHistory":[{"time":"2012-11-14T14:43:45.554271-08:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2012-11-14T15:38:47.973882-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"120462", "paths":["xdmp/branches/b6_0/src/OnDiskRangeIndexes.cpp"], "affectedBugs":[]}, "comment":"Bug:20092 when descending range index scan runs from 0, done() must check cursor==limit because limit = -1 (unsigned)"}, {"time":"2012-11-14T15:43:58.123735-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"120463", "paths":["xdmp/trunk/src/OnDiskRangeIndexes.cpp"], "affectedBugs":[]}, "comment":"Bug:20092 done() fix"}, {"time":"2012-11-14T15:44:47.370691-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true, "comment":"This should also fix the other descending values/value-match issues.\r\nLet me know how that goes."}, {"time":"2012-11-14T15:44:47.370691-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-15T15:02:13.52812-08:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build from Nov. 15, 2012. "}, {"time":"2012-11-21T15:20:30.538654-08:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2012-11-21T15:20:30.538654-08:00", "fixedAt":"2012-11-14T15:44:47.370691-08:00", "fixedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "shippedAt":"2012-11-15T15:02:13.52812-08:00", "shippedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "closedAt":"2012-11-21T15:20:30.538654-08:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal"}