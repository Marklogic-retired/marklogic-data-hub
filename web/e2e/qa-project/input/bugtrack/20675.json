{"id":20675, "kind":"Bug", "createdAt":"2013-01-18T14:40:00.600911-08:00", "status":"Closed", "title":"xdmp:pretty-print removing declare in 'declare default function namespace'", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"This comes from Ryan Dew on the doc comments.  I tried this on 6.0-2.1, although I expect it applies to more branches.\r\n\r\nThe \"declare\" is removed from a declare default function namespace prolog definition when using xdmp:pretty-print.  For example, the following returns invalid xquery (missing the \"default\" psuedo-keyword):\r\n\r\nxdmp:pretty-print('xquery version \"1.0-ml\";\r\n\r\ndeclare default function namespace \"/foo\";\r\n\r\n\"hello\"')\r\n=>\r\nxquery version \"1.0-ml\";\r\ndefault function namespace \"/foo\";\r\n\r\n\"hello\"", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, {"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, {"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20521, "support":{"headline":"xdmp:pretty-print removing declare in 'declare default function namespace'", "supportDescription":"xdmp:pretty-print of 'declare default function namespace' comes out as just 'default function namespace'.\r\n\r\nFor example:\r\nxdmp:pretty-print('xquery version \"1.0-ml\";  \r\ndeclare default function namespace \"/foo\"; \r\n \"hello\"') \r\n\r\nComes out as:\r\nxquery version \"1.0-ml\"; \r\ndefault function namespace \"/foo\"; \r\n\"hello\"", "publishStatus":"Prepare", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "dsokolsky"], "changeHistory":[{"time":"2013-01-18T14:40:00.600911-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2013-01-31T15:23:04.875935-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"130192", "paths":["xdmp/trunk/src/XQuery.cpp"], "affectedBugs":[]}, "comment":"Bug:20675 pretty-print"}, {"time":"2013-01-31T15:25:31.815425-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed 7.0-20130201"}, {"time":"2013-01-31T15:25:31.815425-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-31T15:25:31.815425-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"tofixin":{"from":"", "to":"7.0-ea1"}}, "files":[], "show":true}, {"time":"2013-02-01T07:47:50.397234-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"130277", "paths":["xdmp/trunk/src/XQuery.cpp"], "affectedBugs":[]}, "comment":"Bug:20675 don't add declare on module namespace decl"}, {"time":"2013-03-02T10:54:09.452187-08:00", "updatedBy":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "to":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-05T16:36:46.260419-08:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"135088", "paths":["qa/trunk/scripts/keys/bug20675.xml", "qa/trunk/scripts/tests/bug20675.xml", "qa/trunk/scripts/list/bugs51.txt"], "affectedBugs":[]}, "comment":"bug:20675 add test for the bug"}, {"time":"2013-03-05T16:43:16.315791-08:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-05T16:43:16.315791-08:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-03-05T16:43:16.315791-08:00", "fixedAt":"2013-01-31T15:25:31.815425-08:00", "fixedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "shippedAt":"2013-03-05T16:43:16.315791-08:00", "shippedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "renderDescriptionAs":"normal"}