{"id":20245, "kind":"Bug", "createdAt":"2012-10-16T14:29:13.219912-07:00", "status":"Closed", "title":"iSys on linux does not extract Word doc custom properties", "category":"conversion", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"pmcgowan", "name":"Preston McGowan", "email":"Preston.McGowan@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"On Windows the iSys filters correctly extract the custom document metadata and return the metadata as meta items. On Linux, the system does not return the custom metadata items.\r\n\r\nI can provide a test document if needed.\r\n\r\n\r\nMissing element : <meta name=\"Some_Property\" content=\"Kool Aid\"/>\r\n\r\nLinux output:\r\n  <head>\r\n    <meta name=\"content-type\" content=\"application/msword\"/>\r\n    <meta name=\"filter-capabilities\" content=\"text subfiles HD-HTML\"/>\r\n    <meta name=\"Character_Count\" content=\"8\"/>\r\n    <meta name=\"Creation_Date\" content=\"Tue Oct 16 13:16:00 2012\"/>\r\n    <meta name=\"Last_Saved_Date\" content=\"Tue Oct 16 13:16:00 2012\"/>\r\n    <meta name=\"Line_Count\" content=\"1\"/>\r\n    <meta name=\"Page_Count\" content=\"1\"/>\r\n    <meta name=\"Paragraph_Count\" content=\"1\"/>\r\n    <meta name=\"Total_Editing_Time\" content=\"00:00\"/>\r\n    <meta name=\"Word_Count\" content=\"2\"/>\r\n    <meta name=\"isys_SubType\" content=\"Word 97/2003\"/>\r\n    <meta name=\"size\" content=\"22016\"/>\r\n  </head>\r\n\r\nWindows Output:\r\n  <head>\r\n    <meta name=\"content-type\" content=\"application/msword\"/>\r\n    <meta name=\"filter-capabilities\" content=\"text subfiles HD-HTML\"/>\r\n    <meta name=\"AppName\" content=\"Microsoft Macintosh Word\"/>\r\n    <meta name=\"Author\" content=\"Preston McGowan\"/>\r\n    <meta name=\"Character_Count\" content=\"8\"/>\r\n    <meta name=\"Company\" content=\"MarkLogic\"/>\r\n    <meta name=\"Creation_Date\" content=\"10/16/2012 4:16:00 PM\"/>\r\n    <meta name=\"Last_Author\" content=\"Preston McGowan\"/>\r\n    <meta name=\"Last_Saved_Date\" content=\"10/16/2012 4:16:00 PM\"/>\r\n    <meta name=\"Line_Count\" content=\"1\"/>\r\n    <meta name=\"Page_Count\" content=\"1\"/>\r\n    <meta name=\"Paragraph_Count\" content=\"1\"/>\r\n    <meta name=\"Revision_Number\" content=\"2\"/>\r\n    <meta name=\"Some_Property\" content=\"Kool Aid\"/>\r\n    <meta name=\"Template\" content=\"Normal.dotm\"/>\r\n    <meta name=\"Total_Editing_Time\" content=\"00:00\"/>\r\n    <meta name=\"Word_Count\" content=\"2\"/>\r\n    <meta name=\"isys\" content=\"SubType: Word 97/2003\"/>\r\n    <meta name=\"size\" content=\"22016\"/>\r\n  </head>\r\n\r\n", "samplequery":"", "sampledata":"", "version":"6.0-nightly", "tofixin":"6.0-3", "fixedin":"6.0-3", "platform":"linux(64-bit)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"pmcgowan", "name":"Preston McGowan", "email":"Preston.McGowan@marklogic.com"}, {"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, {"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}], "attachments":[{"name":"Word file with custom property \"some_property\"", "uri":"root/support/bugtracking/attachments/19788/NGschedule.docx"}], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":19788, "support":{"headline":"xdmp:document-filter() can fail to extract a custom property from a .docx source when running on Linux.", "supportDescription":"xdmp:document-filter() can fail to extract a \"custom\" (user-added) metadata property from a .docx source when running on Linux.", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["conversion", "pmcgowan"], "changeHistory":[{"time":"2012-10-17T09:52:02.131883-07:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-10-17T09:52:02.131883-07:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-10-17T09:52:02.131883-07:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"5.0-5"}}, "files":[], "show":true}, {"time":"2012-10-26T10:13:52.757365-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Verified the behavior with a file I modified per report instructions.  Sample query:\r\n\r\nxquery version \"1.0-ml\";\r\n\r\nlet $qadir := <testdata>\r\nlet $path := fn:concat($qadir,\"NGschedule.docx\")\r\nlet $metadata :=\r\n  xdmp:document-filter(\r\n    xdmp:document-get($path))//*:meta\r\nlet $metatext := xdmp:quote($metadata)\r\nlet $custom_prop := fn:substring-after($metatext, \"some_property\")\r\nlet $length := fn:string-length($custom_prop)\r\n\r\nreturn if ($length > 0)\r\n       then \"some_property found\"\r\n       else \"some_property not found (wrong)\"\r\n"}, {"time":"2012-10-26T10:13:52.757365-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-10-31T10:08:02.919923-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"status":{"from":"", "to":"External"}, "assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true, "comment":"Reported to Isys 10-31-2012:\r\n\r\nHi, Levi--\r\n\r\nHope everything is well with you.\r\n\r\nHere's a bug report we received.  The attached file has a \"custom\" metadata property \"some_property\"; on Windows, it gets extracted (for instance, using ConvertDocumentToHTML), but on Linux it doesn't.\r\n\r\n    Thanks,\r\n        --Scott\r\n"}, {"time":"2012-12-10T13:39:04.761194-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Scott,\r\nHas Isys fixed this bug yet?  In what release?"}, {"time":"2012-12-10T13:41:54.631351-08:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"On November 19, 2012, Levi Reep <levi.reep@perceptivesoftware.com> said:\r\n\r\nHello Scott,\r\n\r\nWith the latest internal build, the metadata field \"some_property\" is coming through on both Windows and Linux.  This will be rolled into the next maintenance release (10.3) scheduled for Q2 2013.\r\n\r\nRegards,\r\n\r\nLevi\r\n"}, {"time":"2012-12-10T14:56:09.382171-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"push to 5.0-6 due to the above comment."}, {"time":"2012-12-10T14:56:09.382171-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"5.0-5", "to":"5.0-6"}}, "files":[], "show":true}, {"time":"2012-12-10T14:57:39.201814-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-02-27T15:37:11.364067-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"6.0-3", "to":"6.0-4"}}, "files":[], "show":true}, {"time":"2013-03-12T16:03:03.448946-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136372", "paths":["xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSshared.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSreadershd.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSshared.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSreaders.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSpdf6.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYS10df.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSreaders.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSpdf6.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSshared.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSreaders.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSreadershd.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSreadershd.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSautocad.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSautocad.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYS10df.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSpdf6.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSautocad.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSshared.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSreaders.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSshared.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSreadershd.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSreaders.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSpdf6.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYS10df.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYS10df.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSpdf6.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSautocad.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSautocad.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYS10df.so", "xdmp/branches/b6_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSreadershd.so"], "affectedBugs":["19789"]}, "comment":"bug:19789 bug:20245 upgrade to Isys 10.2 Build 945 (Linux)"}, {"time":"2013-03-12T16:04:09.337229-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136373", "paths":["xdmp/branches/b6_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYS10df.lib", "xdmp/branches/b6_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSreaders.dll", "xdmp/branches/b6_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSpdf6.dll", "xdmp/branches/b6_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSreadershd.dll", "xdmp/branches/b6_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSautocad.dll", "xdmp/branches/b6_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYS.documentfilters.dll", "xdmp/branches/b6_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYS10df.dll"], "affectedBugs":["19789"]}, "comment":"bug:19789 bug:20245 upgrade to Isys 10.2 Build 945 (Windows)"}, {"time":"2013-03-12T16:05:16.299539-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136374", "paths":["xdmp/branches/b6_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSpdf6.dylib", "xdmp/branches/b6_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSreadershd.dylib", "xdmp/branches/b6_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSreaders.dylib", "xdmp/branches/b6_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSshared.dylib", "xdmp/branches/b6_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSautocad.dylib", "xdmp/branches/b6_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYS10df.dylib"], "affectedBugs":["19789"]}, "comment":"bug:19789 bug:20245 upgrade to Isys 10.2 Build 945 (MacOSX)"}, {"time":"2013-03-12T16:06:15.259215-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136375", "paths":["xdmp/branches/b6_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSautocad.so", "xdmp/branches/b6_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSshared.so", "xdmp/branches/b6_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYS10df.so", "xdmp/branches/b6_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSreaders.so", "xdmp/branches/b6_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSpdf6.so", "xdmp/branches/b6_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSreadershd.so"], "affectedBugs":["19789"]}, "comment":"bug:19789 bug:20245 upgrade to Isys 10.2 Build 945 (Solaris)"}, {"time":"2013-03-12T16:18:27.62188-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed with upgrade to Isys 10.2 build 945.\r\n"}, {"time":"2013-03-12T16:18:27.62188-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-04-12T13:26:20.539883-07:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-04-12T13:26:20.539883-07:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-04-22T16:25:51.196175-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-04-22T16:25:51.196175-07:00", "fixedAt":"2013-03-12T16:18:27.62188-07:00", "fixedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "shippedAt":"2013-04-12T13:26:20.539883-07:00", "shippedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "closedAt":"2013-04-22T16:25:51.196175-07:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal"}