{"id":200, "kind":"Bug", "createdAt":"2003-11-05T14:04:01-08:00", "status":"Closed", "title":"Some versions of a query that incorporate a variable set with a Let generate a \"Tree Cache Full\" error", "category":"", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"adam", "name":"Adam Block", "email":"adam@cerisent.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"In the Medline environment, the following query (when saved in a new file such as \"test.xqy\") works fine: count(doc(\"medline/medline03n0331.xml\"//ArticleTitle) However, rendering the same logic as: let $doc := doc(\"medline/medline03n0331.xml\") return count($doc//ArticleTitle) Results in a 500 Server Error with the message: tree cache full -- increase cache-tree-size in /test.xqy", "samplequery":"This fails: let $doc := doc(\"medline/medline03n0331.xml\") return count($doc//ArticleTitle) but this works: let $doc := \"medline/medline03n0331.xml\" return count(doc($doc)//ArticleTitle) as does this: let $doc := doc(\"medline/medline03n0331.xml\")//ArticleTitle return count($doc) and this: let $doc := count(doc(\"medline/medline03n0331.xml\")//ArticleTitle) return $doc", "sampledata":"", "version":"main branch", "tofixin":"", "fixedin":"", "platform":"windows", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"adam", "name":"Adam Block", "email":"adam@cerisent.com"}], "attachments":[], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["", "adam"], "changeHistory":[{"time":"2003-11-05T18:13:38-08:00", "updatedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "change":{}, "files":[], "show":false}, {"time":"2003-11-05T18:13:38-08:00", "updatedBy":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"rwang", "name":"Rachel Link", "email":"rwang@cerisent.com"}, "to":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}}}, "files":[], "show":true, "comment":"Assign to Chris."}, {"time":"2003-11-05T22:38:34-08:00", "updatedBy":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"this is actually not a bug, perhaps just a limitation of the optimizer, but he query needs to enumerate all the ArticleTitles and runs out of memory. This is the right behavior when there isn't enough memory."}, {"time":"2003-11-05T22:38:59-08:00", "updatedBy":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "change":{}, "files":[], "show":false}, {"time":"2003-11-05T22:38:59-08:00", "updatedBy":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "to":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}}}, "files":[], "show":true, "comment":"not a bug"}, {"time":"2003-11-12T00:08:40-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{}, "files":[], "show":false}, {"time":"2003-11-12T00:08:40-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "to":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}}}, "files":[], "show":true, "comment":"Not a bug"}], "updatedAt":"2003-11-12T00:08:40-08:00", "shippedAt":"2003-11-05T22:38:59-08:00", "shippedBy":{"username":"avnur", "name":"Ron Avnur", "email":"avnur@cerisent.com"}, "closedAt":"2003-11-12T00:08:40-08:00", "closedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}