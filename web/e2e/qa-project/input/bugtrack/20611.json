{"id":20611, "kind":"Bug", "createdAt":"2013-01-04T06:36:33.800182-08:00", "status":"Closed", "title":"ACCESS_VIOLATION when trying to enable positions on  range index on hidden indexes xdmp:document, xdmp:collection", "category":"xdmp", "severity":"Catastrophic", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"gvidal", "name":"Gary Vidal", "email":"gary.vidal@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"I was trying to enable positions for hidden range indexes xdmp:collection and xdmp:document.  Then indexer throws following error.  Once I disable positions for range indexes error no longer occurs.\r\n\r\nThread: ACCESS_VIOLATION\r\n#  1 0x0000000141089af5 in xdmp::__putRangeIndex() (indexer.cpp:1473)\r\n#  2 0x000000014109d12c in xdmp::StandardIndexerEnv::_putRangeIndex() (indexer.cpp:1635)\r\n#  3 0x000000014109d2d5 in xdmp::StandardIndexerEnv::putRangeIndex() (indexer.cpp:1668)\r\n#  4 0x00000001410b0397 in xdmp::StandardIndexerPostingData::putNode() (indexer.cpp:8465)\r\n#  5 0x000000014170b758 in xdmp::UpdatePath::fragmentInsert() (updatepath.cpp:318)\r\n#  6 0x0000000140ee86aa in xdmp::ForestReindexerThread::reindexFragments() (forest.cpp:710)\r\n#  7 0x0000000140f08977 in xdmp::ForestReindexerThread::reindexRangeIndexes() (forest.cpp:1005)\r\n#  8 0x0000000140f0a33c in xdmp::ForestReindexerThread::run() (forest.cpp:1584)\r\n#  9 0x00000001418fc30f in svc::Thread::top() (thread.cpp:277)\r\n# 10 0x00000001418fc549 in runThread() (thread.cpp:309)\r\n# 11 0x0000000141bc2b95 in _callthreadstart() (thread.c:295)\r\n# 12 0x0000000141bc2b67 in _threadstart() (thread.c:277)\r\n2013-01-04 08:27:23.159 Critical: Thread: ACCESS_VIOLATION", "samplequery":"Create Range Index\r\n\r\nNamespace: http://marklogic.com/xdmp\r\nLocalNames: document, collection\r\nPositions: true\r\nCollation: http://marklogic.com/collation/codepoint\r\n\r\nReindexer should blow up\r\n\r\nSet positions=false from range index settings\r\nReindexer should be fine.", "sampledata":"", "version":"5.0-1", "tofixin":"5.0-6", "fixedin":"5.0-6", "platform":"windows(64-bit)", "memory":"8GB", "processors":"2", "note":"", "subscribers":[{"username":"gvidal", "name":"Gary Vidal", "email":"gary.vidal@marklogic.com"}, {"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, {"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20380, "support":{"headline":"", "supportDescription":"didn't publish it in 6.0-3, not doing so in 5.0-6", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "gvidal"], "changeHistory":[{"time":"2013-01-08T17:12:05.682354-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true, "comment":"Since this crashes the server, moving the Severity to catastrophic."}, {"time":"2013-01-08T17:12:05.682354-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-08T17:12:05.682354-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-01-28T11:27:38.776282-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I have found the problem and testing the fix."}, {"time":"2013-01-28T12:42:23.163262-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"5.0-6"}}, "files":[], "show":true}, {"time":"2013-01-28T12:53:34.254782-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Test:\r\n \r\nDefine the indexes as described above and insert any document. For example:\r\n \r\nxdmp:document-insert(\"/abc.xml\",\r\n<a>\r\n  <b><c>C1</c></b>\r\n  <b><c>C2</c></b>\r\n</a>)\r\n \r\nWithout this fix we will get ACCESS VIOLATION on windows."}, {"time":"2013-01-28T13:05:31.871425-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Waiting for code to be checked in b5_0/xdmp/src. Codeline is locked for 5.0.5."}, {"time":"2013-03-04T13:35:02.773102-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"134834", "paths":["xdmp/branches/b5_0/src/Indexer.cpp"], "affectedBugs":[]}, "comment":"Fix for bug:20611.\n"}, {"time":"2013-03-04T13:38:16.155705-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-04T13:38:16.155705-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-12T05:24:05.045419-07:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}}}, "files":[], "show":true}, {"time":"2014-03-27T11:51:36.965032-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2014-03-27T15:35:19.988245-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 5.0-20140324 and 5.0-20140326 on both windows and linux. No ACCESS_VIOLATION."}], "updatedAt":"2014-03-27T15:35:19.988245-07:00", "fixedAt":"2013-03-04T13:38:16.155705-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "shippedAt":"2014-03-27T15:35:19.988245-07:00", "shippedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}