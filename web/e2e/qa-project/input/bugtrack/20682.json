{"id":20682, "kind":"Bug", "createdAt":"2013-02-01T03:29:58.362672-08:00", "status":"Closed", "title":"XSLT Processing Issue with Templates Priority", "category":"", "severity":"", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"bgupta", "name":"Balkrishna Gupta", "email":"balkrishna.gupta@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"We have a case #12449 where customer has XSLT having templates defined with conflict match. As per W3C XSLT specification, if templates have conflict match then priority of the template during processing decided based on how specific the template match is defined. MarkLogic does not seems to be working based on this standard and picks up the template appearing in the last of XSLT document. It is working fine with SAXON processor. Here, I am attaching the xslt , sample xml document along with output from saxon and marklogic.\r\n\r\n", "samplequery":"Below is the xslt definition and sample xml document:\r\n\r\nXSLT:\r\n------------\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<xsl:stylesheet\r\n  xpath-default-namespace=\"http://www.rsc.org/schema/rscart38\"\r\n  extension-element-prefixes=\"\"\r\n  exclude-result-prefixes=\"article fx xs fn\"\r\n  xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\r\n  xmlns=\"http://www.rsc.org/schema/rscart38\"\r\n  xmlns:article=\"http://www.rsc.org/schema/rscart38\"\r\n  xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\r\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n  xmlns:fn=\"http://www.w3.org/2005/xpath-functions\"\r\n  xmlns:fx=\"http://www.rsc.org/schema/XSL/functions\"\r\n  version=\"2.0\" >\r\n  \r\n  <xsl:template match=\"metainfo\">\r\n    <xsl:element name=\"metainfo\">\r\n      <xsl:apply-templates select=\"theme\"/>\r\n    </xsl:element>\r\n  </xsl:template>\r\n  \r\n  <xsl:template match=\"metainfo/theme\">\r\n    <xsl:copy>\r\n      <xsl:apply-templates select=\"@*|node()\"/>\r\n    </xsl:copy>\r\n  </xsl:template>\r\n  \r\n  <xsl:template match=\"metainfo/meta\">\r\n    <xsl:copy-of select=\".\" />\r\n  </xsl:template>\r\n  \r\n  <xsl:template match=\"metainfo/*\">\r\n    <xsl:element name=\"meta\">\r\n      <xsl:attribute name=\"field\">\r\n        <xsl:value-of select=\"fn:local-name(.)\" />\r\n      </xsl:attribute>\r\n      <xsl:value-of select=\"fn:normalize-space(fn:string(.))\"/>\r\n    </xsl:element>\r\n  </xsl:template>\r\n  \r\n  <xsl:template match=\"@*|node()\">\r\n    <xsl:copy>\r\n      <xsl:apply-templates select=\"@*|node()\"/>\r\n    </xsl:copy>\r\n  </xsl:template>\r\n  </xsl:stylesheet>\r\n\r\nXML Document:\r\n-------------------------\r\n<metainfo xmlns=\"http://www.rsc.org/schema/rscart38\">\r\n        <theme uri=\"/themeinfo/91B434F3-F189-47E4-9EAD-88184F820DE6.XML\" score=\"0\">\r\n            <themeinfo-theme-id>91b434f3-f189-47e4-9ead-88184f820de6</themeinfo-theme-id>\r\n            <themeinfo-theme-title>Aromaticity</themeinfo-theme-title>\r\n            <themeinfo-validfrom>2011-12-02</themeinfo-validfrom>\r\n            <themeinfo-validto>3012-01-01</themeinfo-validto>\r\n            <themeinfo-themetype>web</themeinfo-themetype>\r\n        </theme>\r\n    </metainfo>", "sampledata":"", "version":"5.0-4.1", "tofixin":"N/A", "fixedin":"N/A", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"bgupta", "name":"Balkrishna Gupta", "email":"balkrishna.gupta@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"Low", "title":"Minimal business impact or reasonable workaround is available"}, "workaround":""}, "tags":["", "bgupta"], "changeHistory":[{"time":"2013-02-04T23:02:04.573706-08:00", "updatedBy":{"username":"bgupta", "name":"Balkrishna Gupta", "email":"balkrishna.gupta@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"bgupta", "name":"Balkrishna Gupta", "email":"balkrishna.gupta@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Duplicate of 20681. Raised by mistake hence closing this one.\r\n\r\nBalkrishna"}], "updatedAt":"2013-02-04T23:02:04.573706-08:00", "closedAt":"2013-02-04T23:02:04.573706-08:00", "closedBy":{"username":"bgupta", "name":"Balkrishna Gupta", "email":"balkrishna.gupta@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}