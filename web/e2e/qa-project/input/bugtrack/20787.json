{"id":20787, "kind":"Bug", "createdAt":"2013-02-14T00:25:29.886845-08:00", "status":"Closed", "title":"cts:field-value-query on path-fields with attributes does not return correct results", "category":"", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"MarkLogic Version 7.0-20130213\r\n\r\n1.\tCreate a path-field called ‘frag’ with path ‘chapter/title/@lang’.\r\n2.\tEnable field-values on this field. \r\n3.\tCreate a field-range index on ‘frag’.\r\n4.\tThe document to insert is /doc1.xml which looks like:\r\n<chapter>\r\n  <title lang=\"foo\">foo-title</title>\r\n</chapter>\r\n\r\n5. Run cts:search(doc(), cts:field-value-query(“frag”, “foo”)), \r\n\r\nexpected: the contents of tehe document.\r\nobserved result: empty sequence", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["", "msrinivasan"], "changeHistory":[{"time":"2013-02-14T00:25:29.886845-08:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-14T04:27:07.999079-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"131759", "paths":["xdmp/trunk/src/Indexer.cpp"], "affectedBugs":[]}, "comment":"Fix for bug:20787 unfiltered queries.\n"}, {"time":"2013-02-14T04:28:03.228669-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"xdmp:document-insert(\"/doc1.xml\",\r\n<a>\r\n  <b c=\"foo\">foo-title</b>\r\n</a>)\r\n;\r\ncts:search(doc(), cts:field-value-query(\"frag\", \"foo\"),\"unfiltered\")\r\n=>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<a><b c=\"foo\">foo-title</b></a>"}, {"time":"2013-02-19T11:43:55.478478-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"132446", "paths":["xdmp/trunk/src/PathConfig.h", "xdmp/trunk/src/SearchBuiltins.cpp"], "affectedBugs":[]}, "comment":"fix for bug:20787.\n"}, {"time":"2013-02-19T11:52:23.882217-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true, "comment":"I added two paths to the field: ‘chapter/title/@lang’ and ‘chapter/title’.\r\n\r\nxdmp:document-insert(\"/doc1.xml\",\r\n<chapter>\r\n  <title lang=\"foo\">foo-title</title>\r\n</chapter>)\r\n;\r\ncts:search(doc(), cts:field-value-query(\"frag\", \"foo\"),\"unfiltered\"),\r\ncts:search(doc(), cts:field-value-query(\"frag\", \"foo-title\"),\"unfiltered\"),\r\ncts:contains(doc(), cts:field-value-query(\"frag\", \"foo-title\")),\r\ncts:contains(doc(), cts:field-value-query(\"frag\", \"foo\"))\r\n;\r\ncts:field-values(\"frag\")\r\n;\r\n=>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<chapter><title lang=\"foo\">foo-title</title></chapter>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<chapter><title lang=\"foo\">foo-title</title></chapter>\r\ntrue\r\nfalse\r\nfoo\r\nfoo-title"}, {"time":"2013-02-19T11:52:23.882217-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-19T15:15:06.702761-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"132485", "paths":["xdmp/trunk/src/SearchBuiltins.cpp"], "affectedBugs":[]}, "comment":"bug:20787.\n"}, {"time":"2013-03-12T15:31:48.732542-07:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-ea1_20130305"}], "updatedAt":"2013-03-12T15:31:48.732542-07:00", "fixedAt":"2013-02-19T11:52:23.882217-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "shippedAt":"2013-03-12T15:31:48.732542-07:00", "shippedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "renderDescriptionAs":"normal"}