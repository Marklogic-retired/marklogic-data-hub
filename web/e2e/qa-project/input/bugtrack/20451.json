{"id":20451, "kind":"Bug", "createdAt":"2013-01-14T00:42:17.75668-08:00", "status":"Closed", "title":"Creating Group is giving error 500 in Admin UI", "category":"adminGUI", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Creating Group is giving error 500 in Admin UI \r\n\r\nBuild - \r\n\r\nSteps to reproduce - \r\n\r\n1. Click on Groups from left navigaton\r\n2. Click on 'create' tab on configure page\r\n\r\nPlease note that below error occur\r\n\r\nYou've encountered an error in the server. Please copy the text below, and email support (support@marklogic.com):\r\n\r\n500: Internal Server Error\r\nXDMP-NOSUCHDB: xdmp:database(\"Meters\") -- No such database Meters\r\nIn /lib/add-group-form.xqy on line 70\r\nIn displayForm(<xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>, xs:NCName(\"meters-database\"), (), \"/gr:groups/gr:group\", 4)\r\n\r\n    $schemaroot = <xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>\r\n    $name = xs:NCName(\"meters-database\")\r\n    $val = ()\r\n    $parentindex = \"/gr:groups/gr:group\"\r\n    $depth = 4\r\n    $decl = <xs:element name=\"meters-database\" type=\"database-id\" abstract=\"false\" nillable=\"false\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><xs:annotation><xs:documentation>&#10; The meters database....</xs:element>\r\n    $typ = xs:NCName(\"database-id\")\r\n    $simple = <xs:simpleType name=\"database-id\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><xs:annotation><xs:documentation>&#10; A database name.&#...</xs:simpleType>\r\n    $complex = ()\r\n    $gr = \"http://marklogic.com/xdmp/group\"\r\n    $index = \"/gr:groups/gr:group/gr:meters-database\"\r\n    $value = 0\r\n\r\nIn /lib/add-group-form.xqy on line 131\r\nIn displayForm(<xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>, \"group\", (), \"/gr:groups\", 2)\r\n\r\n    $schemaroot = <xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>\r\n    $name = \"group\"\r\n    $val = ()\r\n    $parentindex = \"/gr:groups\"\r\n    $depth = 2\r\n    $decl = <xs:element name=\"group\" type=\"group\" abstract=\"false\" nillable=\"false\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><xs:annotation><xs:documentation>&#10; The server specifi...</xs:element>\r\n    $typ = xs:NCName(\"group\")\r\n    $simple = ()\r\n    $complex = <xs:complexType name=\"group\" abstract=\"false\" mixed=\"false\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><xs:annotation><xs:documentation>&#10; The server specifi...</xs:complexType>\r\n    $gr = \"http://marklogic.com/xdmp/group\"\r\n    $index = \"/gr:groups/gr:group\"\r\n    $value = ()\r\n    $scale = 16\r\n    $spacing = 1\r\n    $rf = attribute{fn:expanded-QName(\"\", \"ref\")}{\"meters-database\"}\r\n    $name2 = fn:expanded-QName(\"http://marklogic.com/xdmp/group\", \"meters-database\")\r\n    $value2 = ()\r\n\r\nIn /lib/add-group-form.xqy on line 217\r\nIn addGroupPage(<xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>, <groups xsi:schemaLocation=\"http://marklogic.com/xdmp/group group.xsd\" timestamp=\"13581523706750000\" xmlns=\"http://marklogic.com/xdmp/group\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><group><group-name>Default</group-name><group-id>738043912106476...</groups>, ())\r\n\r\n    $schemaroot = <xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>\r\n    $datanode = <groups xsi:schemaLocation=\"http://marklogic.com/xdmp/group group.xsd\" timestamp=\"13581523706750000\" xmlns=\"http://marklogic.com/xdmp/group\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><group><group-name>Default</group-name><group-id>738043912106476...</groups>\r\n    $msgs = ()\r\n\r\nIn /add-group.xqy on line 16\r\n\t\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, {"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, {"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, {"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["adminGUI", "knagar"], "changeHistory":[{"time":"2013-01-14T00:42:17.75668-08:00", "updatedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "to":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-14T06:46:02.990132-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-14T07:28:55.888978-08:00", "updatedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Was this reproduced with a fresh install and empty Data directory ?\r\nI cannot reproduce this with a fresh data directory.\r\nThis is a known problem for upgrade scenerios which will be addressed once the schemas have settled down."}, {"time":"2013-01-14T08:58:48.525969-08:00", "updatedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"127719", "paths":["xdmp/trunk/src/Admin/lib/add-group-form.xqy"], "affectedBugs":[]}, "comment":"bug:20451 Remove hard-coded \"Meters\" DB name when creating new group and instead use the DB configured on the current host reguardless of its name."}, {"time":"2013-01-14T09:00:22.751238-08:00", "updatedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true, "comment":"There was a bug in the Admin GUI which if you had renamed the Meters DB to something else then creating a new group would fail. \r\nThis is fixed. \r\nThere is another related issue which is that upgrades do not create the Meters DB. This is NOT fixed in this defect and should be tracked separately.\r\n"}, {"time":"2013-01-14T09:00:22.751238-08:00", "updatedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-14T09:59:43.768118-08:00", "updatedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "change":{"tofixin":{"from":"7.0-1", "to":"7.0-ea1"}}, "files":[], "show":true}, {"time":"2013-01-15T11:47:05.627617-08:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{"assignTo":{"from":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "to":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-22T03:23:57.955857-08:00", "updatedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi David, \r\n\r\nNow getting error 500 on next step i.e for clicking 'ok' with default entires\r\n\r\nSteps to reproduce - \r\n\r\nSteps to reproduce -\r\n \r\n1. Click on Groups from left navigaton\r\n2. Click on 'create' tab on configure page\r\n3. Enter nothing and click on Ok\r\n\r\nNote below error occurs, please let me know if I need to raise separate bug got this.\r\n\r\nThanks\r\nKuldeep\r\nYou've encountered an error in the server. Please copy the text below, and email support (support@marklogic.com):\r\n500: Internal Server Error\r\nXDMP-LEXVAL: gr:group-name(\"\") -- Invalid lexical value \"\"\r\nIn /MarkLogic/admin.xqy on line 11684\r\nIn admin:group-create(<configuration/>, \"\")\r\nIn /add-group-go.xqy on line 26\r\nIn buildGroup()\r\n$config = <configuration/>\r\n$groupname = \"\"\r\nIn /add-group-go.xqy on line 84\r\nIn rebuildGroupConfig(<xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>, <groups xsi:schemaLocation=\"http://marklogic.com/xdmp/group group.xsd\" timestamp=\"13588533451210000\" xmlns=\"http://marklogic.com/xdmp/group\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><group><group-name>Default</group-name><group-id>165873084919749...</groups>)\r\n$schemaroot = <xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>\r\n$datanode = <groups xsi:schemaLocation=\"http://marklogic.com/xdmp/group group.xsd\" timestamp=\"13588533451210000\" xmlns=\"http://marklogic.com/xdmp/group\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><group><group-name>Default</group-name><group-id>165873084919749...</groups>\r\nIn /add-group-go.xqy on line 113\r\n$confirm = \"23\"\r\n$cancel = \"\"\r\n$schemaroot = <xs:schema targetNamespace=\"http://marklogic.com/xdmp/group\" xsi:schemaLocation=\"http://www.w3.org/2001/XMLSchema XMLSchema.xsd http://marklogic....\" attributeFormDefault=\"unqualified\" elementFormDefault=\"unqualified\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:admin=\"http://marklogic.com/xdmp/admin\" xmlns=\"http://marklogic.com/xdmp/group\"><?xdmp-annotations?><xs:annotation><xs:documentation>&#10; ...</xs:schema>\r\n$datanode = <groups xsi:schemaLocation=\"http://marklogic.com/xdmp/group group.xsd\" timestamp=\"13588533451210000\" xmlns=\"http://marklogic.com/xdmp/group\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><group><group-name>Default</group-name><group-id>165873084919749...</groups>"}, {"time":"2013-01-22T03:23:57.955857-08:00", "updatedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "to":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-24T12:09:08.482256-08:00", "updatedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Please close this bug and reopen as a seperate bug if needed.\r\nThis is not a regression. Please test on 6.0 release\r\nIf you do not specify a group name then you get an error (correct, it IS an error),\r\nthe enhancement would be to provide a NICE error message.\r\n Not sure who the dev lead for the admin GUI is ...\r\n"}, {"time":"2013-01-24T12:09:08.482256-08:00", "updatedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-25T02:08:11.427947-08:00", "updatedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Alright, logged 20586 for above issue and as original issue is covered in Bug13197.java so closing this one.\r\n\r\nThanks\r\nKuldeep"}, {"time":"2013-01-25T02:08:11.427947-08:00", "updatedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "to":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-01-25T02:08:11.427947-08:00", "fixedAt":"2013-01-14T09:00:22.751238-08:00", "fixedBy":{"username":"dlee", "name":"David  Lee", "email":"David.Lee@marklogic.com"}, "shippedAt":"2013-01-25T02:08:11.427947-08:00", "shippedBy":{"username":"knagar", "name":"Kuldeep Nagar", "email":"Kuldeep.Nagar@marklogic.com"}, "renderDescriptionAs":"normal"}