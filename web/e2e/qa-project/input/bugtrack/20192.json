{"id":20192, "kind":"Bug", "createdAt":"2012-12-04T17:34:11.368336-08:00", "status":"Closed", "title":"Complex indexer does not track trailing wildcard", "category":"search", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Currently complex indexer does not track trailing wildcard keys, shown as follows:\r\n\r\ncts:hash-terms( \r\n  <foo>abcd</foo>,\r\n   <options xmlns=\"cts:train\"\r\n       xmlns:db=\"http://marklogic.com/xdmp/database\">\r\n       <details>true</details>\r\n       <db:trailing-wildcard-searches>true</db:trailing-wildcard-searches>\r\n       <db:three-character-searches>true</db:three-character-searches>\r\n    </options>)//cts:word-query/cts:text \r\n\r\ngives only:\r\n\r\n<results warning=\"more than one root item\">\r\n  <cts:text xml:lang=\"en\" xmlns:cts=\"http://marklogic.com/cts\">*bcd</cts:text>\r\n  <cts:text xml:lang=\"en\" xmlns:cts=\"http://marklogic.com/cts\">*bcd*</cts:text>\r\n  <cts:text xml:lang=\"en\" xmlns:cts=\"http://marklogic.com/cts\">*abc*</cts:text>\r\n  <cts:text xml:lang=\"en\" xmlns:cts=\"http://marklogic.com/cts\">abcd</cts:text>\r\n</results>", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, {"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, {"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["search", "fxue"], "changeHistory":[{"time":"2012-12-04T17:34:11.368336-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T18:21:36.337786-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"122883", "paths":["xdmp/trunk/src/Indexer.cpp"], "affectedBugs":[]}, "comment":"Bug:20192 track trailing wildcard with complex indexer"}, {"time":"2012-12-05T18:33:52.908442-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"fixed on trunk, track trailing wildcard for all 4 combinations of case/diacritic sensitivity, a test case to consider\r\n\r\nfor $x in (\r\ncts:hash-terms(\r\n<foo>LiebeIst fürAlleDa</foo>,\r\n<options xmlns=\"cts:train\"\r\n      xmlns:db=\"http://marklogic.com/xdmp/database\">\r\n      <use-db-config>false</use-db-config>\r\n      <db:fast-case-sensitive-searches>true</db:fast-case-sensitive-searches>\r\n      <db:fast-diacritic-sensitive-searches>true</db:fast-diacritic-sensitive-searches>   \r\n     <db:trailing-wildcard-searches>true</db:trailing-wildcard-searches>\r\n      <details>true</details>\r\n    </options> )/cts:term[./*/cts:option = \"wildcarded\"]//cts:text\r\n)\r\norder by $x \r\nreturn $x"}, {"time":"2012-12-05T18:36:06.629379-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"The above query should return 38 wildcard texts."}, {"time":"2012-12-05T18:38:40.00126-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed on nightly 20121206.\r\n"}, {"time":"2012-12-05T18:38:40.00126-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T18:55:04.405803-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"note: cts:hash-terms() is internal debugging function, refer to distinctive-terms documentation for similar functionality."}, {"time":"2012-12-05T18:55:04.405803-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T18:55:04.405803-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T19:19:17.056521-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T19:19:17.056521-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-03T10:31:40.025057-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"xquery version \"1.0-ml\";\r\ndeclare namespace html = \"http://www.w3.org/1999/xhtml\";\r\nfor $x in (\r\ncts:hash-terms(\r\n<foo>LiebeIst fürAlleDa</foo>,\r\n<options xmlns=\"cts:train\"\r\n      xmlns:db=\"http://marklogic.com/xdmp/database\">\r\n      <use-db-config>false</use-db-config>\r\n      <db:fast-case-sensitive-searches>true</db:fast-case-sensitive-searches>\r\n      <db:fast-diacritic-sensitive-searches>true</db:fast-diacritic-sensitive-searches>   \r\n     <db:trailing-wildcard-searches>true</db:trailing-wildcard-searches>\r\n      <details>true</details>\r\n    </options> )/cts:term[./*/cts:option = \"wildcarded\"]//cts:text\r\n)\r\norder by $x \r\nreturn (($x)/text(),\" \")\r\n\r\n\r\nreturns\r\n\r\n\r\nf*\r\n \r\nf*\r\n \r\nfu*\r\n \r\nfu*\r\n \r\nfü*\r\n \r\nfü*\r\n \r\nfur*\r\n \r\nfur*\r\n \r\nfür*\r\n \r\nfür*\r\n \r\nfura*\r\n \r\nfurA*\r\n \r\nfüra*\r\n \r\nfürA*\r\n \r\nfural*\r\n \r\nfurAl*\r\n \r\nfüral*\r\n \r\nfürAl*\r\n \r\nfurall*\r\n \r\nfurAll*\r\n \r\nfürall*\r\n \r\nfürAll*\r\n \r\nfuralle*\r\n \r\nfurAlle*\r\n \r\nfüralle*\r\n \r\nfürAlle*\r\n \r\nl*\r\n \r\nL*\r\n \r\nli*\r\n \r\nLi*\r\n \r\nlie*\r\n \r\nLie*\r\n \r\nlieb*\r\n \r\nLieb*\r\n \r\nliebe*\r\n \r\nLiebe*\r\n \r\nliebei*\r\n \r\nLiebeI*\r\n "}, {"time":"2013-03-02T11:07:53.464049-08:00", "updatedBy":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "to":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-05T16:42:12.92482-08:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"135090", "paths":["qa/trunk/scripts/keys/bug20192.xml", "qa/trunk/scripts/tests/bug20192.xml", "qa/trunk/scripts/list/bugs51.txt"], "affectedBugs":[]}, "comment":"bug:20192 add test for the bug"}, {"time":"2013-03-05T16:42:29.772407-08:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-05T16:42:29.772407-08:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-03-05T16:42:29.772407-08:00", "fixedAt":"2012-12-05T19:19:17.056521-08:00", "fixedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "shippedAt":"2013-03-05T16:42:29.772407-08:00", "shippedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "renderDescriptionAs":"normal"}