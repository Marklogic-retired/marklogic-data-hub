{"id":20521, "kind":"Bug", "createdAt":"2013-01-18T14:40:00.600911-08:00", "status":"Closed", "title":"xdmp:pretty-print removing declare in 'declare default function namespace'", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"This comes from Ryan Dew on the doc comments.  I tried this on 6.0-2.1, although I expect it applies to more branches.\r\n\r\nThe \"declare\" is removed from a declare default function namespace prolog definition when using xdmp:pretty-print.  For example, the following returns invalid xquery (missing the \"default\" psuedo-keyword):\r\n\r\nxdmp:pretty-print('xquery version \"1.0-ml\";\r\n\r\ndeclare default function namespace \"/foo\";\r\n\r\n\"hello\"')\r\n=>\r\nxquery version \"1.0-ml\";\r\ndefault function namespace \"/foo\";\r\n\r\n\"hello\"", "samplequery":"", "sampledata":"", "version":"6.0-1", "tofixin":"6.0-3", "fixedin":"6.0-3", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, {"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[20675, 20676], "cloneOf":"", "support":{"headline":"xdmp:pretty-print removing declare in 'declare default function namespace'", "supportDescription":"xdmp:pretty-print of 'declare default function namespace' comes out as just 'default function namespace'.\r\n\r\nFor example:\r\nxdmp:pretty-print('xquery version \"1.0-ml\";  \r\ndeclare default function namespace \"/foo\"; \r\n \"hello\"') \r\n\r\nComes out as:\r\nxquery version \"1.0-ml\"; \r\ndefault function namespace \"/foo\"; \r\n\"hello\"", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "dsokolsky"], "changeHistory":[{"time":"2013-01-18T14:40:00.600911-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"assignTo":{"from":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2013-01-31T15:21:56.665927-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"130191", "paths":["xdmp/branches/b6_0/src/XQuery.cpp"], "affectedBugs":[]}, "comment":"Bug:20521 pretty-print"}, {"time":"2013-01-31T15:25:00.957835-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed 6.0-20130201"}, {"time":"2013-01-31T15:25:00.957835-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-01T07:30:48.890818-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"130276", "paths":["xdmp/branches/b6_0/src/XQuery.cpp"], "affectedBugs":[]}, "comment":"Bug:20521 avoid excess 'declare' in module namespace declaration"}, {"time":"2013-03-02T10:53:41.67503-08:00", "updatedBy":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "to":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-29T14:19:12.049313-07:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"138138", "paths":["qa/branches/b6_0/scripts/list/bugs50.txt", "qa/branches/b6_0/scripts/keys/bug20521.xml", "qa/branches/b6_0/scripts/tests/bug20521.xml"], "affectedBugs":[]}, "comment":"bug:20521"}, {"time":"2013-03-29T14:19:46.034741-07:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-29T14:19:46.034741-07:00", "updatedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-04-22T16:35:02.243002-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-04-22T16:35:02.243002-07:00", "fixedAt":"2013-01-31T15:25:00.957835-08:00", "fixedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "shippedAt":"2013-03-29T14:19:46.034741-07:00", "shippedBy":{"username":"lling", "name":"Ling Ling", "email":"ling.ling@marklogic.com"}, "closedAt":"2013-04-22T16:35:02.243002-07:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal"}