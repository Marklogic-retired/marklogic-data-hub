{"id":20206, "kind":"Bug", "createdAt":"2012-11-21T05:40:18.057135-08:00", "status":"Closed", "title":"Query Console unusable on french keyboard -  not working with special (alt) characters on a French keyboard", "category":"Query Console", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ableasdale", "name":"Alex Bleasdale", "email":"alex.bleasdale@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"This issue was brought to our attention by OECD in a recent support case:\r\nhttps://help.marklogic.com/staff/Tickets/Ticket/View/12154\r\n\r\nHere are the steps to reproduce (initially tested with Windows at this stage):\r\n\r\n- Open Control Panel > Region and Language \r\n\r\n- Install the French (France) Keyboard layout\r\n\r\n- Select \"FR\" in the Language bar to ensure you have the mapping selected\r\n\r\n- Open a text editor and use alt + 5 (which will give you '[') - note that for HP standard laptops, you'll need to use the alt key to the right of the space bar as the one on the left does not have the same mapping (on some keyboards this may be called Alt Gr).\r\n\r\n- Open firefox and in the address bar test the combination and confirm they work\r\n\r\n- Go to http://codemirror.net/mode/xquery/index.html and try the same combination and confirm they work (so it's not a codemirror or XQuery highlighting issue with the version currently available for download).\r\n\r\n- Try the same thing in a query buffer in qconsole. No response and no character is written into the buffer.", "samplequery":"", "sampledata":"", "version":"6.0-1", "tofixin":"6.0-4", "fixedin":"6.0-4", "platform":"windows(64-bit)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ableasdale", "name":"Alex Bleasdale", "email":"alex.bleasdale@marklogic.com"}, {"username":"jmakeig", "name":"Justin Makeig", "email":"jmakeig@marklogic.com"}, {"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, {"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20129, "support":{"headline":"Query Console not working with special (alt) characters on a French keyboard", "supportDescription":"The query buffer does not work with any of the keyboard ALT characters on a French (AZERTY) keyboard.  ", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"Medium", "title":"Requires significant or unnatural effort to work around issue or to prevent significant business impact"}, "workaround":"Use an external text editor (such as notepad++) and copy/paste"}, "tags":["Query Console", "ableasdale"], "changeHistory":[{"time":"2012-11-21T14:30:46.987351-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-21T14:30:46.987351-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"5.0-5"}}, "files":[], "show":true}, {"time":"2012-11-21T14:32:16.140909-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T12:16:56.267526-08:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2012-12-05T15:31:55.815905-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"It's most likely been fixed in the latest version.  An update should fix this issue."}, {"time":"2012-12-10T13:36:55.032093-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Assigning to Sudhakar for testing"}, {"time":"2012-12-10T13:36:55.032093-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-14T14:16:40.886559-08:00", "updatedBy":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"its behavior is little weird. alt+5 enters '[' as expected in a notepad/browser address bar but it does not do so in qconsole. \r\nHowever it requires a 3rd key to be able to type '[', like this  alt+<any other key>+5 does enter '[' , for example alt+4+5, alt+y+5.\r\nAfter entering alt+<some key>+5 couple of times, doing alt+5 enters '[' successfully\r\n\r\nIf this is confusing, come by my desk for a demo."}, {"time":"2013-01-14T14:16:40.886559-08:00", "updatedBy":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-14T16:53:06.293521-08:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I've determined that our homegrown keybinding library is the issue.  It handles key press events and tells CodeMirror whether or not to type out that character.  If the key combination is defined, the associated function triggers and nothing is rendered in QConsole.\r\n\r\nApparently, when clicking CTRL+5 in FR, our keybinding library is thinking that CTRL+ALT+5 was pressed.\r\n\r\ndigging in to see if I can figure out if there's a reason both CTRL+ALT are triggered.  Hoping it's not some language specific issue, as this could open up a whole HUGE can of worms if it is."}, {"time":"2013-02-15T13:59:56.643477-08:00", "updatedBy":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "change":{"status":{"from":"", "to":"Will not fix"}, "assignTo":{"from":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"PM decision: keyboard shortcuts not important for this case. Still would like support info so that it's a \"known bug\"."}, {"time":"2013-02-15T13:59:56.643477-08:00", "updatedBy":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "change":{"tofixin":{"from":"6.0-3", "to":"N/A"}}, "files":[], "show":true}, {"time":"2013-03-05T00:53:34.587961-08:00", "updatedBy":{"username":"ableasdale", "name":"Alex Bleasdale", "email":"alex.bleasdale@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I gather that PM have taken a look at this - and that a final decision has been made - so please do forgive me for speaking out of turn here... \r\n\r\n... but it seems to me that qconsole is useless to any users with a FR keyboard (and most likely, probably other European languages).  If the binding for \"[\" and \"]\" does not work, then qconsole is not going to be very useful for anyone using predicates.   I can share the workaround that was suggested in this case, but I find it a bit alarming that this \"sometimes works as expected\":\r\n\r\n> After entering alt+<some key>+5 couple of times, doing alt+5 enters '[' successfully\r\n\r\nBefore I report to OECD that this is not (ever?) going to be fixed, are we really sure we want to resolve this as \"Will not fix\"?\r\n\r\nI would understand if this was waiting for codemirror to resolve the problem - but given that this was found in a keybinding library for qconsole and given that we know codemirror works as expected - I would have hoped that this could be fixed.   Presumably the workaround would then be to tell them to use cq / DQ instead?\r\n\r\nKind regards,\r\nAlex."}, {"time":"2013-04-17T23:13:02.46534-07:00", "updatedBy":{"username":"dchander", "name":"Dinesh Chander", "email":"dinesh.chander@globallogic.com"}, "change":{}, "files":[], "show":true, "comment":"Same issue raised again via support case #12761\r\n\r\nI can't see any update on Alex's last comment hence was wondering if we should straight away reject this as a bug and share the workaround?\r\n\r\nThanks,\r\nDinesh Chander"}, {"time":"2013-04-22T10:25:44.364941-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"this is not a shortcut issue.  reopening"}, {"time":"2013-04-22T10:25:44.364941-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-04-22T10:27:44.187608-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"tofixin":{"from":"N/A", "to":"6.0-4"}}, "files":[], "show":true}, {"time":"2013-04-24T17:15:59.288959-07:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"We should probably also look to see if this does work on 7, as I think we are using different libraries on 7.  If it does work on 7, maybe that could help us decide not to fix it in 6?"}, {"time":"2013-04-26T13:15:15.034464-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-06-24T15:07:53.950432-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Adding investigation info to cloned bugs.....\r\n\r\nBelieve it or not, the right ALT key on the FR keyboard triggers two keydown events at once. One that's ALT one that's CTRL. Because of this, our QConsole keybinding triggers for CTRL+ALT+5, which I'm sure you've noticed actually switches to the 5th tab in QConsole. Since we catch this event, it blocks the '[' character from being written in the editor.\r\n \r\nI've isolated the keydown issue in a couple Fiddles, one with jQuery event handling (which we use), one with vanilla JavaScript, just to be sure it wasn't a jQuery bug. Both show the same behavior of the right ALT button triggering TWO keydown events ONLY in when on a French keyboard.\r\nJS: http://jsfiddle.net/cSc7r/14/\r\njQuery: http://jsfiddle.net/cSc7r/15/\r\n \r\nSo this is clearly an external issue, most likely Windows related. \r\n \r\nSince this is such a hot button issue for customers and users internally, my suggestion would be for Mitch and I to do what we've talked about doing for a while and remap the key bindings to settings more intuitive than these ugly 3-4 character long shortcuts. "}, {"time":"2013-06-28T11:31:55.333013-07:00", "updatedBy":{"username":"msarma", "name":"Meghalim Sarma", "email":"msarma@marklogic.com"}, "change":{"tofixin":{"from":"6.0-4", "to":"6.0-5"}}, "files":[], "show":true}, {"time":"2013-07-03T08:08:40.647678-07:00", "updatedBy":{"username":"ableasdale", "name":"Alex Bleasdale", "email":"alex.bleasdale@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi,\r\n\r\nI noticed that this one has slipped now to be fixed in 6.0-5.  I'd like to ask whether you would be willing to reconsider this for 6.0-4:\r\n\r\n- This issue was reported in November 2012\r\n- It was dropped from 6.0-3\r\n- It was subsequently reintroduced for 6.0-4\r\n- It has a significant impact for the customer (qconsole is unusable for them)\r\n- It is not an issue with the codemirror library itself (as I confirmed when the case was originally filed).\r\n\r\nIs there anything we can do to help make this usable for the customer?   I'm keen to see this addressed in 6.0-4 because the customer has asked us several times for an ETA on this - It'd be really depressing to see another release go out which didn't contain a fix for this.\r\n\r\nAs always, please let me know if you need anything from me regarding this.\r\n\r\nThanks.\r\nBest,\r\nA"}, {"time":"2013-07-03T08:08:40.647678-07:00", "updatedBy":{"username":"ableasdale", "name":"Alex Bleasdale", "email":"alex.bleasdale@marklogic.com"}, "change":{"tofixin":{"from":"6.0-5", "to":"6.0-4"}}, "files":[], "show":true}, {"time":"2013-07-03T12:51:20.346893-07:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Justin has sent an email to Discuss to see how we should fix this - what key bindings to use. I am not sure if we will get that info in time for 6.0-4. Subscribing Justin to see how we should proceed with this .. if we should punt to 7.0 and then backport to 6.0 based on code changes"}, {"time":"2013-07-03T12:52:16.51957-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"He approved this yesterday.  We'll be removing the 1-9 key bindings."}, {"time":"2013-07-03T16:26:39.419528-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"145751", "paths":["xdmp/branches/b6_0/src/Apps/qconsole/static/js/qconsole-keybindings.js"], "affectedBugs":[]}, "comment":"Bug:20206 - Fixed collision between key bindings and issues with Windows FR keyboard by removing some non-essential keybindings"}, {"time":"2013-07-03T16:27:04.829469-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}}}, "files":[], "show":true, "comment":"Sending to test."}, {"time":"2013-07-03T16:27:04.829469-07:00", "updatedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "to":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-18T17:32:52.648968-07:00", "updatedBy":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Bug verified"}, {"time":"2013-07-18T17:32:52.648968-07:00", "updatedBy":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-08-12T18:10:30.48217-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-08-12T18:10:30.48217-07:00", "fixedAt":"2013-07-03T16:27:04.829469-07:00", "fixedBy":{"username":"sbrooks", "name":"Scott Brooks", "email":"Scott.Brooks@marklogic.com"}, "shippedAt":"2013-07-18T17:32:52.648968-07:00", "shippedBy":{"username":"sreddy", "name":"Sudhakar Reddy", "email":"sreddy@marklogic.com"}, "closedAt":"2013-08-12T18:10:30.48217-07:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal"}