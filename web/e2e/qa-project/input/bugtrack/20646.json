{"id":20646, "kind":"Bug", "createdAt":"2013-01-30T14:24:39.837311-08:00", "status":"Closed", "title":"view:set-fields reporting it can't locate the view", "category":"SQL", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"gfurbush", "name":"Gordon Furbush ", "email":"gfurbush@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"I have a view named \"employees\":\r\n\r\nview:get(\"main\", \"employees\")\r\n\r\n=>\r\n\r\n<view:view xmlns:view=\"http://marklogic.com/xdmp/view\">\r\n  <view:view-id>2941411348680534079</view:view-id>\r\n  <view:view-name>employees</view:view-name>\r\n  <view:element-scope>\r\n    <view:namespace-uri/>\r\n    <view:localname>Employee</view:localname>\r\n  </view:element-scope>\r\n  <view:columns>\r\n    <view:column>\r\n      <view:column-name>employeeid</view:column-name>\r\n      <cts:element-reference xmlns:cts=\"http://marklogic.com/cts\">\r\n  <cts:namespace-uri/>\r\n  <cts:localname>EmployeeID</cts:localname>\r\n  <cts:scalar-type>int</cts:scalar-type>\r\n      </cts:element-reference>\r\n    </view:column>\r\n    <view:column>\r\n      <view:column-name>firstname</view:column-name>\r\n      <cts:element-reference xmlns:cts=\"http://marklogic.com/cts\">\r\n  <cts:namespace-uri/>\r\n  <cts:localname>FirstName</cts:localname>\r\n  <cts:scalar-type>string</cts:scalar-type>\r\n  <cts:collation>http://marklogic.com/collation/</cts:collation>\r\n      </cts:element-reference>\r\n    </view:column>\r\n    <view:column>\r\n      <view:column-name>lastname</view:column-name>\r\n      <cts:element-reference xmlns:cts=\"http://marklogic.com/cts\">\r\n  <cts:namespace-uri/>\r\n  <cts:localname>LastName</cts:localname>\r\n  <cts:scalar-type>string</cts:scalar-type>\r\n  <cts:collation>http://marklogic.com/collation/</cts:collation>\r\n      </cts:element-reference>\r\n    </view:column>\r\n  </view:columns>\r\n  <view:fields>\r\n    <view:field>\r\n      <view:field-name>Employee</view:field-name>\r\n    </view:field>\r\n  </view:fields>\r\n</view:view>\r\n\r\nI can add a field to the view:\r\n\r\nview:add-field(\"main\", \"employees\", view:field(\"Employee\") )\r\n\r\nBut I cannot set fields on a view:\r\n\r\nview:set-fields(\"main\", \"employees\", (view:field(\"Employee\"), view:field(\"EmployeeID\")) )\r\n\r\n=>\r\n\r\n1.0-ml] VIEW-NOTFOUND: (err:FOER0000) View not found: view 'main'.'employees' not found\r\nStack Trace\r\n\r\nIn /MarkLogic/views.xqy on line 1108\r\nIn view:get-internal(\"main\", \"employees\")\r\n$schema-name := \"main\"\r\n$view-name := \"employees\"\r\n$schema-name := \"main\"\r\n$view-name := \"employees\"\r\n$schema := ()\r\n$view := ()\r\nIn /MarkLogic/views.xqy on line 819\r\nIn view:set-fields(\"main\", \"employees\", (<view:field xmlns:view=\"http://marklogic.com/xdmp/view\"><view:field-name>Employee</view:field-name></view:field>, <view:field xmlns:view=\"http://marklogic.com/xdmp/view\"><view:field-name>EmployeeID</view:field-name></view:field>))\r\n$schema-name := \"main\"\r\n$view-name := \"employees\"\r\n$fields := (<view:field xmlns:view=\"http://marklogic.com/xdmp/view\"><view:field-name>Employee</view:field-name></view:field>, <view:field xmlns:view=\"http://marklogic.com/xdmp/view\"><view:field-name>EmployeeID</view:field-name></view:field>)\r\n$schema-name := \"main\"\r\n$view-name := \"employees\"\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"gfurbush", "name":"Gordon Furbush ", "email":"gfurbush@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, {"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, {"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["SQL", "gfurbush"], "changeHistory":[{"time":"2013-01-30T14:24:39.837311-08:00", "updatedBy":{"username":"gfurbush", "name":"Gordon Furbush ", "email":"gfurbush@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gfurbush", "name":"Gordon Furbush ", "email":"gfurbush@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2013-01-30T16:44:26.404992-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"7.0-ea1"}}, "files":[], "show":true}, {"time":"2013-01-31T14:37:51.209513-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"130183", "paths":["xdmp/trunk/src/Modules/MarkLogic/views.xqy"], "affectedBugs":["20647"]}, "comment":"Bug:20646 Bug:20647"}, {"time":"2013-01-31T14:38:31.233749-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed 7.0-20130201"}, {"time":"2013-01-31T14:38:31.233749-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-02T11:02:51.480268-08:00", "updatedBy":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "to":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-07T11:47:55.117077-08:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed. Automated test added to sqlmtch test suite"}, {"time":"2013-03-07T11:47:55.117077-08:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-03-07T11:47:55.117077-08:00", "fixedAt":"2013-01-31T14:38:31.233749-08:00", "fixedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "shippedAt":"2013-03-07T11:47:55.117077-08:00", "shippedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "renderDescriptionAs":"normal"}