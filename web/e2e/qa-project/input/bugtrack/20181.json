{"id":20181, "kind":"Bug", "createdAt":"2012-12-03T06:34:02.090506-08:00", "status":"Closed", "title":"xdmp:multipart-decode() fails with XDMP:DOCNONSBIND error when namespace for xsi:type is not declared", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"mhelmstetter", "name":"Mark Helmstetter", "email":"mark.helmstetter@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"This is similar to the old/fixed bug 9079. xdmp:multipart-decode() will fail when a document contains an xsi:type attribute which contains a namespace prefix that's not declared. This impacts FlexRep which uses multipart encode/decode, causing these documents to fail to replicate.\r\n\r\nSee test case below.", "samplequery":"import module namespace flexrep=\"http://marklogic.com/xdmp/flexible-replication\" at \"MarkLogic/flexrep.xqy\";\r\nlet $filtered := <foo xsi:type=\"xxx:FooType\"></foo>\r\nlet $seperator := fn:concat(\"flexrep-\", xdmp:random())\r\nlet $encoded := flexrep:multipart-encode($seperator, $filtered)\r\nlet $raw := xdmp:multipart-decode($seperator, $encoded)\r\nreturn $raw", "sampledata":"", "version":"4.2-9", "tofixin":"4.2-10", "fixedin":"N/A", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"mhelmstetter", "name":"Mark Helmstetter", "email":"mark.helmstetter@marklogic.com"}, {"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20179, "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "mhelmstetter"], "changeHistory":[{"time":"2012-12-03T07:46:23.468496-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "to":{"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-03T07:46:23.468496-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"assignTo":{"from":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "to":{"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-03T07:46:23.468496-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"tofixin":{"from":"", "to":"5.0-5"}}, "files":[], "show":true}, {"time":"2012-12-03T07:52:21.636075-08:00", "updatedBy":{"username":"cjl", "name":"Christopher Lindblad", "email":"cjl@cerisent.com"}, "change":{"tofixin":{"from":"", "to":"4.2-10"}}, "files":[], "show":true}, {"time":"2013-03-15T13:29:16.681209-07:00", "updatedBy":{"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"4.2-* is no longer supported."}, {"time":"2013-03-15T13:29:16.681209-07:00", "updatedBy":{"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-03-15T13:29:16.681209-07:00", "closedAt":"2013-03-15T13:29:16.681209-07:00", "closedBy":{"username":"hwu", "name":"Haitao Wu", "email":"haitao.wu@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}