{"id":2028, "kind":"Bug", "createdAt":"2005-08-02T19:02:57.395441-07:00", "status":"Closed", "title":"XDBC returns null rather than throwing an exception on truncated result sequences", "category":"XDBC(Java)", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ronh", "name":"Ron Hitchens", "email":"ronh@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"If a result sequence that is not \"streaming\" (contains a Content-Length header) is truncated, such as by the server timing out and dropping the socket, a null value may be returned for one or more result items rather than an exception being thrown.  In the case of resultSequence.getNode().asString(), an IOException is silently smothered and a stack trace written to stderr.\n\nIn some cases an XDBCException is ultimately thrown, sometimes no error indication is ever given while iterating the truncated result sequence.", "samplequery":"", "sampledata":"", "version":"3.0-2", "tofixin":"3.0-3", "fixedin":"3.0-3", "platform":"linux", "memory":"412", "processors":"1", "note":"", "subscribers":[{"username":"ronh", "name":"Ron Hitchens", "email":"ronh@marklogic.com"}], "attachments":[], "clones":[2029, 2074], "cloneOf":"", "support":{"headline":"XDBC returns null rather than throwing an exception on truncated result sequences", "supportDescription":"If the server connection drops in the middle of an XDBC session (most probably because the client does not read the full query result in a timely manner), then a null result item may be returned.  This can only occur if the result sequence is \"streaming\".  Other conditions that give rise to this situation include large result sets (minimum 64K for 32-bit systems, 256K for 64-bit systems), short request timeouts, and interleaved queries on the client side.", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":"Check for null results and assume a dropped connection in these cases."}, "tags":["XDBC(Java)", "ronh"], "changeHistory":[{"time":"2005-08-10T18:17:25.012922-07:00", "updatedBy":{"username":"ronh", "name":"Ron Hitchens", "email":"ronh@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"A partial fix for this has been made in the 2.2, 3.0 and 3.1 branches.  The partial fix properly throws excpetions during hasNext() or next() if a truncated result sequence is detected.  It also corrects the Node type to throw a runtime exception (rather than return null) if an I/O error occurs while reading the node.  However, similar issues still apply to other item types (such as Text, Binary, etc).\n\nPerhaps this bug should be cloned, with this one being closed against 3.0, and the clone to cover the remaining fixes to apply to 3.1."}, {"time":"2005-08-11T14:34:43.94484-07:00", "updatedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "to":{"username":"ronh", "name":"Ron Hitchens", "email":"ronh@marklogic.com"}}}, "files":[], "show":true, "comment":"move to ship when you're happy with the 3.0-3 state of this bug, please.  i've cloned onto the 3.1-nightly branch."}, {"time":"2005-08-30T16:19:11.939134-07:00", "updatedBy":{"username":"ronh", "name":"Ron Hitchens", "email":"ronh@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"ronh", "name":"Ron Hitchens", "email":"ronh@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Passes rigorous unit tests."}], "updatedAt":"2005-08-30T16:19:11.939134-07:00", "fixedAt":"2005-08-11T14:34:43.94484-07:00", "fixedBy":{"username":"ian", "name":"Ian Small", "email":"ian@cerisent.com"}, "shippedAt":"2005-08-30T16:19:11.939134-07:00", "shippedBy":{"username":"ronh", "name":"Ron Hitchens", "email":"ronh@marklogic.com"}, "renderDescriptionAs":"normal"}