{"id":20643, "kind":"Bug", "createdAt":"2012-10-16T15:20:32.072053-07:00", "status":"Closed", "title":"xdmp:document-filter() of an Excel file on Linux extracts incorrect 0 values for currency format fields, e.g. dollar amounts", "category":"conversion", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"The problem manifests as a regression in the QA module isys_samples22,\r\nTest104: 052-Microsoft-Excel-XLS-XLSX-Investment-Calculator1.xls:\r\ncurrency format numbers have 0 instead of the expected number.\r\n", "samplequery":"", "sampledata":"", "version":"5.0-nightly", "tofixin":"5.0-6", "fixedin":"5.0-6", "platform":"linux(64-bit)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, {"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":19789, "support":{"headline":"xdmp:document-filter() of an Excel file on Linux extracts incorrect 0 values for currency format fields, e.g. dollar amounts", "supportDescription":"xdmp:document-filter() of an Excel file on Linux extracts incorrect 0 values for currency format fields, e.g. dollar amounts", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["conversion", "smiller"], "changeHistory":[{"time":"2012-10-16T15:25:05.095032-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"status":{"from":"", "to":"External"}, "assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true, "comment":"Acknowledged Isys issue:\r\n\r\nFrom:\tLevi Reep <levi.reep@perceptivesoftware.com>\r\nSent:\tThursday, October 11, 2012 9:04 AM\r\nTo:\tScott Miller\r\nSubject:\tRE: Numbers no longer extracted from .xls, content no longer extracted from \r\n.TST\r\n\r\nHello Scott,\r\n\r\nIt is reproducing for me on Linux only as well.  I ran several tests on my VMs and will forward my test \r\ncase over to development.\r\n\r\nRegards,\r\n\r\nLevi\r\n\r\n-----Original Message-----\r\nFrom: Scott Miller [mailto:Scott.Miller@marklogic.com]\r\nSent: Tuesday, October 09, 2012 1:04 PM\r\nTo: Levi Reep (levi.reep@perceptivesoftware.com)\r\nSubject: RE: Numbers no longer extracted from .xls, content no longer extracted from .TST\r\n\r\nHi, Levi--\r\n\r\nWere you able to reproduce this?  I'm on Linux in case that's significant.\r\nThe only way I can characterize it at the moment is \"any Excel currency format value or function result \r\nfield is erroneously extracted as 0,\"\r\n...\r\n"}, {"time":"2012-10-16T15:25:05.095032-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-30T16:45:23.406617-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"5.0-6"}}, "files":[], "show":true}, {"time":"2013-03-12T16:12:57.12711-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136379", "paths":["xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYS10df.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSreaders.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSpdf6.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSautocad.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSshared.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSpdf6.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSautocad.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSreaders.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSshared.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSpdf6.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSreadershd.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYSreaders.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSreaders.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYS10df.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSshared.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSautocad.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYS10df.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSreaders.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSreadershd.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYS10df.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSreadershd.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSreadershd.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSpdf6.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSshared.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSshared.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.1/libISYSautocad.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.4/libISYSautocad.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/i686-gcc4.1/libISYS10df.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.6/libISYSreadershd.so", "xdmp/branches/b5_0/src/Converters/cvtisys/linux/x86_64-gcc4.5/libISYSpdf6.so"], "affectedBugs":["19788"]}, "comment":"bug:19788 bug:20643 upgrade to Isys 10.2 Build 945 (Linux)"}, {"time":"2013-03-12T16:14:28.728576-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136380", "paths":["xdmp/branches/b5_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYS10df.lib", "xdmp/branches/b5_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSautocad.dll", "xdmp/branches/b5_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSreaders.dll", "xdmp/branches/b5_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSreadershd.dll", "xdmp/branches/b5_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYSpdf6.dll", "xdmp/branches/b5_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYS10df.dll", "xdmp/branches/b5_0/src/Converters/cvtisys/winnt/amd64-msvc8/ISYS.documentfilters.dll"], "affectedBugs":["19788"]}, "comment":"bug:19788 bug:20643 upgrade to Isys 10.2 Build 945 (Windows)"}, {"time":"2013-03-12T16:15:04.634611-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136381", "paths":["xdmp/branches/b5_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSshared.dylib", "xdmp/branches/b5_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYS10df.dylib", "xdmp/branches/b5_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSpdf6.dylib", "xdmp/branches/b5_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSautocad.dylib", "xdmp/branches/b5_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSreadershd.dylib", "xdmp/branches/b5_0/src/Converters/cvtisys/macosx/x86_64-gcc4.2/libISYSreaders.dylib"], "affectedBugs":["19788"]}, "comment":"bug:19788 bug:20643 upgrade to Isys 10.2 Build 945 (MacOSX)"}, {"time":"2013-03-12T16:15:53.87471-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"136382", "paths":["xdmp/branches/b5_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYS10df.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSpdf6.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSreadershd.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSreaders.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSautocad.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/amd64-gcc4.1/libISYSshared.so"], "affectedBugs":["19788"]}, "comment":"bug:19788 bug:20643 upgrade to Isys 10.2 Build 945 (Solaris)"}, {"time":"2013-03-12T16:20:12.845178-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}}}, "files":[], "show":true, "comment":"Fixed with upgrade to Isys 10.2 build 945.\r\n"}, {"time":"2013-03-12T16:20:12.845178-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{"assignTo":{"from":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "to":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-18T10:19:21.033769-07:00", "updatedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"137103", "paths":["xdmp/branches/b5_0/src/Converters/cvtisys/solaris/sparcv9-gcc4.1/libISYSshared.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/sparcv9-gcc4.1/libISYSpdf6.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/sparcv9-gcc4.1/libISYS10df.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/sparcv9-gcc4.1/libISYSreaders.so", "xdmp/branches/b5_0/src/Converters/cvtisys/solaris/sparcv9-gcc4.1/libISYSautocad.so"], "affectedBugs":["19788"]}, "comment":"bug:19788 bug:20643 upgrade to Isys 10.2 Build 945 (Solaris, sparc)"}, {"time":"2014-03-24T14:42:24.755553-07:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Test104 in isys_samples22.xml covers this case"}, {"time":"2014-03-24T14:42:24.755553-07:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}, {"time":"2014-04-09T16:28:26.707361-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"ga"}], "updatedAt":"2014-04-09T16:28:26.707361-07:00", "fixedAt":"2013-03-12T16:20:12.845178-07:00", "fixedBy":{"username":"smiller", "name":"Scott Miller", "email":"Scott.Miller@marklogic.com"}, "shippedAt":"2014-03-24T14:42:24.755553-07:00", "shippedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "closedAt":"2014-04-09T16:28:26.707361-07:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal"}