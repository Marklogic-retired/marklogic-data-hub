{"id":20149, "kind":"Bug", "createdAt":"2012-11-27T09:06:15.223797-08:00", "status":"Closed", "title":" cts:hash-terms  is returning the results(cts:term ) twice when pos=”1” ", "category":"xdmp", "severity":"Critical", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"cts:hash-terms  is returning the results(cts:term ) twice when pos=”1” \r\n\r\nXquery:\r\n\r\nlet $opts := <options xmlns=\"cts:train\" xmlns:db=\"http://marklogic.com/xdmp/database\">\r\n     <db:word-searches>true</db:word-searches>\r\n     <db:word-positions>true</db:word-positions>\r\n</options>\r\nreturn\r\n<results>\r\n{\r\nfor $doc in ('document { text{\"one\"} }')\r\nreturn\r\n(\r\n<result>\r\n<doc>{$doc}</doc>\r\n{for $t in cts:hash-terms(xdmp:eval($doc) , $opts )//*:term order by $t/@id return $t}\r\n</result>\r\n)\r\n}\r\n</results>\r\n\r\nResults:\r\n\r\n<results>\r\n  <result>\r\n    <doc>document { text{\"one\"} }</doc>\r\n    <cts:term id=\"2328177500544466626\" pos=\"-1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n    <cts:term id=\"2637484101749275710\" pos=\"-1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n    <cts:term id=\"11724398851546280947\" pos=\"1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n    <cts:term id=\"11724398851546280947\" pos=\"1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n    <cts:term id=\"15041569596143136458\" pos=\"-1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n    <cts:term id=\"16042525898930586602\" pos=\"1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n    <cts:term id=\"16042525898930586602\" pos=\"1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n    <cts:term id=\"18048571922204647374\" pos=\"-1\" xmlns:cts=\"http://marklogic.com/cts\"/>\r\n  </result>\r\n</results>\r\n\r\nML version: 7.0-20121127\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"linux(64-bit)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "iagrawal"], "changeHistory":[{"time":"2012-11-27T09:06:15.223797-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-30T17:38:04.865005-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Is this a regression? Which test has failed and since when?"}, {"time":"2012-12-02T09:56:26.236307-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"After fix for 20160:\r\n\r\n<results><result><doc>document { text{\"one\"} }</doc><cts:term id=\"2328177500544466626\" pos=\"-1\"/><cts:term id=\"2637484101749275710\" pos=\"-1\"/><cts:term id=\"11724398851546280947\" pos=\"1\"/><cts:term id=\"15041569596143136458\" pos=\"-1\"/><cts:term id=\"16042525898930586602\" pos=\"1\"/><cts:term id=\"18048571922204647374\" pos=\"-1\"/></result></results>"}, {"time":"2012-12-02T09:59:31.657305-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}}}, "files":[], "show":true, "comment":"Please test and close as a duplicate of 20160."}, {"time":"2012-12-02T09:59:31.657305-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-03T04:02:09.850499-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"The test bug4009.xml was failing on 7.0 sandbox. But it is passing now. Verified on ML Version 7.0-20121202 in run 14:00 and 19:00"}, {"time":"2012-12-03T04:02:09.850499-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2012-12-03T04:02:09.850499-08:00", "fixedAt":"2012-12-02T09:59:31.657305-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "shippedAt":"2012-12-03T04:02:09.850499-08:00", "shippedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "renderDescriptionAs":"normal"}