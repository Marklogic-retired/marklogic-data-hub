{"id":20492, "kind":"Bug", "createdAt":"2013-01-17T01:51:26.170581-08:00", "status":"Closed", "title":"Stemmed Search not returning correct results on cts:word-query", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"ML Version: 7.0-20130116\r\nTest Name: bug2253.xml\r\nLink to Diff: https://regression-status.marklogic.com/new-app/space2/diff-archive/sand-box/b7_0/2013-01-14/linux-64-rh5sandbox_HEAD_2-2013/diffs/bug2253.xml\r\n\r\nSteps to reproduce:\r\n1. Create new DB\r\n2. Create new Forest and associate with DB\r\n3. Associate DB with xdbc server\r\n4. set stemmed search to advanced\r\n5. insert docs\r\nxdmp:document-insert(\"f1.xml\",<doc><foo>further</foo></doc>),xdmp:document-insert(\"f2.xml\",<doc><f2>casting</f2></doc>),xdmp:document-insert(\"f3.xml\",<doc><f3>misgiving</f3></doc>)\r\n\r\nPerform Search:\r\ncts:search(input(),cts:word-query(\"furthers\",\"stemmed\")),\r\ncts:search(input(),cts:word-query(\"castings\",\"stemmed\")),\r\ncts:search(input(),cts:word-query(\"misgiving\",\"stemmed\"))\r\n\r\nActual: \r\n<doc><foo>further</foo></doc><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<doc><f2>casting</f2></doc><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n\r\nExpected:\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><doc><foo>further</foo></doc>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><doc><f2>casting</f2></doc>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><doc><f3>misgiving</f3></doc>\r\n\r\nNote: \r\nThis started failing since 2013 run on 2013-01-14.", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "ksaxena"], "changeHistory":[{"time":"2013-01-17T01:51:26.170581-08:00", "updatedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-17T16:30:54.895953-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-18T07:07:02.978487-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"My stand-alone setup (just configuring \"Advanced\" stemming on Documents database) produces correct results:\r\n\r\nxdmp:document-insert(\"f1.xml\",<doc><foo>further</foo></doc>),xdmp:document-insert(\"f2.xml\",<doc><f2>casting</f2></doc>),xdmp:document-insert(\"f3.xml\",<doc><f3>misgiving</f3></doc>) \r\n;\r\ncts:search(doc(),cts:word-query(\"furthers\",\"stemmed\")),\r\ncts:search(doc(),cts:word-query(\"castings\",\"stemmed\")),\r\ncts:search(doc(),cts:word-query(\"misgiving\",\"stemmed\"))\r\n=>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<doc><foo>further</foo></doc>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<doc><f2>casting</f2></doc>\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<doc><f3>misgiving</f3></doc>\r\n\r\nI will look into the actual test-case to see if anything is different in the test."}, {"time":"2013-01-18T14:02:27.412916-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Is it possible to figure out the exact day from which this failure started?"}, {"time":"2013-01-22T20:14:38.054213-08:00", "updatedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"It started appearing on 2013-01-14 during 2013 sandbox run."}, {"time":"2013-02-08T15:15:38.074773-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}}}, "files":[], "show":true, "comment":"Doesn't look like the test is failing on the sand-box anymore."}, {"time":"2013-02-08T15:15:38.074773-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-21T03:04:50.555027-08:00", "updatedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"This test is no more failing on 7.0. Looks like it got fixed with some other bug. Will open a new one if it fails again!"}, {"time":"2013-02-21T03:04:50.555027-08:00", "updatedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-02-21T03:04:50.555027-08:00", "fixedAt":"2013-02-08T15:15:38.074773-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "closedAt":"2013-02-21T03:04:50.555027-08:00", "closedBy":{"username":"ksaxena", "name":"Kapil Saxena", "email":"kapil.saxena@marklogic.com"}, "renderDescriptionAs":"normal"}