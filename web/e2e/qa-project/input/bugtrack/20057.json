{"id":20057, "kind":"Bug", "createdAt":"2012-11-09T13:52:30.997517-08:00", "status":"Closed", "title":" cts:path-range-query filter dos not return correct results on namespace wildcard", "category":"xdmp", "severity":"Minor", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"xdmp:document-insert(\"1.xml\",\r\n     <page xml:lang=\"en\" xmlns=\"http://www.mediawiki.org/xml/export-0.4/\">\r\n    <h2>Early life</h2></page>\r\n    )\r\n\r\ncreate path namespace wm : http://www.mediawiki.org/xml/export-0.4/\r\ncreate path range index string type on wm:h2 and *:h2\r\n\r\n\r\nxquery version \"1.0-ml\";\r\ndeclare namespace wm = \"http://www.mediawiki.org/xml/export-0.4/\";\r\ndeclare namespace map = \"http://marklogic.com/xdmp/map\";\r\n \r\nfn:count(cts:search(  fn:doc(),  cts:path-range-query(    \"wm:h2\",    \"=\",    \"Early life\"    ,    (\"collation=http://marklogic.com/collation/\")  ))),\r\nfn:count(cts:search(  fn:doc(),  cts:path-range-query(    \"*:h2\",    \"=\",    \"Early life\"    ,    (\"collation=http://marklogic.com/collation/\")  )))\r\n\r\n\r\nreturns  1 0\r\n\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20050, "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "fxue"], "changeHistory":[{"time":"2012-11-09T13:52:30.997517-08:00", "updatedBy":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "change":{"assignTo":{"from":{"username":"fxue", "name":"Fei Xue", "email":"Fei.Xue@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-09T14:31:28.628829-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"This is filter specific issue:\r\n\r\n1. Create string path range index with default collation on: /*:p.\r\n\r\n2. Add two documents:\r\n\r\ndeclare namespace my =   \"http://aaa.com\";\r\nxdmp:document-insert(\"/ab.xml\",<my:a my:b=\"B1\">A1</my:a>),\r\nxdmp:document-insert(\"/pq.xml\",<my:p my:q=\"Q1\">P1</my:p>)\r\n\r\n3. cts:values(cts:path-reference(\"/*:p\"))\r\n=>\r\n    P1\r\n\r\n4. cts:search(doc(),cts:path-range-query(\"/*:p\",\"=\",\"P1\"), \"unfiltered\")\r\n=>\r\n<my:p my:q=\"Q1\" xmlns:my=\"http://aaa.com\">P1</my:p>  \r\n\r\n5. cts:search(doc(),cts:path-range-query(\"/*:p\",\"=\",\"P1\"), \"filtered\")\r\n=>\r\n   returns nothing\r\n\r\n6. cts:contains(doc(),cts:path-range-query(\"/*:p\",\"=\",\"P1\"))\r\n=>\r\n  false\r\n\r\n"}, {"time":"2012-11-09T14:31:28.628829-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.0-2"}}, "files":[], "show":true}, {"time":"2012-11-10T09:32:57.174396-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"6.0-2", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2012-11-11T06:24:02.988441-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"6.1-ea1"}}, "files":[], "show":true}, {"time":"2012-12-03T20:18:58.823303-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"122574", "paths":["xdmp/trunk/src/SearchBuiltins.cpp", "xdmp/trunk/src/PathIndexes.cpp"], "affectedBugs":[]}, "comment":"Code clean-up and fix for bug:20057.\n"}, {"time":"2012-12-03T20:51:36.892209-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-03T20:51:36.892209-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-27T13:55:03.246699-08:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-20130221\r\n cts:search(doc(),cts:path-range-query(\"/*:p\",\"=\",\"P1\"), \"filtered\") \r\nreturns  <my:p my:q=\"Q1\" xmlns:my=\"http://aaa.com\">P1</my:p>\r\n\r\ncts:contains(doc(),cts:path-range-query(\"/*:p\",\"=\",\"P1\"))  returns true."}], "updatedAt":"2013-02-27T13:55:03.246699-08:00", "fixedAt":"2012-12-03T20:51:36.892209-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "shippedAt":"2013-02-27T13:55:03.246699-08:00", "shippedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "renderDescriptionAs":"normal"}