{"id":20244, "kind":"Bug", "createdAt":"2012-03-06T11:48:57.031814-08:00", "status":"Closed", "title":"Changing database field configuration may cause refragmentation in another database having a field with the same name", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"aredalen", "name":"Aaron Redalen", "email":"aredalen@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"On a server having two databases that each have a field with the same field name, changing the configuration of the field in one database may cause the other database (whose configuration has NOT been modified) to reindex/refragment the same field if it is processing updates when the change is made.\r\n\r\nGiven that this has only been observed when the second database is processing updates, the bug may only occur when the second database is creating, updating, or saving in-memory stands.\r\n\r\nTo recreate:\r\nCreate two databases, each having a field with the same name.\r\nStart loading data into one database.\r\nWhile data is loading, change the configuration of the field (indexes, lexicons, etc) in the other database\r\nObserve first database reindexing\r\n\r\nFrom the log when this occurred:\r\n2012-03-06 14:31:35.427 Config: Loading /var/opt/MarkLogic/databases.xml\r\n2012-03-06 14:31:35.471 Info: Refragmented modified fields 3302 fragments in 15 sec at 224 fragments/sec on forest date-posted\r\n\r\nNote that the configuration of the database that this forest is attached to was NOT modified.", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-1", "fixedin":"N/A", "platform":"linux(64-bit)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"aredalen", "name":"Aaron Redalen", "email":"aredalen@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":16483, "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "aredalen"], "changeHistory":[{"time":"2012-03-07T14:32:48.870858-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Assign it to 5.0-4 since 5.0-3 is pretty close to shipping."}, {"time":"2012-03-07T14:32:48.870858-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-03-07T14:32:48.870858-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-03-07T15:54:22.61033-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Mary,  refragmentation is closer to your end. Can you look at this or distribute to someone else to spread the load?"}, {"time":"2012-03-07T15:54:22.61033-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2012-12-10T13:24:12.988693-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"5.0-5", "to":"5.0-6"}}, "files":[], "show":true}, {"time":"2012-12-10T14:53:55.722421-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"7.0-1"}}, "files":[], "show":true}, {"time":"2013-05-20T09:05:57.081306-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-13T07:58:20.603614-07:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2013-07-17T11:16:47.958618-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"With all the cloning and pushing back and forth between releases, this ended up as a\r\nduplicate of 22812, which is fixed."}, {"time":"2013-07-17T11:16:47.958618-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-07-17T11:16:47.958618-07:00", "closedAt":"2013-07-17T11:16:47.958618-07:00", "closedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "renderDescriptionAs":"normal"}