{"id":20872, "kind":"Bug", "createdAt":"2013-02-21T02:19:17.748721-08:00", "status":"Closed", "title":"REGR:more count for RANGEINDEX seen than expected", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"REGR:more count for RANGEINDEX seen than expected\r\n\r\nTest Failing:invalid-values-reindexing.xml\r\nMl Version: 20130220\r\nLink to diff on nightly regression: https://regression-status.marklogic.com/new-app/space2/diff-archive/b7_0/2013-02-20/solaris-64-sol10-cluster/diffs/invalid-values-reindexing.xml\r\n\r\n\r\nSteps to Reproduce:\r\n1. Create DB with forest and associate DB with triggers db\r\n2. set dir create to manual, disable maintain-last-modified, maintain-directory-last-modified, inherit-permissions, inherit-collections, inherit-quality\r\n3. Run following shell command: date;grep -c 'RANGEINDEX' 'MLD_HOME'/Logs/ErrorLog.txt > count\r\n\r\nActual Count: 1080\r\nExpected Count:1000\r\n\r\nNote: The test invalid-values-reindexing.xml started failing since 2013-01-14", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"solaris(opteron)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"smazer", "name":"Sara  Mazer", "email":"Sara.Mazer@marklogic.com"}, {"username":"sverma", "name":"Shiva Verma", "email":"shiva.verma@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "iagrawal"], "changeHistory":[{"time":"2013-02-21T02:19:17.748721-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-04T22:18:57.183887-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"This is a test issue. I executed all these steps number of times and all the steps work correctly. I think the shell script in TEST01b is wrong. I wonder this test has ever run!\r\n\r\nIf you are fixing the test please remove all the commented cases and also fix the copy and paste mistakes of test-case numbers and comments.\r\n\r\nThe approach of taking a previous count and then subtracting the final count is unnecessary since the initial count is always expected to be zero. Better approach will be just to take the final count.\r\n\r\nAlso please refer to other cases that test reindexing status using forest status builtin: path-index-unit-tests-19.xml, path-index-unit-tests-wildcard19.xml, path-index-bug16838.xml, path-index-bug16764.xml.\r\n"}, {"time":"2013-03-04T22:18:57.183887-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-04T22:18:57.183887-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-06T00:59:14.731881-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"    "}, {"time":"2013-03-06T00:59:14.731881-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Hi Gajanan,\r\nI have fixed the glitches for this test and hence closing the bug:\r\n1. Removed all the commented cases and also fixed the copy and paste mistakes of test-case numbers and comments.\r\n2. Removed sleep (wait ) for re-indexing to be completed and added a subtest to test reindexing status using forest status builtin.\r\n\r\nAnd here the logic behind  taking a previous count and then subtracting the final count is to get the final count for that particular configuration. As this test is a part of nightly regression and hence initial count is not zero in ErrorLog may be due to some previous tests. \r\n\r\nAs per said by you \"initial count is always expected to be zero\" but thats only the case of clean install. \r\n"}, {"time":"2013-03-06T00:59:14.731881-08:00", "updatedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "change":{"assignTo":{"from":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-03-06T00:59:14.731881-08:00", "fixedAt":"2013-03-04T22:18:57.183887-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "closedAt":"2013-03-06T00:59:14.731881-08:00", "closedBy":{"username":"iagrawal", "name":"Isha Agrawal", "email":"iagrawal@marklogic.com"}, "renderDescriptionAs":"normal"}