{"id":20271, "kind":"Bug", "createdAt":"2011-09-28T15:24:58.163202-07:00", "status":"Closed", "title":"Log a warning when not all forests in the DB have been backed up", "category":"xdmp", "severity":"Minor", "priority":{"level":"3", "title":""}, "submittedBy":{"username":"schartrand", "name":"Steffan Chartrand", "email":"Steffan.Chartrand@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Could create inconsistencies if only some of the forests are restored for a DB. User may have forgotten certain forests.", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-1", "fixedin":"7.0-1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"schartrand", "name":"Steffan Chartrand", "email":"Steffan.Chartrand@marklogic.com"}, {"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, {"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, {"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, {"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":15290, "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "schartrand"], "changeHistory":[{"time":"2011-09-28T15:24:58.163202-07:00", "updatedBy":{"username":"schartrand", "name":"Steffan Chartrand", "email":"Steffan.Chartrand@marklogic.com"}, "change":{"assignTo":{"from":{"username":"schartrand", "name":"Steffan Chartrand", "email":"Steffan.Chartrand@marklogic.com"}, "to":{"username":"schartrand", "name":"Steffan Chartrand", "email":"Steffan.Chartrand@marklogic.com"}}}, "files":[], "show":true}, {"time":"2011-11-08T11:54:04.421974-08:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"schartrand", "name":"Steffan Chartrand", "email":"Steffan.Chartrand@marklogic.com"}}}, "files":[], "show":true, "comment":"Seems reasonable. Be sure to handle local-disk failover replicas correctly. It might also be worth warning that a backup is being done while in a failed over state, but if so be sure to make it clear there is no concern of data loss."}, {"time":"2011-11-22T10:43:44.297983-08:00", "updatedBy":{"username":"schartrand", "name":"Steffan Chartrand", "email":"Steffan.Chartrand@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"TODO:\r\n- if scheduled backup says include replicas and one of the master/replica set is down, then warn about these forests being down\r\n- log this warning all the time regardless if JA is on or off"}, {"time":"2012-04-25T16:14:56.294114-07:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-07-30T13:32:37.463253-07:00", "updatedBy":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "change":{"assignTo":{"from":{"username":"wfeick", "name":"Wayne Feick", "email":"wfeick@marklogic.com"}, "to":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-12T18:03:01.065687-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"7.0-ea1"}}, "files":[], "show":true}, {"time":"2013-02-19T16:52:27.133047-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"tofixin":{"from":"7.0-ea1", "to":"7.0-ea2"}}, "files":[], "show":true}, {"time":"2013-04-30T18:27:49.327891-07:00", "updatedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "change":{"tofixin":{"from":"7.0-ea2", "to":"7.0-ea3"}}, "files":[], "show":true}, {"time":"2013-06-17T16:09:41.243137-07:00", "updatedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "change":{"tofixin":{"from":"7.0-ea3", "to":"7.0-1"}}, "files":[], "show":true}, {"time":"2013-07-24T19:26:00.267775-07:00", "updatedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"147570", "paths":["xdmp/trunk/src/Database.cpp"], "affectedBugs":[]}, "comment":"bug:20271 log warning when not all forests are backed up"}, {"time":"2013-07-24T19:26:43.268194-07:00", "updatedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Here is the message:\r\n\r\n2013-07-24 19:24:18.289 Warning: Forest forest3 or its replica is not available for scheduled backup.\r\n"}, {"time":"2013-07-24T19:27:08.741932-07:00", "updatedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-07-24T19:27:08.741932-07:00", "updatedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "change":{"assignTo":{"from":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-08-08T15:10:33.521847-07:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-10-14T16:03:36.286189-07:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Server was installed in 2 hosts\r\n1.sthirumavalavan-z600\r\n2.sreddy-z600\r\nCreated db1, for1 in both the hosts. \r\nConfigured a cluster between the two hosts and database replication was setup between db1/for1 \r\n\r\nBrought down server in replica sreddy-z600 bby\r\n/usr/bin/sudo /usr/local/sbin/mladmin killprocs\r\n\r\nsthirumavalavan-z600 Errorlog: 2013-10-14 15:59:01.558 Error: PooledThread::run: SVC-SOCCONN: Socket connect error: connect 172.16.16.63:7998: Connection refused\r\n\r\nWhen sreddy-z600 is down\r\nBackup was started in sthirumavalavan:z600 \r\nBackup completed successfully without any warnings.\r\n\r\nCan you please check if the bug is fixed?\r\n\r\n\r\n\r\n\r\n"}, {"time":"2013-10-14T18:38:09.084815-07:00", "updatedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Do you have forests on both hosts for that database? Also, did you use schedule backup task?"}, {"time":"2013-10-25T14:14:32.345713-07:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Brought up a cluster of 3 hosts\r\nCreated 6 forests in 3 hosts\r\n\r\nHost1 - f1m, f3r\r\nHost2 - f2m, f1r\r\nHost3 - f3m, f2r\r\n\r\nf1r is the replica of f1m\r\nf2r is the replica of f2m\r\nf3r is the replica of f3m\r\n\r\nKilled server in Host2 using command\r\nsudo mladmin killprocs\r\nForests f2m and f1r are down.\r\n\r\nCreated a scheduled backup in Host1\r\nSaw the warning messages in the Error log.\r\n\r\n2013-10-25 14:09:00.351 Warning: Forest f1m or its replica is not available for scheduled backup.\r\n2013-10-25 14:09:00.353 Warning: Forest f2m or its replica is not available for scheduled backup.\r\n"}, {"time":"2013-10-25T14:14:32.345713-07:00", "updatedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-10-25T14:14:32.345713-07:00", "fixedAt":"2013-07-24T19:27:08.741932-07:00", "fixedBy":{"username":"atsoi", "name":"Arthur Tsoi", "email":"arthur.tsoi@marklogic.com"}, "shippedAt":"2013-10-25T14:14:32.345713-07:00", "shippedBy":{"username":"sthirumavalavan", "name":"Subhadra Thirumavalavan", "email":"subhadra.thirumavalavan@marklogic.com"}, "renderDescriptionAs":"normal"}