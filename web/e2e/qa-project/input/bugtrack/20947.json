{"id":20947, "kind":"Bug", "createdAt":"2013-02-26T16:53:22.254582-08:00", "status":"Closed", "title":"REGR: Mlcp fails to insert a utf16 encoded text file using MIXED type", "category":"mlcp", "severity":"Critical", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"As it used to work, it is a regression (probably in both trunk and ea1) due to recent change in the behavior in case of loading MIXED type.\r\n\r\nTo reproduce it, run mlcp junit test testImportMixedTxtUTF16LE(com.marklogic.contentpump.TestImportDocs).\r\n\r\n3/02/26 16:30:26 DEBUG contentpump.ContentPump: Command: IMPORT\r\n13/02/26 16:30:26 DEBUG contentpump.ContentPump: Arguments: -password admin -username admin -host localhost -port 5275 -input_file_path file:/space/workspace/xcc/mlcp/src/test/resources/encoding/ML-utf-16le.txt -thread_count 1 -mode local -content_encoding UTF-16LE -output_collections test,ML \r\n13/02/26 16:30:26 DEBUG contentpump.ContentPump: Running in: localmode\r\n13/02/26 16:30:59 INFO contentpump.LocalJobRunner: Content type is set to MIXED.  The format of the  inserted documents will be determined by the MIME  type specification configured on MarkLogic Server.\r\n13/02/26 16:31:32 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=\r\n13/02/26 16:31:32 INFO input.FileInputFormat: Total input paths to process : 1\r\n13/02/26 16:31:32 DEBUG contentpump.CombineDocumentInputFormat: Total # of splits: 1\r\n13/02/26 16:31:32 DEBUG contentpump.CombineDocumentInputFormat: Total # of combined splits: 1\r\n13/02/26 16:31:33 INFO contentpump.LocalJobRunner:  completed 0%\r\n13/02/26 16:32:18 INFO contentpump.LocalJobRunner:  completed 100%\r\n13/02/26 16:32:45 WARN mapreduce.ContentWriter: XDMP-DOCUTF8SEQ: Invalid UTF-8 escape sequence at /space/workspace/xcc/mlcp/src/test/resources/encoding/ML-utf-16le.txt line 1 -- document is not UTF-8 encoded\r\n\r\n\r\nthe text file encoded in utf16le is at xcc/mlcp/src/test/resources/encoding/ML-utf-16le.txt\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, {"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["mlcp", "ali"], "changeHistory":[{"time":"2013-02-26T16:53:22.254582-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-08T17:30:13.680149-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"135764", "paths":["xcc/trunk/mlcp/src/main/java/com/marklogic/contentpump/CombineDocumentReader.java"], "affectedBugs":[]}, "comment":"Bug:20947 - Use parent attribute to set encoding.\n"}, {"time":"2013-03-08T17:31:05.756368-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"135765", "paths":["xcc/trunk/mapreduce/src/java/com/marklogic/mapreduce/ContentWriter.java"], "affectedBugs":[]}, "comment":"Bug:20947 - Set encoding in ContentOption globally.\n"}, {"time":"2013-03-08T17:36:06.507332-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"135766", "paths":["xcc/branches/b7_0-ea1/mapreduce/src/java/com/marklogic/mapreduce/ContentWriter.java"], "affectedBugs":[]}, "comment":"Bug:20947 - Set encoding in ContentOption globally.\n"}, {"time":"2013-03-08T17:37:02.749051-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"135767", "paths":["xcc/branches/b7_0-ea1/mlcp/src/main/java/com/marklogic/contentpump/CombineDocumentReader.java"], "affectedBugs":[]}, "comment":"Bug:20947 - Use parent attribute to set encoding.\n"}, {"time":"2013-03-08T17:37:35.031289-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-08T17:37:35.031289-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-11T17:42:34.537962-07:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 7.0-ea1_20130311"}], "updatedAt":"2013-03-11T17:42:34.537962-07:00", "fixedAt":"2013-03-08T17:37:35.031289-08:00", "fixedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "shippedAt":"2013-03-11T17:42:34.537962-07:00", "shippedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "renderDescriptionAs":"normal"}