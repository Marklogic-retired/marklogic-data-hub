{"id":20073, "kind":"Bug", "createdAt":"2012-11-09T14:34:42.249331-08:00", "status":"Closed", "title":"regression in cts:element-value-match with descending option", "category":"search", "severity":"Critical", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"fsalonga", "name":"Frank Salonga", "email":"franklin.salonga@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"from this case: https://help.marklogic.com/staff/Tickets/Ticket/View/12107\r\n\r\nLexis is trying to ship on 5.0-4 and ran into a bug. If you ingest shredded medline with an element range index on ArticleTitle, then do the following query:\r\n\r\ncts:element-value-match(xs:QName(\"ArticleTitle\"), \"S*\", (\"descending\"))\r\n\r\n...you'll see that the query returns no results (which is both incorrect and different than under their previous version of 5.0-3.2.1)\r\n\r\nNote that Lexis will likely need a hotfix for this issue as they're certifying on 5.0-4 and are trying to ship a release.", "samplequery":"", "sampledata":"", "version":"6.0-nightly", "tofixin":"6.0-2", "fixedin":"6.0-2", "platform":"linux(64-bit)", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"fsalonga", "name":"Frank Salonga", "email":"franklin.salonga@marklogic.com"}, {"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, {"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, {"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, {"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, {"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":20053, "support":{"headline":"", "supportDescription":"On 6.0 branch this is nightly issue.", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["search", "fsalonga"], "changeHistory":[{"time":"2012-11-09T17:43:59.241648-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-09T17:43:59.241648-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"5.0-5"}}, "files":[], "show":true}, {"time":"2012-11-12T13:55:10.109266-08:00", "updatedBy":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"dgorbet", "name":"David Gorbet", "email":"David.Gorbet@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-12T14:31:22.017082-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Mary,\r\nThis is an urgent Lexis bug.  We need to have a hot fix."}, {"time":"2012-11-12T14:31:22.017082-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2012-11-13T07:58:26.262378-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"It looks like this is due to the fix for bug 18174, revision 108597. The range iterator done() \r\ncondition is not correct for descending processing."}, {"time":"2012-11-13T08:57:51.177383-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"120381", "paths":["xdmp/branches/b5_0/src/OnDiskRangeIndexes.cpp"], "affectedBugs":[]}, "comment":"Bug:20053 make range array interval iterators termination condition correct for descending order"}, {"time":"2012-11-13T09:02:44.436699-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"tofixin":{"from":"", "to":"6.0-2"}}, "files":[], "show":true}, {"time":"2012-11-13T09:49:32.071046-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"120383", "paths":["xdmp/branches/b6_0/src/OnDiskRangeIndexes.cpp"], "affectedBugs":[]}, "comment":"Bug:20073 correct done() for range interval iterators"}, {"time":"2012-11-13T10:01:39.372371-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true, "comment":"Make sure done() methods for subclasses of RangeArrayIterator handle descending and ascending properly."}, {"time":"2012-11-13T10:01:39.372371-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-13T16:00:44.67943-08:00", "updatedBy":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rpolasani", "name":"Raghu Polasani", "email":"raghu.polasani@marklogic.com"}, "to":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-11-14T08:27:55.594006-08:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Hi Mary,\r\n \r\nI just want to confirm that this bug did not make it to the wild in 6.0?  The support info has a comment that this is a nightly issue only on 6.0, but looking at the referenced bug (bug 18174) for which this is a regression, that bug was fixed in 6.0-1."}, {"time":"2012-11-14T08:36:41.620039-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"Oh, my mistake. I thought 18174 was post 6.0-1."}, {"time":"2012-11-14T14:49:27.081281-08:00", "updatedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 6.0-20121114 with 'ascending' and descending' and returns correct results, whereas on build 6.0-20121112, it returned empty sequence."}], "updatedAt":"2012-11-14T14:49:27.081281-08:00", "fixedAt":"2012-11-13T10:01:39.372371-08:00", "fixedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "shippedAt":"2012-11-14T14:49:27.081281-08:00", "shippedBy":{"username":"msrinivasan", "name":"Mahalakshmi Srinivasan", "email":"mahalakshmi.srinivasan@marklogic.com"}, "renderDescriptionAs":"normal"}