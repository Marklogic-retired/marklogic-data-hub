{"id":20191, "kind":"Bug", "createdAt":"2012-12-04T17:32:36.604705-08:00", "status":"Closed", "title":"Cryptic error often reported:  Premature EOF, partial header line ", "category":"XCC/Java", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"dfeldman", "name":"Damon Feldman", "email":"dfeldman@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"\r\n\r\nA customer is again seeing \r\n\r\nError parsing HTTP headers: Premature EOF, partial header line read: ''\r\n\r\ndue to some XCC error. This error is in many bugs (open and closed) in bugtrack. I'm not sure what the error is exactly. It is probably user error while pushing .xqy files using mlant. \r\n\r\nThis bug is not about the customer issue, but rather to find the code that reports this cryptic error and make it more readable if that is possible. A search for \"Error parsing HTTP headers: Premature EOF, partial header line read\" returns 27 bugs, so this is pretty common, and always hard to figure out.", "samplequery":"", "sampledata":"", "version":"5.0-1", "tofixin":"5.0-5", "fixedin":"5.0-5", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"dfeldman", "name":"Damon Feldman", "email":"dfeldman@marklogic.com"}, {"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, {"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, {"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Never Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["XCC/Java", "dfeldman"], "changeHistory":[{"time":"2012-12-05T10:25:02.507824-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"status":{"from":"", "to":"Verify"}, "assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T10:25:02.507824-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T10:25:02.507824-08:00", "updatedBy":{"username":"gvaidees", "name":"Ganesh Vaideeswaran", "email":"Ganesh.Vaideeswaran@marklogic.com"}, "change":{"tofixin":{"from":"", "to":"5.0-5"}}, "files":[], "show":true}, {"time":"2012-12-05T15:39:32.54582-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{"assignTo":{"from":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "to":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}}}, "files":[], "show":true}, {"time":"2012-12-05T15:52:24.07033-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Damon, it is in HttpHeaders.nextHeaderLine().  Given the wealth of knowledge and discussions accumulated on this error, are you sure you want to rename it?  Anyway, suggestions are welcome.\r\n\r\nBTW, as part of 20120, I've enabled retry for this error and added UnexpectedResponseException.  I left the error message unchanged so that people get the same error message across versions.  You'll find it if you look at trunk or b6_0."}, {"time":"2012-12-05T16:56:39.574301-08:00", "updatedBy":{"username":"dfeldman", "name":"Damon Feldman", "email":"dfeldman@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I had imagined that there might be a few different situations. Is this always that a socket was closed prematurely, perhaps due to timeout?\r\n\r\nIf so, even though it's in our knowledge base I would still suggest we make it more indicative of the situation so that customers can interpret it. It generally appears in a Java server log, so that's the group that will get it first."}, {"time":"2012-12-05T17:33:33.374417-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Yes, the error is normally related to a timeout -- You are waiting for the server to send you a response and get a FIN instead.  You could also get an incomplete response when you see this error, in that case, it may not be due to a timeout.  For example, 19150 is not caused by timeout, but a bug."}, {"time":"2012-12-21T15:03:49.887218-08:00", "updatedBy":{"username":"dsokolsky", "name":"Danny Sokolsky", "email":"dsokolsky@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Jane, is there a way to make the error message better in this case?"}, {"time":"2012-12-21T20:21:37.899221-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Still putting in another fix for 20120.  I'll reconsider this after testing that."}, {"time":"2013-01-04T10:12:40.365001-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"126558", "paths":["xcc/branches/b5_0/xcc/src/java/com/marklogic/xcc/impl/handlers/AbstractRequestController.java", "xcc/branches/b5_0/xcc/src/java/com/marklogic/http/HttpHeaders.java", "xcc/branches/b5_0/xcc/src/java/com/marklogic/http/HttpChannel.java", "xcc/branches/b5_0/xcc/src/java/com/marklogic/xcc/exceptions/UnexpectedResponseException.java", "xcc/branches/b5_0/xcc/src/java/com/marklogic/xcc/Session.java", "xcc/branches/b5_0/xcc/src/java/com/marklogic/xcc/impl/SessionImpl.java"], "affectedBugs":[]}, "comment":"Bug:20191 - Retry when incomplete response is received.\n"}, {"time":"2013-01-04T10:19:05.642172-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"The above change added UnexpectedResponseException for this error, and also allows retry using the current XCC retry mechanism.  I believe that the error message is consistent with other parts of XCC and other systems for the situation.\r\n\r\nKim, is there a section in XCC documentation to document commonly encountered problems?  We could probably add cause and action for this exception. "}, {"time":"2013-01-04T10:19:05.642172-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-21T11:49:49.198136-08:00", "updatedBy":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Having looked over the XCC documentation, there isn't an appropriate place to say anything about this. Saying something in the UnexpectedResponseException javadoc is more appropriate.\r\n\r\nJane, you're in the best position to say whatever needs to be said in the javadoc, so I'm reassigning this to you. If you don't think it's needed, then just send it along to QA.\r\n\r\nOne can make an argument for adding a section on common errors to the XCC book, but there isn't such a thing now, and I don't think this bug is the place to add one. I'm not even convinced it is needed because I believe users will look in the javadoc first and foremost.\r\n"}, {"time":"2013-01-21T11:49:49.198136-08:00", "updatedBy":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, "change":{"assignTo":{"from":{"username":"kcoleman", "name":"Kim Coleman", "email":"kim.coleman@marklogic.com"}, "to":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-21T16:43:07.107878-08:00", "updatedBy":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Jane,\r\nDo you want to move it to 'test' status and assign to QA?"}, {"time":"2013-01-22T12:39:09.678627-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Apparently the above change is causing diff:\r\n\r\nhttps://regression-status.marklogic.com/new-app/space/diff-archive/b5_0/2013-01-22/linux-64-rh6/diffs/nullTEST-com.marklogic.xcc.TestRetries.txt\r\n\r\nwhich I need to take a look and fix."}, {"time":"2013-01-22T22:32:02.276874-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"128906", "paths":["xcc/branches/b5_0/xcc/src/java/com/marklogic/xcc/impl/handlers/AbstractRequestController.java", "xcc/branches/b5_0/xcc/src/java/com/marklogic/xcc/exceptions/UnexpectedResponseException.java"], "affectedBugs":[]}, "comment":"Bug:20191 - \n1) Added Javadoc for UnexpectedResponseException?.\n2) Fixed a retry test regression. \n"}, {"time":"2013-01-22T22:34:28.957713-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true, "comment":"Added retry and more Javadoc for the subject error.  It broke the TestRetries.java test, and that should be fixed now.  "}, {"time":"2013-01-22T22:34:28.957713-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-23T16:20:04.244974-08:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on Jan 23"}, {"time":"2013-02-25T16:59:23.226221-08:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-02-25T16:59:23.226221-08:00", "fixedAt":"2013-01-22T22:34:28.957713-08:00", "fixedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "shippedAt":"2013-01-23T16:20:04.244974-08:00", "shippedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "closedAt":"2013-02-25T16:59:23.226221-08:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal"}