{"id":20813, "kind":"Bug", "createdAt":"2013-02-18T01:32:27.850516-08:00", "status":"Closed", "title":"Test reverse-path-geospatial-first.xml causing ACCESS_VIOLATION on Windows 7 of 7.0 nightly.", "category":"xdmp", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Test reverse-path-geospatial-first.xml causing ACCESS_VIOLATION on w2k8 7.0 nightly.\r\nMachine : w7-intel64-70-test-1\r\nML Version : 20120217\r\nTest name : reverse-path-geospatial-first.xml\r\nPath to Error Log : C:\\builds\\win64\\HEAD\\logs.20130217.0\\reg-results\r\nPath to result : C:\\builds\\win64\\HEAD\\logs.20130217.0\\reg-results\\results\r\n\r\nError Log : \r\n2013-02-17 07:45:18.563 Debug: Detected indexes for database Triggers: sln\r\n2013-02-17 07:45:18.563 Debug: Detecting compatibility for database Triggers\r\n2013-02-17 07:45:18.563 Debug: Detected compatibility for database Triggers\r\nThread: ACCESS_VIOLATION\r\n#  1 0x000000014129a3b7 in svc::Hash64Table<svc::Handle<xdmp::IndexPath> >::put() (hash.h:781)\r\n#  2 0x00000001412a3e76 in xdmp::IndexPathTable::put() (pathindexes.cpp:1715)\r\n#  3 0x00000001412a429c in xdmp::IndexPathTable::add() (pathindexes.cpp:1636)\r\n#  4 0x0000000140fdfa21 in xdmp::PathGeospatialQueryVal::PathGeospatialQueryVal() (geospatialbuiltins.cpp:13456)\r\n#  5 0x0000000140fdfd58 in xdmp::QueryVal::geoMake() (geospatialbuiltins.cpp:14411)\r\n#  6 0x0000000140595693 in xdmp::QueryVal::make() (searchbuiltins.cpp:59730)\r\n#  7 0x000000014059593c in xdmp::QueryVal::make() (searchbuiltins.cpp:59754)\r\n#  8 0x00000001410acaa0 in xdmp::StandardIndexerEnv<xdmp::SimpleAtomIterator>::push() (indexer.cpp:6519)\r\n#  9 0x00000001410b0a82 in xdmp::IndexerWalker<xdmp::SimpleAtomIterator>::walk() (indexer.cpp:9224)\r\n# 10 0x00000001410b1e0b in xdmp::IndexerWalker<xdmp::SimpleAtomIterator>::walk() (indexer.cpp:9308)\r\n# 11 0x00000001410b414f in xdmp::StandardIndexerEnv<xdmp::SimpleAtomIterator>::putNode() (indexer.cpp:1550)\r\n# 12 0x00000001410b5301 in xdmp::StandardIndexerPostingData::putNode() (indexer.cpp:9383)\r\n# 13 0x00000001418083f8 in xdmp::UpdatePath::fragmentInsert() (updatepath.cpp:318)\r\n# 14 0x00000001409d54ca in xdmp::UpdatePath::documentInsert() (updatebuiltins.cpp:8776)\r\n# 15 0x00000001409f9965 in xdmp::processUpdates() (updatebuiltins.cpp:7554)\r\n# 16 0x0000000141788d7d in xdmp::TransactionSection::commit() (transactionbuiltins.cpp:878)\r\n# 17 0x0000000141789d07 in xdmp::TransactionSection::end() (transactionbuiltins.cpp:863)\r\n# 18 0x00000001418f355d in xdmp::Statement::_eval() (xqueryinterpreter.cpp:1931)\r\n# 19 0x00000001418f7a37 in xdmp::Statement::eval() (xqueryinterpreter.cpp:1790)\r\n# 20 0x00000001418f80ad in xdmp::Program::eval() (xqueryinterpreter.cpp:789)\r\n# 21 0x0000000141887e81 in xdmp::XDBCRequestTask::handleEval() (xdbcserver.cpp:490)\r\n# 22 0x000000014188ff70 in xdmp::XDBCRequestTask::handleRequest() (xdbcserver.cpp:1445)\r\n# 23 0x0000000141890644 in xdmp::XDBCRequestTask::run() (xdbcserver.cpp:1581)\r\n# 24 0x0000000141a70ed6 in svc::PooledThread::run() (threadpool.cpp:146)\r\n# 25 0x0000000141a33fdf in svc::Thread::top() (thread.cpp:284)\r\n# 26 0x0000000141a341e9 in runThread() (thread.cpp:320)\r\n# 27 0x0000000141cf3cc3 in _callthreadstart() (thread.c:295)\r\n# 28 0x0000000141cf3d6d in _threadstart() (thread.c:275)\r\n2013-02-17 07:45:21.766 Critical: Thread: ACCESS_VIOLATION\r\n2013-02-17 07:45:23.500 Notice: Starting MarkLogic Server 7.0-20130217 amd64 in C:\\Program Files\\MarkLogic with data in C:\\Program Files\\MarkLogic\\Data\r\n2013-02-17 07:45:23.625 Info: SSL FIPS mode has been enabled\r\n2013-02-17 07:45:23.625 Debug: Setting trace events for group 12920429953639865555\r\n2013-02-17 07:45:23.625 Debug: Trace events activated flag is false\r\n2013-02-17 07:45:23.625 Debug: Setting audit configuration for group 12920429953639865555\r\n2013-02-17 07:45:23.625 Debug: Audit enabled flag is true\r\n2013-02-17 07:45:23.641 Config: Loading C:\\Program Files\\MarkLogic\\Config\\languages.xml\r\n2013-02-17 07:45:23.641 Config: Loading C:\\Program Files\\MarkLogic\\Config\\calendars.xml", "samplequery":"xquery version \"1.0-ml\";\r\n\txdmp:document-insert(\"/query1.xml\", \r\n        <query>{\r\n\t\tcts:path-geospatial-query(\"point/pos\",cts:point(-90, 100))\r\n\t}", "sampledata":"", "version":"7.0-nightly", "tofixin":"7.0-ea1", "fixedin":"7.0-ea1", "platform":"windows(64-bit)", "memory":"", "processors":"", "note":"Same issue also occurred on w2k8 and Windows 8 of 7.0 nightly", "subscribers":[{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, {"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, {"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}], "attachments":[{"name":"Error Log", "uri":"root/support/bugtracking/attachments/20813/ErrorLog.txt"}], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["xdmp", "sanand"], "changeHistory":[{"time":"2013-02-18T01:32:27.850516-08:00", "updatedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "to":{"username":"rhu", "name":"Ron Hu", "email":"ron.hu@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-18T05:56:21.746282-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-18T07:30:35.417991-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"132271", "paths":["xdmp/trunk/src/GeospatialBuiltins.cpp"], "affectedBugs":[]}, "comment":"Fix for bug:20813.\n"}, {"time":"2013-02-18T07:32:22.889907-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Here is the correct test. The above query misses a closing tag and right paren.\r\n\r\n xdmp:document-insert(\"/query1.xml\",\r\n        <query>{\r\n  cts:path-geospatial-query(\"point/pos\",cts:point(-90, 100))\r\n }</query>)"}, {"time":"2013-02-18T07:32:22.889907-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-18T08:33:52.507198-08:00", "updatedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "to":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-03-06T02:19:08.782183-08:00", "updatedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 20130303 - 20130305. This issue is no more producible, hence shipping it."}, {"time":"2013-03-06T02:19:08.782183-08:00", "updatedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "change":{"assignTo":{"from":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-03-06T02:19:08.782183-08:00", "fixedAt":"2013-02-18T08:33:52.507198-08:00", "fixedBy":{"username":"gchinchwadkar", "name":"Gajanan Chinchwadkar", "email":"Gajanan.Chinchwadkar@marklogic.com"}, "shippedAt":"2013-03-06T02:19:08.782183-08:00", "shippedBy":{"username":"sanand", "name":"Sumit Anand", "email":"Sumit.Anand@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}