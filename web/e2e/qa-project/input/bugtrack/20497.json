{"id":20497, "kind":"Bug", "createdAt":"2013-01-17T08:25:08.25281-08:00", "status":"Will not fix", "title":"Schema validation, at least in copy-on-validate mode, ought to add default/fixed attributes", "category":"Validation", "severity":"Major", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"Currently default and fixed attributes are only added to the data model when XML is parsed. \r\nIf the XML is constructed, they will not be added (OK), even when the instance is validated (not OK).\r\nWe validate in place, usually, for performance and we can't add attributes to an existing data\r\nmodel instance. However, when we validate with a copy, we should add them.\r\n\r\nThat is, given this schema:\r\n<xs:schema targetNamespace=\"example\"\r\n           xmlns=\"example\"\r\n           xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\r\n\r\n  <xs:element name=\"example\">\r\n    <xs:complexType>\r\n      <xs:sequence/>\r\n      <xs:attribute name=\"default\" default=\"default value\"/>\r\n      <xs:attribute name=\"fixed\" fixed=\"fixed value\"/>\r\n    </xs:complexType>\r\n  </xs:element>\r\n</xs:schema>\r\n\r\nAnd this document df.xml: <example xmlns=\"example\"/>\r\n\r\nThis query should give the default and fixed attributes both times, but it only does in the first case:\r\ndeclare option xdmp:output \"default-attributes=yes\";\r\ndeclare option xdmp:copy-on-validate \"true\";\r\nxdmp:document-get(\"df.xml\"), validate strict { <example xmlns=\"example\"/> }\r\n", "samplequery":"", "sampledata":"", "version":"7.0-nightly", "tofixin":"8.0-1", "fixedin":"N/A", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[], "cloneOf":"", "support":{"headline":"", "supportDescription":"", "publishStatus":"Not Ready", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":""}, "tags":["Validation", "mary"], "changeHistory":[{"time":"2013-01-17T08:25:08.25281-08:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}}}, "files":[], "show":true}, {"time":"2013-05-20T09:08:48.407774-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{}, "files":[], "show":true, "comment":"Recommend pushing to 8.0-1"}, {"time":"2013-06-24T07:39:59.063396-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"tofixin":{"from":"7.0-1", "to":"8.0-1"}}, "files":[], "show":true}, {"time":"2014-08-13T14:57:18.065889-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"status":{"from":"Verify", "to":"Will not fix"}, "assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Not happening."}, {"time":"2014-08-13T14:57:18.065889-07:00", "updatedBy":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "change":{"assignTo":{"from":{"username":"mary", "name":"Mary Holstege", "email":"mary@cerisent.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2014-08-13T14:57:18.065889-07:00", "renderDescriptionAs":"normal"}