{"id":20645, "kind":"Bug", "createdAt":"2013-01-30T11:37:47.364781-08:00", "status":"Closed", "title":"MLCP not always loading all items in aggregate documents ", "category":"mlcp", "severity":"Critical", "priority":{"level":"5", "title":""}, "submittedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "assignTo":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}, "description":"From std out when this test is run in a clustered environment I can see dead locks and  com.marklogic.io.ResourcePool closeExpired errors: \r\n\r\nWed Jan 30 03:37:26 PST 2013: creating threads...\r\nWed Jan 30 03:37:26 PST 2013: starting...\r\nrunning following shell command: /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/runmlcp.sh /space/builder/builds/linux64-rh5.4/b5_0/qa import -username admin -password admin -host localhost -port 5275 -input_file_path /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/data/agg/medline -input_file_type aggregates -output_directory \"/dir1\"\r\nstderr/out from shell cmd: 2013-01-30\r\nstderr/out from shell cmd: drwxrwxrwx 5 builder builder 4096 2013-01-30 03:27:07.260478736 -0800 marklogic-contentpump\r\nstderr/out from shell cmd: directory exists\r\nstderr/out from shell cmd: however, it was created today\r\nstderr/out from shell cmd: data/xml/bigdata directory exists.\r\nstderr/out from shell cmd: 13/01/30 03:37:32 INFO contentpump.LocalJobRunner: Content type: XML\r\nstderr/out from shell cmd: 13/01/30 03:37:32 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=\r\nstderr/out from shell cmd: 13/01/30 03:37:32 INFO input.FileInputFormat: Total input paths to process : 2\r\nstderr/out from shell cmd: 13/01/30 03:37:32 INFO mapreduce.ContentOutputFormat: Running in fast load mode\r\nstderr/out from shell cmd: 13/01/30 03:37:33 INFO contentpump.LocalJobRunner:  completed 0%\r\nstderr/out from shell cmd: 13/01/30 03:37:34 INFO contentpump.LocalJobRunner:  completed 2%\r\nstderr/out from shell cmd: 13/01/30 03:37:35 INFO contentpump.LocalJobRunner:  completed 5%\r\nstderr/out from shell cmd: 13/01/30 03:37:36 INFO contentpump.LocalJobRunner:  completed 9%\r\nstderr/out from shell cmd: 13/01/30 03:37:37 INFO contentpump.LocalJobRunner:  completed 12%\r\nstderr/out from shell cmd: 13/01/30 03:37:38 INFO contentpump.LocalJobRunner:  completed 16%\r\nstderr/out from shell cmd: 13/01/30 03:37:39 INFO contentpump.LocalJobRunner:  completed 21%\r\nstderr/out from shell cmd: 13/01/30 03:37:40 INFO contentpump.LocalJobRunner:  completed 24%\r\nstderr/out from shell cmd: 13/01/30 03:37:41 INFO contentpump.LocalJobRunner:  completed 28%\r\nstderr/out from shell cmd: Jan 30, 2013 3:37:42 AM com.marklogic.io.ResourcePool closeExpired\r\nstderr/out from shell cmd: INFO: Closed 1 expired items.\r\nstderr/out from shell cmd: 13/01/30 03:37:42 INFO contentpump.LocalJobRunner:  completed 32%\r\nstderr/out from shell cmd: 13/01/30 03:37:43 INFO contentpump.LocalJobRunner:  completed 36%\r\nstderr/out from shell cmd: 13/01/30 03:37:44 INFO contentpump.LocalJobRunner:  completed 39%\r\nstderr/out from shell cmd: 13/01/30 03:37:45 INFO contentpump.LocalJobRunner:  completed 43%\r\nstderr/out from shell cmd: 13/01/30 03:37:46 INFO contentpump.LocalJobRunner:  completed 47%\r\nstderr/out from shell cmd: 13/01/30 03:37:47 INFO contentpump.LocalJobRunner:  completed 51%\r\nstderr/out from shell cmd: 13/01/30 03:37:48 INFO contentpump.LocalJobRunner:  completed 55%\r\nstderr/out from shell cmd: 13/01/30 03:37:49 INFO contentpump.LocalJobRunner:  completed 59%\r\nstderr/out from shell cmd: 13/01/30 03:37:50 INFO contentpump.LocalJobRunner:  completed 63%\r\nstderr/out from shell cmd: 13/01/30 03:37:51 INFO contentpump.LocalJobRunner:  completed 66%\r\nstderr/out from shell cmd: 13/01/30 03:37:52 INFO contentpump.LocalJobRunner:  completed 68%\r\nstderr/out from shell cmd: 13/01/30 03:37:53 INFO contentpump.LocalJobRunner:  completed 71%\r\nstderr/out from shell cmd: 13/01/30 03:37:54 INFO contentpump.LocalJobRunner:  completed 74%\r\nstderr/out from shell cmd: 13/01/30 03:37:55 INFO contentpump.LocalJobRunner:  completed 77%\r\nstderr/out from shell cmd: 13/01/30 03:37:56 INFO contentpump.LocalJobRunner:  completed 80%\r\nstderr/out from shell cmd: 13/01/30 03:37:57 INFO contentpump.LocalJobRunner:  completed 83%\r\nstderr/out from shell cmd: 13/01/30 03:37:58 INFO contentpump.LocalJobRunner:  completed 85%\r\nstderr/out from shell cmd: 13/01/30 03:37:59 INFO contentpump.LocalJobRunner:  completed 88%\r\nstderr/out from shell cmd: 13/01/30 03:38:00 INFO contentpump.LocalJobRunner:  completed 90%\r\nstderr/out from shell cmd: 13/01/30 03:38:01 INFO contentpump.LocalJobRunner:  completed 93%\r\nstderr/out from shell cmd: 13/01/30 03:38:02 INFO contentpump.LocalJobRunner:  completed 96%\r\nstderr/out from shell cmd: 13/01/30 03:38:03 INFO contentpump.LocalJobRunner:  completed 99%\r\nstderr/out from shell cmd: 13/01/30 03:38:04 INFO contentpump.LocalJobRunner: com.marklogic.contentpump.ContentPumpStats: \r\nstderr/out from shell cmd: 13/01/30 03:38:04 INFO contentpump.LocalJobRunner: ATTEMPTED_INPUT_RECORD_COUNT: 32476\r\nstderr/out from shell cmd: 13/01/30 03:38:04 INFO contentpump.LocalJobRunner: SKIPPED_INPUT_RECORD_COUNT: 0\r\nstderr/out from shell cmd: 13/01/30 03:38:04 INFO contentpump.LocalJobRunner: Total execution time: 31 sec\r\nrunning following shell command: /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/runmlcp.sh /space/builder/builds/linux64-rh5.4/b5_0/qa import -username admin -password admin -host localhost -port 5275 -input_file_path /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/data/agg/medline -input_file_type aggregates -output_directory \"/dir2\"\r\nstderr/out from shell cmd: 2013-01-30\r\nstderr/out from shell cmd: drwxrwxrwx 5 builder builder 4096 2013-01-30 03:27:07.260478736 -0800 marklogic-contentpump\r\nstderr/out from shell cmd: directory exists\r\nstderr/out from shell cmd: however, it was created today\r\nstderr/out from shell cmd: data/xml/bigdata directory exists.\r\nstderr/out from shell cmd: 13/01/30 03:38:05 INFO contentpump.LocalJobRunner: Content type: XML\r\nstderr/out from shell cmd: 13/01/30 03:38:05 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=\r\nstderr/out from shell cmd: 13/01/30 03:38:05 INFO input.FileInputFormat: Total input paths to process : 2\r\nstderr/out from shell cmd: 13/01/30 03:38:05 INFO mapreduce.ContentOutputFormat: Running in fast load mode\r\nstderr/out from shell cmd: 13/01/30 03:38:07 INFO contentpump.LocalJobRunner:  completed 1%\r\nstderr/out from shell cmd: 13/01/30 03:38:08 INFO contentpump.LocalJobRunner:  completed 3%\r\nstderr/out from shell cmd: 13/01/30 03:38:09 INFO contentpump.LocalJobRunner:  completed 7%\r\nstderr/out from shell cmd: 13/01/30 03:38:10 INFO contentpump.LocalJobRunner:  completed 10%\r\nstderr/out from shell cmd: 13/01/30 03:38:11 INFO contentpump.LocalJobRunner:  completed 14%\r\nstderr/out from shell cmd: 13/01/30 03:38:12 INFO contentpump.LocalJobRunner:  completed 18%\r\nstderr/out from shell cmd: 13/01/30 03:38:13 INFO contentpump.LocalJobRunner:  completed 22%\r\nstderr/out from shell cmd: 13/01/30 03:38:14 INFO contentpump.LocalJobRunner:  completed 26%\r\nstderr/out from shell cmd: 13/01/30 03:38:15 INFO contentpump.LocalJobRunner:  completed 30%\r\nstderr/out from shell cmd: Jan 30, 2013 3:38:15 AM com.marklogic.io.ResourcePool closeExpired\r\nstderr/out from shell cmd: INFO: Closed 1 expired items.\r\nstderr/out from shell cmd: 13/01/30 03:38:16 INFO contentpump.LocalJobRunner:  completed 34%\r\nstderr/out from shell cmd: 13/01/30 03:38:17 INFO contentpump.LocalJobRunner:  completed 37%\r\nstderr/out from shell cmd: 13/01/30 03:38:18 INFO contentpump.LocalJobRunner:  completed 41%\r\nstderr/out from shell cmd: 13/01/30 03:38:19 INFO contentpump.LocalJobRunner:  completed 45%\r\nstderr/out from shell cmd: 13/01/30 03:38:20 INFO contentpump.LocalJobRunner:  completed 49%\r\nstderr/out from shell cmd: 13/01/30 03:38:21 INFO contentpump.LocalJobRunner:  completed 53%\r\nstderr/out from shell cmd: 13/01/30 03:38:22 INFO contentpump.LocalJobRunner:  completed 56%\r\nstderr/out from shell cmd: 13/01/30 03:38:23 INFO contentpump.LocalJobRunner:  completed 61%\r\nstderr/out from shell cmd: 13/01/30 03:38:24 INFO contentpump.LocalJobRunner:  completed 64%\r\nstderr/out from shell cmd: 13/01/30 03:38:25 INFO contentpump.LocalJobRunner:  completed 67%\r\nstderr/out from shell cmd: 13/01/30 03:38:26 INFO contentpump.LocalJobRunner:  completed 70%\r\nstderr/out from shell cmd: 13/01/30 03:38:27 INFO contentpump.LocalJobRunner:  completed 73%\r\nstderr/out from shell cmd: 13/01/30 03:38:28 INFO contentpump.LocalJobRunner:  completed 75%\r\nstderr/out from shell cmd: 13/01/30 03:38:29 INFO contentpump.LocalJobRunner:  completed 78%\r\nstderr/out from shell cmd: 13/01/30 03:38:30 INFO contentpump.LocalJobRunner:  completed 81%\r\nstderr/out from shell cmd: 13/01/30 03:38:31 INFO contentpump.LocalJobRunner:  completed 84%\r\nstderr/out from shell cmd: 13/01/30 03:38:32 INFO contentpump.LocalJobRunner:  completed 87%\r\nstderr/out from shell cmd: 13/01/30 03:38:33 INFO contentpump.LocalJobRunner:  completed 89%\r\nstderr/out from shell cmd: 13/01/30 03:38:34 INFO contentpump.LocalJobRunner:  completed 92%\r\nstderr/out from shell cmd: 13/01/30 03:38:35 INFO contentpump.LocalJobRunner:  completed 95%\r\nstderr/out from shell cmd: 13/01/30 03:38:36 INFO contentpump.LocalJobRunner:  completed 97%\r\nstderr/out from shell cmd: 13/01/30 03:38:37 INFO contentpump.LocalJobRunner:  completed 99%\r\nstderr/out from shell cmd: 13/01/30 03:38:37 INFO contentpump.LocalJobRunner: com.marklogic.contentpump.ContentPumpStats: \r\nstderr/out from shell cmd: 13/01/30 03:38:37 INFO contentpump.LocalJobRunner: ATTEMPTED_INPUT_RECORD_COUNT: 32476\r\nstderr/out from shell cmd: 13/01/30 03:38:37 INFO contentpump.LocalJobRunner: SKIPPED_INPUT_RECORD_COUNT: 0\r\nstderr/out from shell cmd: 13/01/30 03:38:37 INFO contentpump.LocalJobRunner: Total execution time: 31 sec\r\nrunning following shell command: /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/runmlcp.sh /space/builder/builds/linux64-rh5.4/b5_0/qa import -username admin -password admin -host localhost -port 5275 -input_file_path /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/data/agg/medline -input_file_type aggregates -output_directory \"/dir3\"\r\nstderr/out from shell cmd: 2013-01-30\r\nstderr/out from shell cmd: drwxrwxrwx 5 builder builder 4096 2013-01-30 03:27:07.260478736 -0800 marklogic-contentpump\r\nstderr/out from shell cmd: directory exists\r\nstderr/out from shell cmd: however, it was created today\r\nstderr/out from shell cmd: data/xml/bigdata directory exists.\r\nstderr/out from shell cmd: 13/01/30 03:38:39 INFO contentpump.LocalJobRunner: Content type: XML\r\nstderr/out from shell cmd: 13/01/30 03:38:39 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=\r\nstderr/out from shell cmd: 13/01/30 03:38:39 INFO input.FileInputFormat: Total input paths to process : 2\r\nstderr/out from shell cmd: 13/01/30 03:38:39 INFO mapreduce.ContentOutputFormat: Running in fast load mode\r\nstderr/out from shell cmd: 13/01/30 03:38:40 INFO contentpump.LocalJobRunner:  completed 1%\r\nstderr/out from shell cmd: 13/01/30 03:38:41 INFO contentpump.LocalJobRunner:  completed 3%\r\nstderr/out from shell cmd: 13/01/30 03:38:42 INFO contentpump.LocalJobRunner:  completed 7%\r\nstderr/out from shell cmd: 13/01/30 03:38:43 INFO contentpump.LocalJobRunner:  completed 11%\r\nstderr/out from shell cmd: 13/01/30 03:38:44 INFO contentpump.LocalJobRunner:  completed 14%\r\nstderr/out from shell cmd: 13/01/30 03:38:45 INFO contentpump.LocalJobRunner:  completed 18%\r\nstderr/out from shell cmd: 13/01/30 03:38:46 INFO contentpump.LocalJobRunner:  completed 22%\r\nstderr/out from shell cmd: 13/01/30 03:38:47 INFO contentpump.LocalJobRunner:  completed 26%\r\nstderr/out from shell cmd: 13/01/30 03:38:48 INFO contentpump.LocalJobRunner:  completed 30%\r\nstderr/out from shell cmd: Jan 30, 2013 3:38:49 AM com.marklogic.io.ResourcePool closeExpired\r\nstderr/out from shell cmd: INFO: Closed 1 expired items.\r\nstderr/out from shell cmd: 13/01/30 03:38:49 INFO contentpump.LocalJobRunner:  completed 34%\r\nstderr/out from shell cmd: 13/01/30 03:38:50 INFO contentpump.LocalJobRunner:  completed 38%\r\nstderr/out from shell cmd: 13/01/30 03:38:51 INFO contentpump.LocalJobRunner:  completed 41%\r\nstderr/out from shell cmd: 13/01/30 03:38:52 INFO contentpump.LocalJobRunner:  completed 46%\r\nstderr/out from shell cmd: 13/01/30 03:38:53 INFO contentpump.LocalJobRunner:  completed 50%\r\nstderr/out from shell cmd: 13/01/30 03:38:54 INFO contentpump.LocalJobRunner:  completed 53%\r\nstderr/out from shell cmd: 13/01/30 03:38:55 INFO contentpump.LocalJobRunner:  completed 56%\r\nstderr/out from shell cmd: 13/01/30 03:38:56 INFO contentpump.LocalJobRunner:  completed 60%\r\nstderr/out from shell cmd: 13/01/30 03:38:57 INFO contentpump.LocalJobRunner:  completed 64%\r\nstderr/out from shell cmd: 13/01/30 03:38:58 INFO contentpump.LocalJobRunner:  completed 67%\r\nstderr/out from shell cmd: 13/01/30 03:38:59 INFO contentpump.LocalJobRunner:  completed 70%\r\nstderr/out from shell cmd: 13/01/30 03:39:00 INFO contentpump.LocalJobRunner:  completed 72%\r\nstderr/out from shell cmd: 13/01/30 03:39:01 INFO contentpump.LocalJobRunner:  completed 75%\r\nstderr/out from shell cmd: 13/01/30 03:39:02 INFO contentpump.LocalJobRunner:  completed 78%\r\nstderr/out from shell cmd: 13/01/30 03:39:03 INFO contentpump.LocalJobRunner:  completed 81%\r\nstderr/out from shell cmd: 13/01/30 03:39:04 INFO contentpump.LocalJobRunner:  completed 84%\r\nstderr/out from shell cmd: 13/01/30 03:39:05 INFO contentpump.LocalJobRunner:  completed 86%\r\nstderr/out from shell cmd: 13/01/30 03:39:06 INFO contentpump.LocalJobRunner:  completed 89%\r\nstderr/out from shell cmd: 13/01/30 03:39:07 INFO contentpump.LocalJobRunner:  completed 91%\r\nstderr/out from shell cmd: 13/01/30 03:39:08 INFO contentpump.LocalJobRunner:  completed 94%\r\nstderr/out from shell cmd: 13/01/30 03:39:09 INFO contentpump.LocalJobRunner:  completed 97%\r\nstderr/out from shell cmd: 13/01/30 03:39:10 INFO contentpump.LocalJobRunner:  completed 99%\r\nstderr/out from shell cmd: 13/01/30 03:39:10 INFO contentpump.LocalJobRunner: com.marklogic.contentpump.ContentPumpStats: \r\nstderr/out from shell cmd: 13/01/30 03:39:10 INFO contentpump.LocalJobRunner: ATTEMPTED_INPUT_RECORD_COUNT: 32476\r\nstderr/out from shell cmd: 13/01/30 03:39:10 INFO contentpump.LocalJobRunner: SKIPPED_INPUT_RECORD_COUNT: 0\r\nstderr/out from shell cmd: 13/01/30 03:39:10 INFO contentpump.LocalJobRunner: Total execution time: 31 sec\r\nrunning following shell command: mkdir /space/builder/builds/linux64-rh5.4/b5_0/logs.20130130.1/reg-results/tmp/bug17845\r\nrunning following shell command: /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/runmlcp.sh /space/builder/builds/linux64-rh5.4/b5_0/qa export -username admin -password admin -host localhost -port 5275 -copy_collections true -copy_permissions true -copy_properties true -copy_quality true -output_type archive -output_file_path /space/builder/builds/linux64-rh5.4/b5_0/logs.20130130.1/reg-results/tmp/bug17845/export1 -thread_count 5\r\n\r\nstderr/out from shell cmd: 2013-01-30\r\nstderr/out from shell cmd: drwxrwxrwx 5 builder builder 4096 2013-01-30 03:27:07.260478736 -0800 marklogic-contentpump\r\nstderr/out from shell cmd: directory exists\r\nstderr/out from shell cmd: however, it was created today\r\nstderr/out from shell cmd: data/xml/bigdata directory exists.\r\nstderr/out from shell cmd: 13/01/30 03:39:16 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=\r\nstderr/out from shell cmd: 13/01/30 03:39:16 INFO mapreduce.MarkLogicInputFormat: Fetched 2 forest splits.\r\nstderr/out from shell cmd: 13/01/30 03:39:16 INFO mapreduce.MarkLogicInputFormat: Made 2 splits.\r\nstderr/out from shell cmd: 13/01/30 03:39:17 INFO contentpump.LocalJobRunner:  completed 0%\r\nstderr/out from shell cmd: Jan 30, 2013 3:39:26 AM com.marklogic.io.ResourcePool closeExpired\r\nstderr/out from shell cmd: INFO: Closed 1 expired items.\r\nstderr/out from shell cmd: 13/01/30 03:39:28 INFO contentpump.OutputArchive: Creating output archive: /space/builder/builds/linux64-rh5.4/b5_0/logs.20130130.1/reg-results/tmp/bug17845/export1/20130130033928-0800-000000-XML.zip\r\nstderr/out from shell cmd: 13/01/30 03:39:28 INFO contentpump.OutputArchive: Creating output archive: /space/builder/builds/linux64-rh5.4/b5_0/logs.20130130.1/reg-results/tmp/bug17845/export1/20130130033928-0800-000001-XML.zip\r\nstderr/out from shell cmd: 13/01/30 03:39:29 INFO contentpump.LocalJobRunner:  completed 1%\r\nstderr/out from shell cmd: 13/01/30 03:39:30 INFO contentpump.LocalJobRunner:  completed 4%\r\nstderr/out from shell cmd: 13/01/30 03:39:31 INFO contentpump.LocalJobRunner:  completed 7%\r\nstderr/out from shell cmd: 13/01/30 03:39:32 INFO contentpump.LocalJobRunner:  completed 11%\r\nstderr/out from shell cmd: 13/01/30 03:39:33 INFO contentpump.LocalJobRunner:  completed 15%\r\nstderr/out from shell cmd: 13/01/30 03:39:34 INFO contentpump.LocalJobRunner:  completed 20%\r\nstderr/out from shell cmd: 13/01/30 03:39:35 INFO contentpump.LocalJobRunner:  completed 24%\r\nstderr/out from shell cmd: 13/01/30 03:39:36 INFO contentpump.LocalJobRunner:  completed 28%\r\nstderr/out from shell cmd: 13/01/30 03:39:37 INFO contentpump.LocalJobRunner:  completed 33%\r\nstderr/out from shell cmd: 13/01/30 03:39:38 INFO contentpump.LocalJobRunner:  completed 37%\r\nstderr/out from shell cmd: 13/01/30 03:39:39 INFO contentpump.LocalJobRunner:  completed 42%\r\nstderr/out from shell cmd: 13/01/30 03:39:40 INFO contentpump.LocalJobRunner:  completed 46%\r\nstderr/out from shell cmd: 13/01/30 03:39:41 INFO contentpump.LocalJobRunner:  completed 51%\r\nstderr/out from shell cmd: 13/01/30 03:39:42 INFO contentpump.LocalJobRunner:  completed 55%\r\nstderr/out from shell cmd: 13/01/30 03:39:43 INFO contentpump.LocalJobRunner:  completed 60%\r\nstderr/out from shell cmd: 13/01/30 03:39:44 INFO contentpump.LocalJobRunner:  completed 64%\r\nstderr/out from shell cmd: 13/01/30 03:39:45 INFO contentpump.LocalJobRunner:  completed 69%\r\nstderr/out from shell cmd: 13/01/30 03:39:46 INFO contentpump.LocalJobRunner:  completed 73%\r\nstderr/out from shell cmd: 13/01/30 03:39:47 INFO contentpump.LocalJobRunner:  completed 78%\r\nstderr/out from shell cmd: 13/01/30 03:39:48 INFO contentpump.LocalJobRunner:  completed 83%\r\nstderr/out from shell cmd: 13/01/30 03:39:49 INFO contentpump.LocalJobRunner:  completed 87%\r\nstderr/out from shell cmd: 13/01/30 03:39:50 INFO contentpump.LocalJobRunner:  completed 91%\r\nstderr/out from shell cmd: 13/01/30 03:39:51 INFO contentpump.LocalJobRunner:  completed 96%\r\nstderr/out from shell cmd: 13/01/30 03:39:52 INFO contentpump.LocalJobRunner:  completed 99%\r\nstderr/out from shell cmd: 13/01/30 03:39:53 INFO contentpump.LocalJobRunner:  completed 100%\r\nstderr/out from shell cmd: 13/01/30 03:40:03 INFO contentpump.LocalJobRunner: com.marklogic.contentpump.ContentPumpStats: \r\nstderr/out from shell cmd: 13/01/30 03:40:03 INFO contentpump.LocalJobRunner: ATTEMPTED_INPUT_RECORD_COUNT: 194856\r\nstderr/out from shell cmd: 13/01/30 03:40:03 INFO contentpump.LocalJobRunner: SKIPPED_INPUT_RECORD_COUNT: 0\r\nstderr/out from shell cmd: 13/01/30 03:40:03 INFO contentpump.LocalJobRunner: Total execution time: 46 sec\r\nrunning following shell command: /space/builder/builds/linux64-rh5.4/b5_0/qa/mlcp/runmlcp.sh /space/builder/builds/linux64-rh5.4/b5_0/qa import -username admin -password admin -host localhost -port 5275 -copy_collections true -copy_permissions true -copy_properties true -copy_quality true -input_file_path /space/builder/builds/linux64-rh5.4/b5_0/logs.20130130.1/reg-results/tmp/bug17845 -input_file_type archive\r\n\r\nstderr/out from shell cmd: 2013-01-30\r\nstderr/out from shell cmd: drwxrwxrwx 5 builder builder 4096 2013-01-30 03:27:07.260478736 -0800 marklogic-contentpump\r\nstderr/out from shell cmd: directory exists\r\nstderr/out from shell cmd: however, it was created today\r\nstderr/out from shell cmd: data/xml/bigdata directory exists.\r\nstderr/out from shell cmd: 13/01/30 03:40:05 INFO contentpump.LocalJobRunner: Content type: XML\r\nstderr/out from shell cmd: 13/01/30 03:40:05 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=\r\nstderr/out from shell cmd: 13/01/30 03:40:05 INFO input.FileInputFormat: Total input paths to process : 1\r\nstderr/out from shell cmd: 13/01/30 03:40:06 INFO contentpump.LocalJobRunner:  completed 0%\r\nstderr/out from shell cmd: 13/01/30 03:40:08 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest #2100171885223584270\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: Jan 30, 2013 3:40:15 AM com.marklogic.io.ResourcePool closeExpired\r\nstderr/out from shell cmd: INFO: Closed 1 expired items.\r\nstderr/out from shell cmd: 13/01/30 03:40:39 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:40:45 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:40:49 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:40:56 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:41:03 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:41:11 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:41:37 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:41:45 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:41:52 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:42:03 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:42:15 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:42:39 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:42:45 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:42:54 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:43:30 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:43:49 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:44:03 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:44:23 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:44:31 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:44:47 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:44:59 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:45:19 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:45:25 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:45:32 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:46:00 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:46:16 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:46:35 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:46:42 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:46:49 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:47:11 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:47:19 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:47:36 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:47:50 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:48:16 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:48:20 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:48:31 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:48:40 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:48:55 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:49:15 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-test-1.marklogic.com/172.18.9.121:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:49:33 ERROR contentpump.DatabaseContentWriter: com.marklogic.xcc.exceptions.RetryableXQueryException: XDMP-DEADLOCK: Deadlock detected locking bug17845F1-dest /\r\nstderr/out from shell cmd:  [Session: user=admin, cb={default} [ContentSource: user=admin, cb={none} [provider: address=rh54-intel64-43-build.marklogic.com/172.18.10.101:5275, pool=0/64]]]\r\nstderr/out from shell cmd:  [Client: XCC/6.0-20130121, Server: XDBC/5.0-20130130]\r\nstderr/out from shell cmd: 13/01/30 03:49:38 INFO contentpump.LocalJobRunner:  completed 50%\r\nstderr/out from shell cmd: 13/01/30 03:49:44 INFO contentpump.LocalJobRunner:  completed 100%\r\nstderr/out from shell cmd: 13/01/30 03:49:44 INFO contentpump.LocalJobRunner: com.marklogic.contentpump.ContentPumpStats: \r\nstderr/out from shell cmd: 13/01/30 03:49:44 INFO contentpump.LocalJobRunner: ATTEMPTED_INPUT_RECORD_COUNT: 97428\r\nstderr/out from shell cmd: 13/01/30 03:49:44 INFO contentpump.LocalJobRunner: SKIPPED_INPUT_RECORD_COUNT: 0\r\nstderr/out from shell cmd: 13/01/30 03:49:44 INFO contentpump.LocalJobRunner: Total execution time: 579 sec\r\nrunning following shell command: rm -rf /space/builder/builds/linux64-rh5.4/b5_0/logs.20130130.1/reg-results/tmp/bug17845\r\nWed Jan 30 03:49:55 PST 2013: Reporting results...\r\nWed Jan 30 03:49:55 PST 2013: Writing results to /space/builder/builds/linux64-rh5.4/b5_0/qa/scripts/results/bug17845.xml\r\nbug17845.xml : Failed\r\n\r\n", "samplequery":"make ut tname=bug17845.xml", "sampledata":"", "version":"6.0-1", "tofixin":"6.0-3", "fixedin":"6.0-3", "platform":"all", "memory":"", "processors":"", "note":"", "subscribers":[{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, {"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, {"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}], "attachments":[], "relationships":[{"type":"", "to":""}], "clones":[20956, 20960], "cloneOf":"", "support":{"headline":"Occasionally, MLCP does not load all items in aggregate documents", "supportDescription":"If aggregate_uri_id is not specified, it is possible that some documents in different aggregate documents have the same uri, resulting in missing documents after loading documents with mlcp", "publishStatus":"Publish", "tickets":[], "customerImpact":{"level":"N/A", "title":""}, "workaround":"Specify aggregate_uri_id in mlcp command"}, "tags":["mlcp", "lratcliff"], "changeHistory":[{"time":"2013-01-30T11:37:47.364781-08:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-30T11:39:35.698822-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-01-30T11:44:02.713023-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Why \"to fix in\" is set to 5.0.5? Do we have a release of mlcp for ML 5?"}, {"time":"2013-01-30T15:02:00.800513-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"\"com.marklogic.io.ResourcePool closeExpired \" happens if keep alive timeout is 5.\r\nSet it to 0 solves the problem. My impression is there has been code changes for the keep alive timeout in trunk. \r\n\r\nI have tried the qa tests against a 7.0 nightly, haven't seen \"com.marklogic.io.ResourcePool closeExpired \".\r\n\r\nMy guess is the code for keep alive timeout on ML 5 causes \"com.marklogic.io.ResourcePool closeExpired\"."}, {"time":"2013-01-30T15:04:22.488223-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Larry mentioned XDMP-DEADLOCK happened when mlcp ran against on a ML 5 cluster. \r\nNeither he nor I can reproduce XDMP-DEADLOCK on a single node."}, {"time":"2013-01-30T15:11:55.48777-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Larry,\r\n\r\nIt seems bug17845DB-dest database is using \"automatic\" directory creation, which generates naked properties when documents are ingested. Meanwhile, the archive generated also has properties information, which may also contain naked properties.\r\nMaybe the naked properties in the archive to be ingested compete with the naked properties to be generated by the database.\r\n\r\nPlease set the directory creation to \"manual\" for db bug17845DB-dest, and rerun the test in the ML 5 cluster."}, {"time":"2013-01-30T15:34:24.828912-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Update your XCC jar if you see the \"closeExpired\" message. "}, {"time":"2013-01-30T16:21:39.184578-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Setting directory creation to \"manual\" makes the XDMP-DEADLOCK disappear for ML5. Larry mentioned this happens on ML 6 sometimes, whose setting for directory creation is \"manual\" by default.\r\n\r\nNeed more effort to find out the root cause."}, {"time":"2013-01-31T09:36:09.882137-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"The ATTEMPTED_INPUT_RECORD_COUNT reports the expected number of records.  The count taken on the database is through xdmp:estimate().  No errors found in the MarkLogic 6 error log.  Can only be reproduced on a cluster.\r\n\r\nWe added more info in the tests to debug this in the regression.  "}, {"time":"2013-02-01T10:22:17.584662-08:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Interesting data point from a windows single node: \r\nxquery version \"1.0-ml\";\r\n        (<est>{xdmp:estimate(//MedlineCitation)}</est>,\r\n         <count>{fn:count(//MedlineCitation)}</count>,\r\n         <dir>{xdmp:estimate(xdmp:directory(\"/dir1/\", \"infinity\"))}</dir>)\r\n==> \r\n  <est>16238</est><count>16238</count><dir>16238</dir>\r\n<est>32476</est><count>32476</count><dir>32476</dir>"}, {"time":"2013-02-01T10:54:18.001779-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Since the mlcp command used didn't specify aggregate_uri_id, mlcp will generate the uri as HASH_OF_SPLIT-AtomicInteger.\r\nThe AtomicIntegers generated within a split should be sequential and unique. \r\nIs it possible to get all the uris in the database?"}, {"time":"2013-02-01T13:36:34.219902-08:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Added more debugging info to the test. It turns out for the same document the hash value for the document changes within the same 1 document load. When that happens it restarts the sequential number. Evidence of that was captured by logging the uris to the error log. That error log is at : /home/lratcliff/20645/ErrorLog.txt\r\n\r\nIf you search for 9999 in that log you will see where that happens. "}, {"time":"2013-02-01T14:16:59.773237-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"there are 2 files per mlcp import, so the different hash values are expected.\r\nLarry is adding more log to help diagnosis.\r\nI am trying to reproduce it on a 3-node cluster."}, {"time":"2013-02-01T16:57:19.968796-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Assuming that this is only seen in Aggregates and only in local mode, I'd suggest the following:\r\n\r\nIn LocalIdGenerator, maintain a ConcurrentHashMap and put in the id generated each time incrementAndGet is called.  When reader is closed, log the size of the HashMap.\r\n\r\nWe need to check it in and watch the regression"}, {"time":"2013-02-01T22:59:47.015191-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"130339", "paths":["xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/AggregateXMLReader.java", "xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/utilities/LocalIdGenerator.java"], "affectedBugs":[]}, "comment":"Bug:20645\ntemporary code to track the number of distinct uris generated using ConcurrentHashMap\nWe can take a look at INFO level log \"URI_MAP_SIZE\" in tomorrow's regression report."}, {"time":"2013-02-03T10:04:08.550806-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"After adding logging for URI_MAP_SIZE in b6_0, INFO level log for \"URI_MAP_SIZE\" shows in b6_0 regression log, however, it doesn't show in the b5_0 regression log on the machine where bug17845 fails(\r\nsee https://regression-status.marklogic.com/new-app/space/diff-archive/b5_0/2013-02-03/winnt-64-w2k3/qa-stdout.txt.Split1.txt).\r\n\r\nI don't see mlcp exists in xcc b5_0 branche. So, I guess the the regression suite copies the mlcp from b6_0 into b5_0 so as to run mlcp regression for b5_0 server.\r\n\r\nMy suspection is that the mlcp code for b5_0 in regression suite is not up to date.\r\n\r\n"}, {"time":"2013-02-05T14:47:25.30888-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Today bug17845 failed in b5_0 on linux 64 rh54 cluster RH5.4. We have found deleted fragments in the import part of bug17845, which means mlcp generated duplicate uris in bug17845.\r\nTo nail down what causes the duplicate uris, we have added more logging. We will watch closely on tomorrow's regression log.\r\n\r\nIt is worth pointing out that, this happens pretty randomly, sometimes on b5_0 sometimes on b6_0, also on randomly different platforms. Larry mentioned he had seen this random failure in tests for aggregate for a while.\r\n"}, {"time":"2013-02-06T10:00:00.71608-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"bug17845 passes in today's regression in b5_0 and b6_0 on all platforms."}, {"time":"2013-02-07T13:48:02.763762-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Except for winnt 64 w2k8 clusterupgrade in b5_0 (all mlcp tests fail), bug17845 passes today's regression in b5_0 on other platforms and in b6_0 on all platforms.\r\n\r\nSeem like with the diagnostic code, the bug cannot be reproduced.\r\n"}, {"time":"2013-02-08T13:57:18.120824-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"bug17845 passes today's regression in b5_0 and b6_0.\r\nI tried to run the same test on rh6-intel64-[123] cluster for 100 times, was not able to reproduce it.\r\nI am going to change the diagnostic code in mlcp, and try to reproduce it on the cluster."}, {"time":"2013-02-11T11:01:41.323789-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Bug is not reproduced in today's regression.\r\nI have been running the same test on a 3-node cluster in the lab continuously, the bug hasn't been able to be reproduced either."}, {"time":"2013-02-11T13:15:34.775612-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"After adding diagnostic code in mlcp, this bug hasn't been able to be reproduced since Feb 6. This indicates the client side has a impact on reproducing this bug.\r\nMeanwhile, in the server log on Feb 5 on the machine where the bug was reproduced, it showed there were exactly the same number of deleted fragment as the number of missing documents. This shows, server inserted documents with duplicate URIs.\r\n\r\nFrom the above, I believe it is very likely mlcp generates duplicate uris when importing aggregate with automatic uri generation. In addition, if this bug were a server issue, this intermittent data loss should have happen in other file types as well (not just aggregate xml). \r\n\r\nTherefore, we shouldn't hold 5.0-5 release because of this bug. Push it to 6.0-3.\r\n"}, {"time":"2013-02-11T13:15:34.775612-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"tofixin":{"from":"5.0-5", "to":"6.0-3"}}, "files":[], "show":true}, {"time":"2013-02-12T10:18:12.341069-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"The bug is reproduced in today's nightly regression on winnt-64-w2k3. \r\nhttps://regression-status.marklogic.com/new-app/space/diff-archive/b5_0/2013-02-12/winnt-64-w2k3/qa-stdout.txt.Split1.txt\r\n\r\nIt is confirmed that mlcp generates duplicate uris.\r\n\r\nIn the console output at the bottom,\r\nURI_KEY is composed of SPLIT_HASHCODE and ID_IN_AGGREGATE.\r\nhashcode of map_in_IdGenerator and one URI_KEY in this map is printed when the reader closes. As we have two input files, we expect that two readers are initiated, each of which has its own LocalIdGenerator.\r\n\r\nIt looks like the two readers use the same IdGenerator object; or the two readers are the same object.\r\n\r\ntderr/out from shell cmd: 13/02/12 01:14:13 INFO contentpump.LocalJobRunner: -706602197 URI_KEY:1983049639-14046\r\nstderr/out from shell cmd: 13/02/12 01:14:13 INFO contentpump.AggregateXMLReader: URI_MAP_SIZE:16238\r\nstderr/out from shell cmd: 13/02/12 01:14:14 INFO contentpump.LocalJobRunner:  completed 91%\r\nstderr/out from shell cmd: 13/02/12 01:14:15 INFO contentpump.LocalJobRunner:  completed 93%\r\nstderr/out from shell cmd: 13/02/12 01:14:16 INFO contentpump.LocalJobRunner:  completed 94%\r\nstderr/out from shell cmd: 13/02/12 01:14:17 INFO contentpump.LocalJobRunner:  completed 95%\r\nstderr/out from shell cmd: 13/02/12 01:14:18 INFO contentpump.LocalJobRunner:  completed 97%\r\nstderr/out from shell cmd: 13/02/12 01:14:19 INFO contentpump.LocalJobRunner:  completed 98%\r\nstderr/out from shell cmd: 13/02/12 01:14:19 INFO contentpump.LocalJobRunner: -706602197 URI_KEY:1983049639-14046\r\nstderr/out from shell cmd: 13/02/12 01:14:19 INFO contentpump.AggregateXMLReader: URI_MAP_SIZE:16238\r\nstderr/out from shell cmd: 13/02/12 01:14:19 INFO contentpump.LocalJobRunner:  completed 99%\r\nstderr/out from shell cmd: 13/02/12 01:14:19 INFO contentpump.LocalJobRunner: com.marklogic.contentpump.ContentPumpStats: \r\nstderr/out from shell cmd: 13/02/12 01:14:19 INFO contentpump.LocalJobRunner: ATTEMPTED_INPUT_RECORD_COUNT: 32476"}, {"time":"2013-02-12T10:18:12.341069-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"status":{"from":"", "to":"Fix"}, "assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-13T10:33:58.88537-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Bug reproduced in today's nightly regression with additional logging.\r\n\r\nNotice that, in the INFO log from AggregateXMLReader, \r\nREADER_HASHCODE, ID_GENERATOR_HASHCODE and URI_MAP_SIZE are shown.\r\n\r\nAggregateXMLReader: 965678682 1627687995 URI_MAP_SIZE:16238\r\nAggregateXMLReader: 18934841 410292931 URI_MAP_SIZE:16238\r\n\r\nIt shows that we have two different readers. Each reader has its IdGenerator. However, the two IdGenerators use the same map and the same uri_base(split_hashcode).\r\n                         MAP_HASHCODE            URI_BASE    ID_IN_AGGREGATE\r\nLocalJobRunner: -2046095493 URI_KEY:1074859057-8874\r\nLocalJobRunner: -2046095493 URI_KEY:1074859057-8874\r\n\r\nstderr/out from shell cmd: 13/02/13 01:15:04 INFO contentpump.LocalJobRunner: -2046095493 URI_KEY:1074859057-8874\r\nstderr/out from shell cmd: 13/02/13 01:15:04 INFO contentpump.AggregateXMLReader: 965678682 1627687995 URI_MAP_SIZE:16238\r\nstderr/out from shell cmd: 13/02/13 01:15:05 INFO contentpump.LocalJobRunner:  completed 92%\r\nstderr/out from shell cmd: 13/02/13 01:15:06 INFO contentpump.LocalJobRunner:  completed 93%\r\nstderr/out from shell cmd: 13/02/13 01:15:07 INFO contentpump.LocalJobRunner:  completed 94%\r\nstderr/out from shell cmd: 13/02/13 01:15:08 INFO contentpump.LocalJobRunner:  completed 96%\r\nstderr/out from shell cmd: 13/02/13 01:15:09 INFO contentpump.LocalJobRunner:  completed 97%\r\nstderr/out from shell cmd: 13/02/13 01:15:10 INFO contentpump.LocalJobRunner:  completed 99%\r\nstderr/out from shell cmd: 13/02/13 01:15:10 INFO contentpump.LocalJobRunner: -2046095493 URI_KEY:1074859057-8874\r\nstderr/out from shell cmd: 13/02/13 01:15:10 INFO contentpump.AggregateXMLReader: 18934841 410292931 URI_MAP_SIZE:16238\r\nstderr/out from shell cmd: 13/02/13 01:15:10 INFO contentpump.LocalJobRunner: com.marklogic.contentpump.ContentPumpStats: \r\nstderr/out from shell cmd: 13/02/13 01:15:10 INFO contentpump.LocalJobRunner: ATTEMPTED_INPUT_RECORD_COUNT: 32476\r\nstderr/out from shell cmd: 13/02/13 01:15:10 INFO contentpump.LocalJobRunner: SKIPPED_INPUT_RECORD_COUNT: 0\r\nstderr/out from shell cmd: 13/02/13 01:15:10 INFO contentpump.LocalJobRunner: Total execution time: 36 sec\r\nrunning following shell command: mkdir c:/builds/win64/b5_0/logs.20130213.1/reg-results/tmp/bug17845"}, {"time":"2013-02-20T10:51:42.409399-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Bug has been consistently reproduced on  winnt-64-w2k3. It really doesn't make sense to me TWO LocalIdGenerators share the same map and the same uri-base. Each LocalIdGenerator has its own constructor which \"new\" a ConcurrentHashMap. Notice 60618825  is the hashcode of the map as shown below.\r\n\r\n60618825 URI_KEY:169081233-5370  in LocalIdGenerator 513857264 \r\nvs.\r\n60618825 URI_KEY:169081233-5370  in LocalIdGenerator  2021757666.\r\n\r\nI have to start to suspect this is a JVM issue. The jdk used is jdk1.6.0_25, which hasn't been reported to be reliable according to http://wiki.apache.org/hadoop/HadoopJavaVersions.\r\n\r\nI think trying a different jdk would be the next step. 1.6.0_26, 1.6.0_28 and 1.6.0_31 would be good candidates. \r\n\r\nLarry, Could you upgrade the jdk on winnt-64-w2k3 to 1.6.0_31 at your convenience? Thanks."}, {"time":"2013-02-20T14:32:02.710451-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"It is not required that if two objects are unequal according to the equals(java.lang.Object) method, then calling the hashCode method on each of the two objects must produce distinct integer results. However, the programmer should be aware that producing distinct integer results for unequal objects may improve the performance of hashtables.\r\n\r\nWhat we can do to fix this is:\r\n1) Override the hashCode() method on AggregateXMLReader and make sure it is distinct based on the InputSplit's file path and offset.\r\n2) Use this hashCode instead of the InputSplit's hashCode."}, {"time":"2013-02-20T14:52:57.071928-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Yeah, the java doc of Object class in jdk 1.6 is kinds of confusing.\r\n\r\nIt not only says \"It is not required that if two objects are unequal according to the equals(java.lang.Object) method, then calling the hashCode method on each of the two objects must produce distinct integer results\", but also says \r\n\r\n\"As much as is reasonably practical, the hashCode method defined by class Object does return distinct integers for distinct objects. (This is typically implemented by converting the internal address of the object into an integer, but this implementation technique is not required by the JavaTM programming language.)\"\r\n\r\nI think having our own hashCode implementation is safer to guarantee distinct hashCodes. I will give it a try."}, {"time":"2013-02-20T14:56:36.356811-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Apparently, Windows decided to do it differently, as always.  Yet, you can't call it a bug.  It should be safer to rely on the hash code of String to be unique for different strings."}, {"time":"2013-02-20T15:03:35.458725-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"It happened on Linux as well, so not a windows specific problem. I guess it has something to do with multi-cores. \r\n\r\nMy theory is: The internal address of the object 1 used in the thread in core 1 may be the same as the internal address of the object 2 used in the thread in core 2. Just a wild guess."}, {"time":"2013-02-21T11:06:42.021275-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Since by the time LocalIdGenerator is initialized reader hasn't started to read yet, offset is always 0. \r\nInputSplit's file path is always distinct per reader, so using the path itself guarantee to give distinct strings.\r\n\r\nHowever, hashCode only returns a 32-bit integer. It is possible to have hash-collision for different strings, which means two different strings could still possibly get the same hash.\r\n\r\nTo minimize the chance of getting the same uri-base in LocalIdGenerator, instead of using hashCode we can use concatenation of the string of  InputSplit's file path's hash and the string of System.nanoTime.\r\n\r\nThe chance of getting hash-collision is very small, and the chance of readers initiate at the exact nanoTime is really tiny. So, in this way, it is very very unlikely to have the same uri-base. The overhead is that the uri length will be doubled roughly from 10 characters to 20 characters, and System.nanoTime takes extra cycles. Compared to content size, uri takes only a small part of memory on client, so the increase of uri-lengh should be fine. Considering IdGenerator is initialized once per reader, the overhead of System.nanoTime only counts once, which should be fine. "}, {"time":"2013-02-22T09:46:43.009881-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"I think this is worth porting into 7.0-ea1."}, {"time":"2013-02-25T10:44:12.971201-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Aries and I discussed about it.  We agreed on a strategy.  I'm assigning it to myself for load balancing."}, {"time":"2013-02-25T10:44:59.40616-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{"assignTo":{"from":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "to":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-26T17:35:52.784549-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Jane, have you started working on this bug? I could take it back if you haven't."}, {"time":"2013-02-26T17:40:28.177193-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"No, I haven't.  Feel free to take it back."}, {"time":"2013-02-26T17:42:07.428852-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Take back this bug to fix it."}, {"time":"2013-02-26T17:42:07.428852-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-26T18:06:21.757936-08:00", "updatedBy":{"username":"jchen", "name":"Jane Chen", "email":"jane.chen@marklogic.com"}, "change":{}, "files":[], "show":true, "comment":"Aries, when you have it fixed and feel good about it, please clone it to ea-1 and fix it there too."}, {"time":"2013-02-27T11:01:40.62969-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"133899", "paths":["xcc/branches/b6_0/mlcp/src/test/java/com/marklogic/contentpump/TestDistributedImportAggregate.java", "xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/CompressedAggXMLReader.java", "xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/AggregateXMLReader.java", "xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/FileAndDirectoryInputFormat.java", "xcc/branches/b6_0/mlcp/src/test/java/com/marklogic/contentpump/TestImportAggregate.java", "xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/utilities/LocalIdGenerator.java", "xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/LocalJobRunner.java"], "affectedBugs":[]}, "comment":"bug:20645\n-clean up diagnostic code used for debugging\n-use path uri + reader offset as the base IDGenerator if importing aggregates using automatic id."}, {"time":"2013-02-27T11:07:33.283363-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"133900", "paths":["xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/AggregateXMLReader.java"], "affectedBugs":[]}, "comment":"bug:20645\ncode clean up"}, {"time":"2013-02-27T13:05:02.42591-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"status":{"from":"", "to":"Test"}, "assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true, "comment":"bug17845 should pass."}, {"time":"2013-02-27T13:05:02.42591-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{"assignTo":{"from":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "to":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}}}, "files":[], "show":true}, {"time":"2013-02-27T18:55:37.454338-08:00", "updatedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "change":{}, "files":[], "show":true, "svn":{"repository":"/project/engsvn", "revision":"134015", "paths":["xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/AggregateXMLReader.java", "xcc/branches/b6_0/mlcp/src/main/java/com/marklogic/contentpump/CompressedAggXMLReader.java"], "affectedBugs":[]}, "comment":"bug:20645\n-use uri path + FileSplit.getStart() as the base of IDGenerator"}, {"time":"2013-03-18T15:16:59.058101-07:00", "updatedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "change":{"status":{"from":"", "to":"Ship"}, "assignTo":{"from":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true, "comment":"Verified on build 3/18/1013"}, {"time":"2013-04-22T16:32:55.662034-07:00", "updatedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "change":{"status":{"from":"", "to":"Closed"}, "assignTo":{"from":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "to":{"username":"nobody", "name":"nobody nobody", "email":"nobody@marklogic.com"}}}, "files":[], "show":true}], "updatedAt":"2013-04-22T16:32:55.662034-07:00", "fixedAt":"2013-02-27T13:05:02.42591-08:00", "fixedBy":{"username":"ali", "name":"Aries Li", "email":"ali@marklogic.com"}, "shippedAt":"2013-03-18T15:16:59.058101-07:00", "shippedBy":{"username":"lratcliff", "name":"Larry Ratcliff", "email":"lratcliff@marklogic.com"}, "closedAt":"2013-04-22T16:32:55.662034-07:00", "closedBy":{"username":"rpelton", "name":"Rick Pelton", "email":"rick.pelton@marklogic.com"}, "renderDescriptionAs":"normal", "renderSampleQueryAs":"normal"}