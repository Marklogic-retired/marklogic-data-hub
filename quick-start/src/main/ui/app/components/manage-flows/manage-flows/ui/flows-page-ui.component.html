<div id="flows-page" class="page-layout carded fullwidth inner-scroll">

  <!-- TOP BACKGROUND -->
  <div class="top-bg accent"></div>
  <!-- / TOP BACKGROUND -->

  <!-- CENTER -->
  <div class="center">

    <!-- HEADER -->
    <div class="header accent">
      <mat-toolbar style="background: transparent">
        <div class="logo mb-24 mb-md-0">
          <mat-icon>home</mat-icon>
          <span class="logo-text h1">
            Flows
          </span>
        </div>
        <span class="fill-space"></span>
        <button mat-raised-button
                class="add-flow-button"
                (click)="openNewFlowDialog()"
        >
          <span>ADD NEW FLOW</span>
        </button>
      </mat-toolbar>
    </div>
    <!-- / HEADER -->

    <!-- CONTENT CARD -->
    <div class="content-card">

      <mat-table class="flows-table"
                 #table [dataSource]="flows"
                 matSort>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <mat-header-cell *matHeaderCellDef mat-sort-header>Name</mat-header-cell>
          <mat-cell *matCellDef="let flow">
            <p class="text-truncate">{{flow.name}}</p>
          </mat-cell>
        </ng-container>

        <!-- Target Entity -->
        <ng-container matColumnDef="targetEntity">
          <mat-header-cell *matHeaderCellDef fxHide mat-sort-header fxShow.gt-md>Target Entinty</mat-header-cell>
          <mat-cell *matCellDef="let flow" fxHide fxShow.gt-md>
            <p class="text-truncate">
              {{flow.targetEntity}}
            </p>
          </mat-cell>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <mat-header-cell *matHeaderCellDef mat-sort-header fxHide fxShow.gt-xs>Status</mat-header-cell>
          <mat-cell *matCellDef="let flow" fxHide fxShow.gt-xs>
            <p class="text-truncate">
              {{flow.execution.lastJob.status || 'Never Run'}}
            </p>
          </mat-cell>
        </ng-container>

        <!-- Jobs Column -->
        <ng-container matColumnDef="jobs">
          <mat-header-cell *matHeaderCellDef fxHide mat-sort-header fxShow.gt-md>Jobs</mat-header-cell>
          <mat-cell *matCellDef="let flow" fxHide fxShow.gt-md>
            <p class="text-truncate">
              {{flow.execution.jobs.length}}
            </p>
          </mat-cell>
        </ng-container>

        <!-- Last Job Finished -->
        <ng-container matColumnDef="lastJobFinished">
          <mat-header-cell *matHeaderCellDef fxHide mat-sort-header fxShow.gt-md>Last Job Finished</mat-header-cell>
          <mat-cell *matCellDef="let flow" fxHide fxShow.gt-md>
            <p class="text-truncate">
              {{flow.execution.lastJob.endTime || ''}}
            </p>
          </mat-cell>
        </ng-container>

        <!-- Docs Committed Column -->
        <ng-container matColumnDef="docsCommitted">
          <mat-header-cell *matHeaderCellDef fxHide mat-sort-header fxShow.gt-md>Docs Committed</mat-header-cell>
          <mat-cell *matCellDef="let flow" fxHide fxShow.gt-md>
            <p class="text-truncate">
              {{flow.execution.docsCommitted}}
            </p>
          </mat-cell>
        </ng-container>

        <!-- Docs Failed Column -->
        <ng-container matColumnDef="docsFailed">
          <mat-header-cell *matHeaderCellDef fxHide mat-sort-header fxShow.gt-md>Docs Failed</mat-header-cell>
          <mat-cell *matCellDef="let flow" fxHide fxShow.gt-md>
            <p class="text-truncate">
              {{flow.execution.docsFailed}}
            </p>
          </mat-cell>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <mat-header-cell *matHeaderCellDef mat-sort-header fxHide fxShow.gt-xs>Actions</mat-header-cell>
          <mat-cell *matCellDef="let flow">
            <mat-icon class="active-icon" (click)="openPlayDialog(flow)">play_arrow</mat-icon>
            <mat-icon class="active-icon" (click)="openConfirmDialog(flow)">delete</mat-icon>
          </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns; sticky:true"></mat-header-row>
        <mat-row *matRowDef="let flow; columns: displayedColumns;"
                 class="flow"
                 matRipple>
        </mat-row>

      </mat-table>

      <mat-paginator #paginator
                     [length]="flows.length"
                     [pageIndex]="0"
                     [pageSize]="10"
                     [pageSizeOptions]="[5, 10, 25, 100]">
      </mat-paginator>

    </div>
    <!-- / CONTENT CARD -->
  </div>
  <!-- / CENTER -->
</div>
